import{s as pr,n as fi,b as tt,l as la,a as Dt}from"../chunks/scheduler.Dk__3NQe.js";import{S as Ba,i as Ua,e as le,c as ue,n as or,o as pe,g as Ve,d as Z,k as Ct,s as Ue,t as Wi,l as $n,H as Xl,a as Je,f as je,b as Qi,m as Vn,z as eu,p as Xe,h as U,q as zn,j as cs,r as Ln,u as Rn,v as Bn,A as Jt,D as tu,w as iu}from"../chunks/index.YBxWRTly.js";import{A as ru,N as nu,F as au,g as su,i as ou,a as lu,b as uu,c as cu,d as fu,r as hu}from"../chunks/Footer.Bs4B1bs4.js";import{g as Un}from"../chunks/entry.dknNnvOo.js";function pu({params:e}){if(e.problemid!="+layout.svelte")return{information:{title:e.problemid}}}const Up=Object.freeze(Object.defineProperty({__proto__:null,load:pu},Symbol.toStringTag,{value:"Module"}));var mu=Object.create,yo=Object.defineProperty,du=Object.getOwnPropertyDescriptor,gu=Object.getOwnPropertyNames,bu=Object.getPrototypeOf,vu=Object.prototype.hasOwnProperty,xu=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),yu=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of gu(t))!vu.call(e,n)&&n!==i&&yo(e,n,{get:()=>t[n],enumerable:!(r=du(t,n))||r.enumerable});return e},me=(e,t,i)=>(i=e!=null?mu(bu(e)):{},yu(t||!e||!e.__esModule?yo(i,"default",{value:e,enumerable:!0}):i,e)),de=xu((e,t)=>{(function(i){var r=Math.cosh||function(c){return Math.abs(c)<1e-9?1-c:(Math.exp(c)+Math.exp(-c))*.5},n=Math.sinh||function(c){return Math.abs(c)<1e-9?c:(Math.exp(c)-Math.exp(-c))*.5},a=function(c){var h=Math.PI/4;if(-h>c||c>h)return Math.cos(c)-1;var p=c*c;return p*(p*(p*(p*(p*(p*(p*(p/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},s=function(c,h){var p=Math.abs(c),m=Math.abs(h);return p<3e3&&m<3e3?Math.sqrt(p*p+m*m):(p<m?(p=m,m=c/h):m=h/c,p*Math.sqrt(1+m*m))},o=function(){throw SyntaxError("Invalid Param")};function l(c,h){var p=Math.abs(c),m=Math.abs(h);return c===0?Math.log(m):h===0?Math.log(p):p<3e3&&m<3e3?Math.log(c*c+h*h)*.5:(c=c/2,h=h/2,.5*Math.log(c*c+h*h)+Math.LN2)}var u=function(c,h){var p={re:0,im:0};if(c==null)p.re=p.im=0;else if(h!==void 0)p.re=c,p.im=h;else switch(typeof c){case"object":if("im"in c&&"re"in c)p.re=c.re,p.im=c.im;else if("abs"in c&&"arg"in c){if(!Number.isFinite(c.abs)&&Number.isFinite(c.arg))return f.INFINITY;p.re=c.abs*Math.cos(c.arg),p.im=c.abs*Math.sin(c.arg)}else if("r"in c&&"phi"in c){if(!Number.isFinite(c.r)&&Number.isFinite(c.phi))return f.INFINITY;p.re=c.r*Math.cos(c.phi),p.im=c.r*Math.sin(c.phi)}else c.length===2?(p.re=c[0],p.im=c[1]):o();break;case"string":p.im=p.re=0;var m=c.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),d=1,b=0;m===null&&o();for(var y=0;y<m.length;y++){var _=m[y];_===" "||_==="	"||_===`
`||(_==="+"?d++:_==="-"?b++:_==="i"||_==="I"?(d+b===0&&o(),m[y+1]!==" "&&!isNaN(m[y+1])?(p.im+=parseFloat((b%2?"-":"")+m[y+1]),y++):p.im+=parseFloat((b%2?"-":"")+"1"),d=b=0):((d+b===0||isNaN(_))&&o(),m[y+1]==="i"||m[y+1]==="I"?(p.im+=parseFloat((b%2?"-":"")+_),y++):p.re+=parseFloat((b%2?"-":"")+_),d=b=0))}d+b>0&&o();break;case"number":p.im=0,p.re=c;break;default:o()}return isNaN(p.re)||isNaN(p.im),p};function f(c,h){if(!(this instanceof f))return new f(c,h);var p=u(c,h);this.re=p.re,this.im=p.im}f.prototype={re:0,im:0,sign:function(){var c=this.abs();return new f(this.re/c,this.im/c)},add:function(c,h){var p=new f(c,h);return this.isInfinite()&&p.isInfinite()?f.NAN:this.isInfinite()||p.isInfinite()?f.INFINITY:new f(this.re+p.re,this.im+p.im)},sub:function(c,h){var p=new f(c,h);return this.isInfinite()&&p.isInfinite()?f.NAN:this.isInfinite()||p.isInfinite()?f.INFINITY:new f(this.re-p.re,this.im-p.im)},mul:function(c,h){var p=new f(c,h);return this.isInfinite()&&p.isZero()||this.isZero()&&p.isInfinite()?f.NAN:this.isInfinite()||p.isInfinite()?f.INFINITY:p.im===0&&this.im===0?new f(this.re*p.re,0):new f(this.re*p.re-this.im*p.im,this.re*p.im+this.im*p.re)},div:function(c,h){var p=new f(c,h);if(this.isZero()&&p.isZero()||this.isInfinite()&&p.isInfinite())return f.NAN;if(this.isInfinite()||p.isZero())return f.INFINITY;if(this.isZero()||p.isInfinite())return f.ZERO;c=this.re,h=this.im;var m=p.re,d=p.im,b,y;return d===0?new f(c/m,h/m):Math.abs(m)<Math.abs(d)?(y=m/d,b=m*y+d,new f((c*y+h)/b,(h*y-c)/b)):(y=d/m,b=d*y+m,new f((c+h*y)/b,(h-c*y)/b))},pow:function(c,h){var p=new f(c,h);if(c=this.re,h=this.im,p.isZero())return f.ONE;if(p.im===0){if(h===0&&c>0)return new f(Math.pow(c,p.re),0);if(c===0)switch((p.re%4+4)%4){case 0:return new f(Math.pow(h,p.re),0);case 1:return new f(0,Math.pow(h,p.re));case 2:return new f(-Math.pow(h,p.re),0);case 3:return new f(0,-Math.pow(h,p.re))}}if(c===0&&h===0&&p.re>0&&p.im>=0)return f.ZERO;var m=Math.atan2(h,c),d=l(c,h);return c=Math.exp(p.re*d-p.im*m),h=p.im*d+p.re*m,new f(c*Math.cos(h),c*Math.sin(h))},sqrt:function(){var c=this.re,h=this.im,p=this.abs(),m,d;if(c>=0){if(h===0)return new f(Math.sqrt(c),0);m=.5*Math.sqrt(2*(p+c))}else m=Math.abs(h)/Math.sqrt(2*(p-c));return c<=0?d=.5*Math.sqrt(2*(p-c)):d=Math.abs(h)/Math.sqrt(2*(p+c)),new f(m,h<0?-d:d)},exp:function(){var c=Math.exp(this.re);return this.im,new f(c*Math.cos(this.im),c*Math.sin(this.im))},expm1:function(){var c=this.re,h=this.im;return new f(Math.expm1(c)*Math.cos(h)+a(h),Math.exp(c)*Math.sin(h))},log:function(){var c=this.re,h=this.im;return new f(l(c,h),Math.atan2(h,c))},abs:function(){return s(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var c=this.re,h=this.im;return new f(Math.sin(c)*r(h),Math.cos(c)*n(h))},cos:function(){var c=this.re,h=this.im;return new f(Math.cos(c)*r(h),-Math.sin(c)*n(h))},tan:function(){var c=2*this.re,h=2*this.im,p=Math.cos(c)+r(h);return new f(Math.sin(c)/p,n(h)/p)},cot:function(){var c=2*this.re,h=2*this.im,p=Math.cos(c)-r(h);return new f(-Math.sin(c)/p,n(h)/p)},sec:function(){var c=this.re,h=this.im,p=.5*r(2*h)+.5*Math.cos(2*c);return new f(Math.cos(c)*r(h)/p,Math.sin(c)*n(h)/p)},csc:function(){var c=this.re,h=this.im,p=.5*r(2*h)-.5*Math.cos(2*c);return new f(Math.sin(c)*r(h)/p,-Math.cos(c)*n(h)/p)},asin:function(){var c=this.re,h=this.im,p=new f(h*h-c*c+1,-2*c*h).sqrt(),m=new f(p.re-h,p.im+c).log();return new f(m.im,-m.re)},acos:function(){var c=this.re,h=this.im,p=new f(h*h-c*c+1,-2*c*h).sqrt(),m=new f(p.re-h,p.im+c).log();return new f(Math.PI/2-m.im,m.re)},atan:function(){var c=this.re,h=this.im;if(c===0){if(h===1)return new f(0,1/0);if(h===-1)return new f(0,-1/0)}var p=c*c+(1-h)*(1-h),m=new f((1-h*h-c*c)/p,-2*c/p).log();return new f(-.5*m.im,.5*m.re)},acot:function(){var c=this.re,h=this.im;if(h===0)return new f(Math.atan2(1,c),0);var p=c*c+h*h;return p!==0?new f(c/p,-h/p).atan():new f(c!==0?c/0:0,h!==0?-h/0:0).atan()},asec:function(){var c=this.re,h=this.im;if(c===0&&h===0)return new f(0,1/0);var p=c*c+h*h;return p!==0?new f(c/p,-h/p).acos():new f(c!==0?c/0:0,h!==0?-h/0:0).acos()},acsc:function(){var c=this.re,h=this.im;if(c===0&&h===0)return new f(Math.PI/2,1/0);var p=c*c+h*h;return p!==0?new f(c/p,-h/p).asin():new f(c!==0?c/0:0,h!==0?-h/0:0).asin()},sinh:function(){var c=this.re,h=this.im;return new f(n(c)*Math.cos(h),r(c)*Math.sin(h))},cosh:function(){var c=this.re,h=this.im;return new f(r(c)*Math.cos(h),n(c)*Math.sin(h))},tanh:function(){var c=2*this.re,h=2*this.im,p=r(c)+Math.cos(h);return new f(n(c)/p,Math.sin(h)/p)},coth:function(){var c=2*this.re,h=2*this.im,p=r(c)-Math.cos(h);return new f(n(c)/p,-Math.sin(h)/p)},csch:function(){var c=this.re,h=this.im,p=Math.cos(2*h)-r(2*c);return new f(-2*n(c)*Math.cos(h)/p,2*r(c)*Math.sin(h)/p)},sech:function(){var c=this.re,h=this.im,p=Math.cos(2*h)+r(2*c);return new f(2*r(c)*Math.cos(h)/p,-2*n(c)*Math.sin(h)/p)},asinh:function(){var c=this.im;this.im=-this.re,this.re=c;var h=this.asin();return this.re=-this.im,this.im=c,c=h.re,h.re=-h.im,h.im=c,h},acosh:function(){var c=this.acos();if(c.im<=0){var h=c.re;c.re=-c.im,c.im=h}else{var h=c.im;c.im=-c.re,c.re=h}return c},atanh:function(){var c=this.re,h=this.im,p=c>1&&h===0,m=1-c,d=1+c,b=m*m+h*h,y=b!==0?new f((d*m-h*h)/b,(h*m+d*h)/b):new f(c!==-1?c/0:0,h!==0?h/0:0),_=y.re;return y.re=l(y.re,y.im)/2,y.im=Math.atan2(y.im,_)/2,p&&(y.im=-y.im),y},acoth:function(){var c=this.re,h=this.im;if(c===0&&h===0)return new f(0,Math.PI/2);var p=c*c+h*h;return p!==0?new f(c/p,-h/p).atanh():new f(c!==0?c/0:0,h!==0?-h/0:0).atanh()},acsch:function(){var c=this.re,h=this.im;if(h===0)return new f(c!==0?Math.log(c+Math.sqrt(c*c+1)):1/0,0);var p=c*c+h*h;return p!==0?new f(c/p,-h/p).asinh():new f(c!==0?c/0:0,h!==0?-h/0:0).asinh()},asech:function(){var c=this.re,h=this.im;if(this.isZero())return f.INFINITY;var p=c*c+h*h;return p!==0?new f(c/p,-h/p).acosh():new f(c!==0?c/0:0,h!==0?-h/0:0).acosh()},inverse:function(){if(this.isZero())return f.INFINITY;if(this.isInfinite())return f.ZERO;var c=this.re,h=this.im,p=c*c+h*h;return new f(c/p,-h/p)},conjugate:function(){return new f(this.re,-this.im)},neg:function(){return new f(-this.re,-this.im)},ceil:function(c){return c=Math.pow(10,c||0),new f(Math.ceil(this.re*c)/c,Math.ceil(this.im*c)/c)},floor:function(c){return c=Math.pow(10,c||0),new f(Math.floor(this.re*c)/c,Math.floor(this.im*c)/c)},round:function(c){return c=Math.pow(10,c||0),new f(Math.round(this.re*c)/c,Math.round(this.im*c)/c)},equals:function(c,h){var p=new f(c,h);return Math.abs(p.re-this.re)<=f.EPSILON&&Math.abs(p.im-this.im)<=f.EPSILON},clone:function(){return new f(this.re,this.im)},toString:function(){var c=this.re,h=this.im,p="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(c)<f.EPSILON&&(c=0),Math.abs(h)<f.EPSILON&&(h=0),h===0?p+c:(c!==0?(p+=c,p+=" ",h<0?(h=-h,p+="-"):p+="+",p+=" "):h<0&&(h=-h,p+="-"),h!==1&&(p+=h),p+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},f.ZERO=new f(0,0),f.ONE=new f(1,0),f.I=new f(0,1),f.PI=new f(Math.PI,0),f.E=new f(Math.E,0),f.INFINITY=new f(1/0,1/0),f.NAN=new f(NaN,NaN),f.EPSILON=1e-15,typeof define=="function"&&define.amd?define([],function(){return f}):typeof e=="object"?(Object.defineProperty(f,"__esModule",{value:!0}),f.default=f,f.Complex=f,t.exports=f):i.Complex=f})(e)}),$=245,Nr=260,li=270,he=275,St=390,Pt=600,fs=810;function Nu(e){return!("kind"in e)||e.kind==="expression"}function _u(e){return"kind"in e&&e.kind==="symbol"}function Xr(e){return"kind"in e&&e.kind==="matchfix"}function No(e){return"kind"in e&&e.kind==="infix"}function ua(e){return"kind"in e&&e.kind==="prefix"}function _o(e){return"kind"in e&&e.kind==="postfix"}function Su(e){return"kind"in e&&e.kind==="environment"}var Ui=me(de(),1),Ti=9e15,ti=1e9,ca="0123456789abcdef",en="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",tn="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",fa={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ti,maxE:Ti,crypto:!1},So,Mt,q=!0,Nn="[DecimalError] ",Kt=Nn+"Invalid argument: ",wo=Nn+"Precision limit exceeded",ko=Nn+"crypto unavailable",To="[object Decimal]",$e=Math.floor,xe=Math.pow,wu=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,ku=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Tu=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Eo=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ot=1e7,A=7,Eu=9007199254740991,Au=en.length-1,ha=tn.length-1,v={toStringTag:To};v.absoluteValue=v.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),E(e)};v.ceil=function(){return E(new this.constructor(this),this.e+1,2)};v.clampedTo=v.clamp=function(e,t){var i,r=this,n=r.constructor;if(e=new n(e),t=new n(t),!e.s||!t.s)return new n(NaN);if(e.gt(t))throw Error(Kt+t);return i=r.cmp(e),i<0?e:r.cmp(t)>0?t:new n(r)};v.comparedTo=v.cmp=function(e){var t,i,r,n,a=this,s=a.d,o=(e=new a.constructor(e)).d,l=a.s,u=e.s;if(!s||!o)return!l||!u?NaN:l!==u?l:s===o?0:!s^l<0?1:-1;if(!s[0]||!o[0])return s[0]?l:o[0]?-u:0;if(l!==u)return l;if(a.e!==e.e)return a.e>e.e^l<0?1:-1;for(r=s.length,n=o.length,t=0,i=r<n?r:n;t<i;++t)if(s[t]!==o[t])return s[t]>o[t]^l<0?1:-1;return r===n?0:r>n^l<0?1:-1};v.cosine=v.cos=function(){var e,t,i=this,r=i.constructor;return i.d?i.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(i.e,i.sd())+A,r.rounding=1,i=Mu(r,qo(r,i)),r.precision=e,r.rounding=t,E(Mt==2||Mt==3?i.neg():i,e,t,!0)):new r(1):new r(NaN)};v.cubeRoot=v.cbrt=function(){var e,t,i,r,n,a,s,o,l,u,f=this,c=f.constructor;if(!f.isFinite()||f.isZero())return new c(f);for(q=!1,a=f.s*xe(f.s*f,1/3),!a||Math.abs(a)==1/0?(i=qe(f.d),e=f.e,(a=(e-i.length+1)%3)&&(i+=a==1||a==-2?"0":"00"),a=xe(i,1/3),e=$e((e+1)/3)-(e%3==(e<0?-1:2)),a==1/0?i="5e"+e:(i=a.toExponential(),i=i.slice(0,i.indexOf("e")+1)+e),r=new c(i),r.s=f.s):r=new c(a.toString()),s=(e=c.precision)+3;;)if(o=r,l=o.times(o).times(o),u=l.plus(f),r=J(u.plus(f).times(o),u.plus(l),s+2,1),qe(o.d).slice(0,s)===(i=qe(r.d)).slice(0,s))if(i=i.slice(s-3,s+1),i=="9999"||!n&&i=="4999"){if(!n&&(E(o,e+1,0),o.times(o).times(o).eq(f))){r=o;break}s+=4,n=1}else{(!+i||!+i.slice(1)&&i.charAt(0)=="5")&&(E(r,e+1,1),t=!r.times(r).times(r).eq(f));break}return q=!0,E(r,e,c.rounding,t)};v.decimalPlaces=v.dp=function(){var e,t=this.d,i=NaN;if(t){if(e=t.length-1,i=(e-$e(this.e/A))*A,e=t[e],e)for(;e%10==0;e/=10)i--;i<0&&(i=0)}return i};v.dividedBy=v.div=function(e){return J(this,new this.constructor(e))};v.dividedToIntegerBy=v.divToInt=function(e){var t=this,i=t.constructor;return E(J(t,new i(e),0,1,1),i.precision,i.rounding)};v.equals=v.eq=function(e){return this.cmp(e)===0};v.floor=function(){return E(new this.constructor(this),this.e+1,3)};v.greaterThan=v.gt=function(e){return this.cmp(e)>0};v.greaterThanOrEqualTo=v.gte=function(e){var t=this.cmp(e);return t==1||t===0};v.hyperbolicCosine=v.cosh=function(){var e,t,i,r,n,a=this,s=a.constructor,o=new s(1);if(!a.isFinite())return new s(a.s?1/0:NaN);if(a.isZero())return o;i=s.precision,r=s.rounding,s.precision=i+Math.max(a.e,a.sd())+4,s.rounding=1,n=a.d.length,n<32?(e=Math.ceil(n/3),t=(1/Sn(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),a=Pi(s,1,a.times(t),new s(1),!0);for(var l,u=e,f=new s(8);u--;)l=a.times(a),a=o.minus(l.times(f.minus(l.times(f))));return E(a,s.precision=i,s.rounding=r,!0)};v.hyperbolicSine=v.sinh=function(){var e,t,i,r,n=this,a=n.constructor;if(!n.isFinite()||n.isZero())return new a(n);if(t=a.precision,i=a.rounding,a.precision=t+Math.max(n.e,n.sd())+4,a.rounding=1,r=n.d.length,r<3)n=Pi(a,2,n,n,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,n=n.times(1/Sn(5,e)),n=Pi(a,2,n,n,!0);for(var s,o=new a(5),l=new a(16),u=new a(20);e--;)s=n.times(n),n=n.times(o.plus(s.times(l.times(s).plus(u))))}return a.precision=t,a.rounding=i,E(n,t,i,!0)};v.hyperbolicTangent=v.tanh=function(){var e,t,i=this,r=i.constructor;return i.isFinite()?i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,J(i.sinh(),i.cosh(),r.precision=e,r.rounding=t)):new r(i.s)};v.inverseCosine=v.acos=function(){var e,t=this,i=t.constructor,r=t.abs().cmp(1),n=i.precision,a=i.rounding;return r!==-1?r===0?t.isNeg()?nt(i,n,a):new i(0):new i(NaN):t.isZero()?nt(i,n+4,a).times(.5):(i.precision=n+6,i.rounding=1,t=t.asin(),e=nt(i,n+4,a).times(.5),i.precision=n,i.rounding=a,e.minus(t))};v.inverseHyperbolicCosine=v.acosh=function(){var e,t,i=this,r=i.constructor;return i.lte(1)?new r(i.eq(1)?0:NaN):i.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(i.e),i.sd())+4,r.rounding=1,q=!1,i=i.times(i).minus(1).sqrt().plus(i),q=!0,r.precision=e,r.rounding=t,i.ln()):new r(i)};v.inverseHyperbolicSine=v.asinh=function(){var e,t,i=this,r=i.constructor;return!i.isFinite()||i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(i.e),i.sd())+6,r.rounding=1,q=!1,i=i.times(i).plus(1).sqrt().plus(i),q=!0,r.precision=e,r.rounding=t,i.ln())};v.inverseHyperbolicTangent=v.atanh=function(){var e,t,i,r,n=this,a=n.constructor;return n.isFinite()?n.e>=0?new a(n.abs().eq(1)?n.s/0:n.isZero()?n:NaN):(e=a.precision,t=a.rounding,r=n.sd(),Math.max(r,e)<2*-n.e-1?E(new a(n),e,t,!0):(a.precision=i=r-n.e,n=J(n.plus(1),new a(1).minus(n),i+e,1),a.precision=e+4,a.rounding=1,n=n.ln(),a.precision=e,a.rounding=t,n.times(.5))):new a(NaN)};v.inverseSine=v.asin=function(){var e,t,i,r,n=this,a=n.constructor;return n.isZero()?new a(n):(t=n.abs().cmp(1),i=a.precision,r=a.rounding,t!==-1?t===0?(e=nt(a,i+4,r).times(.5),e.s=n.s,e):new a(NaN):(a.precision=i+6,a.rounding=1,n=n.div(new a(1).minus(n.times(n)).sqrt().plus(1)).atan(),a.precision=i,a.rounding=r,n.times(2)))};v.inverseTangent=v.atan=function(){var e,t,i,r,n,a,s,o,l,u=this,f=u.constructor,c=f.precision,h=f.rounding;if(u.isFinite()){if(u.isZero())return new f(u);if(u.abs().eq(1)&&c+4<=ha)return s=nt(f,c+4,h).times(.25),s.s=u.s,s}else{if(!u.s)return new f(NaN);if(c+4<=ha)return s=nt(f,c+4,h).times(.5),s.s=u.s,s}for(f.precision=o=c+10,f.rounding=1,i=Math.min(28,o/A+2|0),e=i;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(q=!1,t=Math.ceil(o/A),r=1,l=u.times(u),s=new f(u),n=u;e!==-1;)if(n=n.times(l),a=s.minus(n.div(r+=2)),n=n.times(l),s=a.plus(n.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===a.d[e]&&e--;);return i&&(s=s.times(2<<i-1)),q=!0,E(s,f.precision=c,f.rounding=h,!0)};v.isFinite=function(){return!!this.d};v.isInteger=v.isInt=function(){return!!this.d&&$e(this.e/A)>this.d.length-2};v.isNaN=function(){return!this.s};v.isNegative=v.isNeg=function(){return this.s<0};v.isPositive=v.isPos=function(){return this.s>0};v.isZero=function(){return!!this.d&&this.d[0]===0};v.lessThan=v.lt=function(e){return this.cmp(e)<0};v.lessThanOrEqualTo=v.lte=function(e){return this.cmp(e)<1};v.logarithm=v.log=function(e){var t,i,r,n,a,s,o,l,u=this,f=u.constructor,c=f.precision,h=f.rounding,p=5;if(e==null)e=new f(10),t=!0;else{if(e=new f(e),i=e.d,e.s<0||!i||!i[0]||e.eq(1))return new f(NaN);t=e.eq(10)}if(i=u.d,u.s<0||!i||!i[0]||u.eq(1))return new f(i&&!i[0]?-1/0:u.s!=1?NaN:i?0:1/0);if(t)if(i.length>1)a=!0;else{for(n=i[0];n%10===0;)n/=10;a=n!==1}if(q=!1,o=c+p,s=Zt(u,o),r=t?rn(f,o+10):Zt(e,o),l=J(s,r,o,1),lr(l.d,n=c,h))do if(o+=10,s=Zt(u,o),r=t?rn(f,o+10):Zt(e,o),l=J(s,r,o,1),!a){+qe(l.d).slice(n+1,n+15)+1==1e14&&(l=E(l,c+1,0));break}while(lr(l.d,n+=10,h));return q=!0,E(l,c,h)};v.minus=v.sub=function(e){var t,i,r,n,a,s,o,l,u,f,c,h,p=this,m=p.constructor;if(e=new m(e),!p.d||!e.d)return!p.s||!e.s?e=new m(NaN):p.d?e.s=-e.s:e=new m(e.d||p.s!==e.s?p:NaN),e;if(p.s!=e.s)return e.s=-e.s,p.plus(e);if(u=p.d,h=e.d,o=m.precision,l=m.rounding,!u[0]||!h[0]){if(h[0])e.s=-e.s;else if(u[0])e=new m(p);else return new m(l===3?-0:0);return q?E(e,o,l):e}if(i=$e(e.e/A),f=$e(p.e/A),u=u.slice(),a=f-i,a){for(c=a<0,c?(t=u,a=-a,s=h.length):(t=h,i=f,s=u.length),r=Math.max(Math.ceil(o/A),s)+2,a>r&&(a=r,t.length=1),t.reverse(),r=a;r--;)t.push(0);t.reverse()}else{for(r=u.length,s=h.length,c=r<s,c&&(s=r),r=0;r<s;r++)if(u[r]!=h[r]){c=u[r]<h[r];break}a=0}for(c&&(t=u,u=h,h=t,e.s=-e.s),s=u.length,r=h.length-s;r>0;--r)u[s++]=0;for(r=h.length;r>a;){if(u[--r]<h[r]){for(n=r;n&&u[--n]===0;)u[n]=ot-1;--u[n],u[r]+=ot}u[r]-=h[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--i;return u[0]?(e.d=u,e.e=_n(u,i),q?E(e,o,l):e):new m(l===3?-0:0)};v.modulo=v.mod=function(e){var t,i=this,r=i.constructor;return e=new r(e),!i.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||i.d&&!i.d[0]?E(new r(i),r.precision,r.rounding):(q=!1,r.modulo==9?(t=J(i,e.abs(),0,3,1),t.s*=e.s):t=J(i,e,0,r.modulo,1),t=t.times(e),q=!0,i.minus(t))};v.naturalExponential=v.exp=function(){return pa(this)};v.naturalLogarithm=v.ln=function(){return Zt(this)};v.negated=v.neg=function(){var e=new this.constructor(this);return e.s=-e.s,E(e)};v.plus=v.add=function(e){var t,i,r,n,a,s,o,l,u,f,c=this,h=c.constructor;if(e=new h(e),!c.d||!e.d)return!c.s||!e.s?e=new h(NaN):c.d||(e=new h(e.d||c.s===e.s?c:NaN)),e;if(c.s!=e.s)return e.s=-e.s,c.minus(e);if(u=c.d,f=e.d,o=h.precision,l=h.rounding,!u[0]||!f[0])return f[0]||(e=new h(c)),q?E(e,o,l):e;if(a=$e(c.e/A),r=$e(e.e/A),u=u.slice(),n=a-r,n){for(n<0?(i=u,n=-n,s=f.length):(i=f,r=a,s=u.length),a=Math.ceil(o/A),s=a>s?a+1:s+1,n>s&&(n=s,i.length=1),i.reverse();n--;)i.push(0);i.reverse()}for(s=u.length,n=f.length,s-n<0&&(n=s,i=f,f=u,u=i),t=0;n;)t=(u[--n]=u[n]+f[n]+t)/ot|0,u[n]%=ot;for(t&&(u.unshift(t),++r),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=_n(u,r),q?E(e,o,l):e};v.precision=v.sd=function(e){var t,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Kt+e);return i.d?(t=Ao(i.d),e&&i.e+1>t&&(t=i.e+1)):t=NaN,t};v.round=function(){var e=this,t=e.constructor;return E(new t(e),e.e+1,t.rounding)};v.sine=v.sin=function(){var e,t,i=this,r=i.constructor;return i.isFinite()?i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+Math.max(i.e,i.sd())+A,r.rounding=1,i=Ou(r,qo(r,i)),r.precision=e,r.rounding=t,E(Mt>2?i.neg():i,e,t,!0)):new r(NaN)};v.squareRoot=v.sqrt=function(){var e,t,i,r,n,a,s=this,o=s.d,l=s.e,u=s.s,f=s.constructor;if(u!==1||!o||!o[0])return new f(!u||u<0&&(!o||o[0])?NaN:o?s:1/0);for(q=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=qe(o),(t.length+l)%2==0&&(t+="0"),u=Math.sqrt(t),l=$e((l+1)/2)-(l<0||l%2),u==1/0?t="5e"+l:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+l),r=new f(t)):r=new f(u.toString()),i=(l=f.precision)+3;;)if(a=r,r=a.plus(J(s,a,i+2,1)).times(.5),qe(a.d).slice(0,i)===(t=qe(r.d)).slice(0,i))if(t=t.slice(i-3,i+1),t=="9999"||!n&&t=="4999"){if(!n&&(E(a,l+1,0),a.times(a).eq(s))){r=a;break}i+=4,n=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(E(r,l+1,1),e=!r.times(r).eq(s));break}return q=!0,E(r,l,f.rounding,e)};v.tangent=v.tan=function(){var e,t,i=this,r=i.constructor;return i.isFinite()?i.isZero()?new r(i):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,i=i.sin(),i.s=1,i=J(i,new r(1).minus(i.times(i)).sqrt(),e+10,0),r.precision=e,r.rounding=t,E(Mt==2||Mt==4?i.neg():i,e,t,!0)):new r(NaN)};v.times=v.mul=function(e){var t,i,r,n,a,s,o,l,u,f=this,c=f.constructor,h=f.d,p=(e=new c(e)).d;if(e.s*=f.s,!h||!h[0]||!p||!p[0])return new c(!e.s||h&&!h[0]&&!p||p&&!p[0]&&!h?NaN:!h||!p?e.s/0:e.s*0);for(i=$e(f.e/A)+$e(e.e/A),l=h.length,u=p.length,l<u&&(a=h,h=p,p=a,s=l,l=u,u=s),a=[],s=l+u,r=s;r--;)a.push(0);for(r=u;--r>=0;){for(t=0,n=l+r;n>r;)o=a[n]+p[r]*h[n-r-1]+t,a[n--]=o%ot|0,t=o/ot|0;a[n]=(a[n]+t)%ot|0}for(;!a[--s];)a.pop();return t?++i:a.shift(),e.d=a,e.e=_n(a,i),q?E(e,c.precision,c.rounding):e};v.toBinary=function(e,t){return ja(this,2,e,t)};v.toDecimalPlaces=v.toDP=function(e,t){var i=this,r=i.constructor;return i=new r(i),e===void 0?i:(He(e,0,ti),t===void 0?t=r.rounding:He(t,0,8),E(i,e+i.e+1,t))};v.toExponential=function(e,t){var i,r=this,n=r.constructor;return e===void 0?i=pt(r,!0):(He(e,0,ti),t===void 0?t=n.rounding:He(t,0,8),r=E(new n(r),e+1,t),i=pt(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+i:i};v.toFixed=function(e,t){var i,r,n=this,a=n.constructor;return e===void 0?i=pt(n):(He(e,0,ti),t===void 0?t=a.rounding:He(t,0,8),r=E(new a(n),e+n.e+1,t),i=pt(r,!1,e+r.e+1)),n.isNeg()&&!n.isZero()?"-"+i:i};v.toFraction=function(e){var t,i,r,n,a,s,o,l,u,f,c,h,p=this,m=p.d,d=p.constructor;if(!m)return new d(p);if(u=i=new d(1),r=l=new d(0),t=new d(r),a=t.e=Ao(m)-p.e-1,s=a%A,t.d[0]=xe(10,s<0?A+s:s),e==null)e=a>0?t:u;else{if(o=new d(e),!o.isInt()||o.lt(u))throw Error(Kt+o);e=o.gt(t)?a>0?t:u:o}for(q=!1,o=new d(qe(m)),f=d.precision,d.precision=a=m.length*A*2;c=J(o,t,0,1,1),n=i.plus(c.times(r)),n.cmp(e)!=1;)i=r,r=n,n=u,u=l.plus(c.times(n)),l=n,n=t,t=o.minus(c.times(n)),o=n;return n=J(e.minus(i),r,0,1,1),l=l.plus(n.times(u)),i=i.plus(n.times(r)),l.s=u.s=p.s,h=J(u,r,a,1).minus(p).abs().cmp(J(l,i,a,1).minus(p).abs())<1?[u,r]:[l,i],d.precision=f,q=!0,h};v.toHexadecimal=v.toHex=function(e,t){return ja(this,16,e,t)};v.toNearest=function(e,t){var i=this,r=i.constructor;if(i=new r(i),e==null){if(!i.d)return i;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:He(t,0,8),!i.d)return e.s?i:e;if(!e.d)return e.s&&(e.s=i.s),e}return e.d[0]?(q=!1,i=J(i,e,0,t,1).times(e),q=!0,E(i)):(e.s=i.s,i=e),i};v.toNumber=function(){return+this};v.toOctal=function(e,t){return ja(this,8,e,t)};v.toPower=v.pow=function(e){var t,i,r,n,a,s,o=this,l=o.constructor,u=+(e=new l(e));if(!o.d||!e.d||!o.d[0]||!e.d[0])return new l(xe(+o,u));if(o=new l(o),o.eq(1))return o;if(r=l.precision,a=l.rounding,e.eq(1))return E(o,r,a);if(t=$e(e.e/A),t>=e.d.length-1&&(i=u<0?-u:u)<=Eu)return n=Mo(l,o,i,r),e.s<0?new l(1).div(n):E(n,r,a);if(s=o.s,s<0){if(t<e.d.length-1)return new l(NaN);if(e.d[t]&1||(s=1),o.e==0&&o.d[0]==1&&o.d.length==1)return o.s=s,o}return i=xe(+o,u),t=i==0||!isFinite(i)?$e(u*(Math.log("0."+qe(o.d))/Math.LN10+o.e+1)):new l(i+"").e,t>l.maxE+1||t<l.minE-1?new l(t>0?s/0:0):(q=!1,l.rounding=o.s=1,i=Math.min(12,(t+"").length),n=pa(e.times(Zt(o,r+i)),r),n.d&&(n=E(n,r+5,1),lr(n.d,r,a)&&(t=r+10,n=E(pa(e.times(Zt(o,t+i)),t),t+5,1),+qe(n.d).slice(r+1,r+15)+1==1e14&&(n=E(n,r+1,0)))),n.s=s,q=!0,l.rounding=a,E(n,r,a))};v.toPrecision=function(e,t){var i,r=this,n=r.constructor;return e===void 0?i=pt(r,r.e<=n.toExpNeg||r.e>=n.toExpPos):(He(e,1,ti),t===void 0?t=n.rounding:He(t,0,8),r=E(new n(r),e,t),i=pt(r,e<=r.e||r.e<=n.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+i:i};v.toSignificantDigits=v.toSD=function(e,t){var i=this,r=i.constructor;return e===void 0?(e=r.precision,t=r.rounding):(He(e,1,ti),t===void 0?t=r.rounding:He(t,0,8)),E(new r(i),e,t)};v.toString=function(){var e=this,t=e.constructor,i=pt(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+i:i};v.truncated=v.trunc=function(){return E(new this.constructor(this),this.e+1,1)};v.valueOf=v.toJSON=function(){var e=this,t=e.constructor,i=pt(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+i:i};function qe(e){var t,i,r,n=e.length-1,a="",s=e[0];if(n>0){for(a+=s,t=1;t<n;t++)r=e[t]+"",i=A-r.length,i&&(a+=Rt(i)),a+=r;s=e[t],r=s+"",i=A-r.length,i&&(a+=Rt(i))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}function He(e,t,i){if(e!==~~e||e<t||e>i)throw Error(Kt+e)}function lr(e,t,i,r){var n,a,s,o;for(a=e[0];a>=10;a/=10)--t;return--t<0?(t+=A,n=0):(n=Math.ceil((t+1)/A),t%=A),a=xe(10,A-t),o=e[n]%a|0,r==null?t<3?(t==0?o=o/100|0:t==1&&(o=o/10|0),s=i<4&&o==99999||i>3&&o==49999||o==5e4||o==0):s=(i<4&&o+1==a||i>3&&o+1==a/2)&&(e[n+1]/a/100|0)==xe(10,t-2)-1||(o==a/2||o==0)&&(e[n+1]/a/100|0)==0:t<4?(t==0?o=o/1e3|0:t==1?o=o/100|0:t==2&&(o=o/10|0),s=(r||i<4)&&o==9999||!r&&i>3&&o==4999):s=((r||i<4)&&o+1==a||!r&&i>3&&o+1==a/2)&&(e[n+1]/a/1e3|0)==xe(10,t-3)-1,s}function Dr(e,t,i){for(var r,n=[0],a,s=0,o=e.length;s<o;){for(a=n.length;a--;)n[a]*=t;for(n[0]+=ca.indexOf(e.charAt(s++)),r=0;r<n.length;r++)n[r]>i-1&&(n[r+1]===void 0&&(n[r+1]=0),n[r+1]+=n[r]/i|0,n[r]%=i)}return n.reverse()}function Mu(e,t){var i,r,n;if(t.isZero())return t;r=t.d.length,r<32?(i=Math.ceil(r/3),n=(1/Sn(4,i)).toString()):(i=16,n="2.3283064365386962890625e-10"),e.precision+=i,t=Pi(e,1,t.times(n),new e(1));for(var a=i;a--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=i,t}var J=function(){function e(r,n,a){var s,o=0,l=r.length;for(r=r.slice();l--;)s=r[l]*n+o,r[l]=s%a|0,o=s/a|0;return o&&r.unshift(o),r}function t(r,n,a,s){var o,l;if(a!=s)l=a>s?1:-1;else for(o=l=0;o<a;o++)if(r[o]!=n[o]){l=r[o]>n[o]?1:-1;break}return l}function i(r,n,a,s){for(var o=0;a--;)r[a]-=o,o=r[a]<n[a]?1:0,r[a]=o*s+r[a]-n[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,n,a,s,o,l){var u,f,c,h,p,m,d,b,y,_,S,k,C,P,se,we,Y,lt,Me,Ie,ut=r.constructor,dt=r.s==n.s?1:-1,oe=r.d,z=n.d;if(!oe||!oe[0]||!z||!z[0])return new ut(!r.s||!n.s||(oe?z&&oe[0]==z[0]:!z)?NaN:oe&&oe[0]==0||!z?dt*0:dt/0);for(l?(p=1,f=r.e-n.e):(l=ot,p=A,f=$e(r.e/p)-$e(n.e/p)),Me=z.length,Y=oe.length,y=new ut(dt),_=y.d=[],c=0;z[c]==(oe[c]||0);c++);if(z[c]>(oe[c]||0)&&f--,a==null?(P=a=ut.precision,s=ut.rounding):o?P=a+(r.e-n.e)+1:P=a,P<0)_.push(1),m=!0;else{if(P=P/p+2|0,c=0,Me==1){for(h=0,z=z[0],P++;(c<Y||h)&&P--;c++)se=h*l+(oe[c]||0),_[c]=se/z|0,h=se%z|0;m=h||c<Y}else{for(h=l/(z[0]+1)|0,h>1&&(z=e(z,h,l),oe=e(oe,h,l),Me=z.length,Y=oe.length),we=Me,S=oe.slice(0,Me),k=S.length;k<Me;)S[k++]=0;Ie=z.slice(),Ie.unshift(0),lt=z[0],z[1]>=l/2&&++lt;do h=0,u=t(z,S,Me,k),u<0?(C=S[0],Me!=k&&(C=C*l+(S[1]||0)),h=C/lt|0,h>1?(h>=l&&(h=l-1),d=e(z,h,l),b=d.length,k=S.length,u=t(d,S,b,k),u==1&&(h--,i(d,Me<b?Ie:z,b,l))):(h==0&&(u=h=1),d=z.slice()),b=d.length,b<k&&d.unshift(0),i(S,d,k,l),u==-1&&(k=S.length,u=t(z,S,Me,k),u<1&&(h++,i(S,Me<k?Ie:z,k,l))),k=S.length):u===0&&(h++,S=[0]),_[c++]=h,u&&S[0]?S[k++]=oe[we]||0:(S=[oe[we]],k=1);while((we++<Y||S[0]!==void 0)&&P--);m=S[0]!==void 0}_[0]||_.shift()}if(p==1)y.e=f,So=m;else{for(c=1,h=_[0];h>=10;h/=10)c++;y.e=c+f*p-1,E(y,o?a+y.e+1:a,s,m)}return y}}();function E(e,t,i,r){var n,a,s,o,l,u,f,c,h,p=e.constructor;e:if(t!=null){if(c=e.d,!c)return e;for(n=1,o=c[0];o>=10;o/=10)n++;if(a=t-n,a<0)a+=A,s=t,f=c[h=0],l=f/xe(10,n-s-1)%10|0;else if(h=Math.ceil((a+1)/A),o=c.length,h>=o)if(r){for(;o++<=h;)c.push(0);f=l=0,n=1,a%=A,s=a-A+1}else break e;else{for(f=o=c[h],n=1;o>=10;o/=10)n++;a%=A,s=a-A+n,l=s<0?0:f/xe(10,n-s-1)%10|0}if(r=r||t<0||c[h+1]!==void 0||(s<0?f:f%xe(10,n-s-1)),u=i<4?(l||r)&&(i==0||i==(e.s<0?3:2)):l>5||l==5&&(i==4||r||i==6&&(a>0?s>0?f/xe(10,n-s):0:c[h-1])%10&1||i==(e.s<0?8:7)),t<1||!c[0])return c.length=0,u?(t-=e.e+1,c[0]=xe(10,(A-t%A)%A),e.e=-t||0):c[0]=e.e=0,e;if(a==0?(c.length=h,o=1,h--):(c.length=h+1,o=xe(10,A-a),c[h]=s>0?(f/xe(10,n-s)%xe(10,s)|0)*o:0),u)for(;;)if(h==0){for(a=1,s=c[0];s>=10;s/=10)a++;for(s=c[0]+=o,o=1;s>=10;s/=10)o++;a!=o&&(e.e++,c[0]==ot&&(c[0]=1));break}else{if(c[h]+=o,c[h]!=ot)break;c[h--]=0,o=1}for(a=c.length;c[--a]===0;)c.pop()}return q&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function pt(e,t,i){if(!e.isFinite())return Oo(e);var r,n=e.e,a=qe(e.d),s=a.length;return t?(i&&(r=i-s)>0?a=a.charAt(0)+"."+a.slice(1)+Rt(r):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):n<0?(a="0."+Rt(-n-1)+a,i&&(r=i-s)>0&&(a+=Rt(r))):n>=s?(a+=Rt(n+1-s),i&&(r=i-n-1)>0&&(a=a+"."+Rt(r))):((r=n+1)<s&&(a=a.slice(0,r)+"."+a.slice(r)),i&&(r=i-s)>0&&(n+1===s&&(a+="."),a+=Rt(r))),a}function _n(e,t){var i=e[0];for(t*=A;i>=10;i/=10)t++;return t}function rn(e,t,i){if(t>Au)throw q=!0,i&&(e.precision=i),Error(wo);return E(new e(en),t,1,!0)}function nt(e,t,i){if(t>ha)throw Error(wo);return E(new e(tn),t,i,!0)}function Ao(e){var t=e.length-1,i=t*A+1;if(t=e[t],t){for(;t%10==0;t/=10)i--;for(t=e[0];t>=10;t/=10)i++}return i}function Rt(e){for(var t="";e--;)t+="0";return t}function Mo(e,t,i,r){var n,a=new e(1),s=Math.ceil(r/A+4);for(q=!1;;){if(i%2&&(a=a.times(t),ps(a.d,s)&&(n=!0)),i=$e(i/2),i===0){i=a.d.length-1,n&&a.d[i]===0&&++a.d[i];break}t=t.times(t),ps(t.d,s)}return q=!0,a}function hs(e){return e.d[e.d.length-1]&1}function Io(e,t,i){for(var r,n=new e(t[0]),a=0;++a<t.length;)if(r=new e(t[a]),r.s)n[i](r)&&(n=r);else{n=r;break}return n}function pa(e,t){var i,r,n,a,s,o,l,u=0,f=0,c=0,h=e.constructor,p=h.rounding,m=h.precision;if(!e.d||!e.d[0]||e.e>17)return new h(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(t==null?(q=!1,l=m):l=t,o=new h(.03125);e.e>-2;)e=e.times(o),c+=5;for(r=Math.log(xe(2,c))/Math.LN10*2+5|0,l+=r,i=a=s=new h(1),h.precision=l;;){if(a=E(a.times(e),l,1),i=i.times(++f),o=s.plus(J(a,i,l,1)),qe(o.d).slice(0,l)===qe(s.d).slice(0,l)){for(n=c;n--;)s=E(s.times(s),l,1);if(t==null)if(u<3&&lr(s.d,l-r,p,u))h.precision=l+=10,i=a=o=new h(1),f=0,u++;else return E(s,h.precision=m,p,q=!0);else return h.precision=m,s}s=o}}function Zt(e,t){var i,r,n,a,s,o,l,u,f,c,h,p=1,m=10,d=e,b=d.d,y=d.constructor,_=y.rounding,S=y.precision;if(d.s<0||!b||!b[0]||!d.e&&b[0]==1&&b.length==1)return new y(b&&!b[0]?-1/0:d.s!=1?NaN:b?0:d);if(t==null?(q=!1,f=S):f=t,y.precision=f+=m,i=qe(b),r=i.charAt(0),Math.abs(a=d.e)<15e14){for(;r<7&&r!=1||r==1&&i.charAt(1)>3;)d=d.times(e),i=qe(d.d),r=i.charAt(0),p++;a=d.e,r>1?(d=new y("0."+i),a++):d=new y(r+"."+i.slice(1))}else return u=rn(y,f+2,S).times(a+""),d=Zt(new y(r+"."+i.slice(1)),f-m).plus(u),y.precision=S,t==null?E(d,S,_,q=!0):d;for(c=d,l=s=d=J(d.minus(1),d.plus(1),f,1),h=E(d.times(d),f,1),n=3;;){if(s=E(s.times(h),f,1),u=l.plus(J(s,new y(n),f,1)),qe(u.d).slice(0,f)===qe(l.d).slice(0,f))if(l=l.times(2),a!==0&&(l=l.plus(rn(y,f+2,S).times(a+""))),l=J(l,new y(p),f,1),t==null)if(lr(l.d,f-m,_,o))y.precision=f+=m,u=s=d=J(c.minus(1),c.plus(1),f,1),h=E(d.times(d),f,1),n=o=1;else return E(l,y.precision=S,_,q=!0);else return y.precision=S,l;l=u,n+=2}}function Oo(e){return String(e.s*e.s/0)}function ma(e,t){var i,r,n;for((i=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(i<0&&(i=r),i+=+t.slice(r+1),t=t.substring(0,r)):i<0&&(i=t.length),r=0;t.charCodeAt(r)===48;r++);for(n=t.length;t.charCodeAt(n-1)===48;--n);if(t=t.slice(r,n),t){if(n-=r,e.e=i=i-r-1,e.d=[],r=(i+1)%A,i<0&&(r+=A),r<n){for(r&&e.d.push(+t.slice(0,r)),n-=A;r<n;)e.d.push(+t.slice(r,r+=A));t=t.slice(r),r=A-t.length}else r-=n;for(;r--;)t+="0";e.d.push(+t),q&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Iu(e,t){var i,r,n,a,s,o,l,u,f;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Eo.test(t))return ma(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(ku.test(t))i=16,t=t.toLowerCase();else if(wu.test(t))i=2;else if(Tu.test(t))i=8;else throw Error(Kt+t);for(a=t.search(/p/i),a>0?(l=+t.slice(a+1),t=t.substring(2,a)):t=t.slice(2),a=t.indexOf("."),s=a>=0,r=e.constructor,s&&(t=t.replace(".",""),o=t.length,a=o-a,n=Mo(r,new r(i),a,a*2)),u=Dr(t,i,ot),f=u.length-1,a=f;u[a]===0;--a)u.pop();return a<0?new r(e.s*0):(e.e=_n(u,f),e.d=u,q=!1,s&&(e=J(e,n,o*4)),l&&(e=e.times(Math.abs(l)<54?xe(2,l):T.pow(2,l))),q=!0,e)}function Ou(e,t){var i,r=t.d.length;if(r<3)return t.isZero()?t:Pi(e,2,t,t);i=1.4*Math.sqrt(r),i=i>16?16:i|0,t=t.times(1/Sn(5,i)),t=Pi(e,2,t,t);for(var n,a=new e(5),s=new e(16),o=new e(20);i--;)n=t.times(t),t=t.times(a.plus(n.times(s.times(n).minus(o))));return t}function Pi(e,t,i,r,n){var a,s,o,l,u=e.precision,f=Math.ceil(u/A);for(q=!1,l=i.times(i),o=new e(r);;){if(s=J(o.times(l),new e(t++*t++),u,1),o=n?r.plus(s):r.minus(s),r=J(s.times(l),new e(t++*t++),u,1),s=o.plus(r),s.d[f]!==void 0){for(a=f;s.d[a]===o.d[a]&&a--;);if(a==-1)break}a=o,o=r,r=s,s=a}return q=!0,s.d.length=f+1,s}function Sn(e,t){for(var i=e;--t;)i*=e;return i}function qo(e,t){var i,r=t.s<0,n=nt(e,e.precision,1),a=n.times(.5);if(t=t.abs(),t.lte(a))return Mt=r?4:1,t;if(i=t.divToInt(n),i.isZero())Mt=r?3:2;else{if(t=t.minus(i.times(n)),t.lte(a))return Mt=hs(i)?r?2:3:r?4:1,t;Mt=hs(i)?r?1:4:r?3:2}return t.minus(n).abs()}function ja(e,t,i,r){var n,a,s,o,l,u,f,c,h,p=e.constructor,m=i!==void 0;if(m?(He(i,1,ti),r===void 0?r=p.rounding:He(r,0,8)):(i=p.precision,r=p.rounding),!e.isFinite())f=Oo(e);else{for(f=pt(e),s=f.indexOf("."),m?(n=2,t==16?i=i*4-3:t==8&&(i=i*3-2)):n=t,s>=0&&(f=f.replace(".",""),h=new p(1),h.e=f.length-s,h.d=Dr(pt(h),10,n),h.e=h.d.length),c=Dr(f,10,n),a=l=c.length;c[--l]==0;)c.pop();if(!c[0])f=m?"0p+0":"0";else{if(s<0?a--:(e=new p(e),e.d=c,e.e=a,e=J(e,h,i,r,0,n),c=e.d,a=e.e,u=So),s=c[i],o=n/2,u=u||c[i+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(e.s<0?3:2)):s>o||s===o&&(r===4||u||r===6&&c[i-1]&1||r===(e.s<0?8:7)),c.length=i,u)for(;++c[--i]>n-1;)c[i]=0,i||(++a,c.unshift(1));for(l=c.length;!c[l-1];--l);for(s=0,f="";s<l;s++)f+=ca.charAt(c[s]);if(m){if(l>1)if(t==16||t==8){for(s=t==16?4:3,--l;l%s;l++)f+="0";for(c=Dr(f,n,t),l=c.length;!c[l-1];--l);for(s=1,f="1.";s<l;s++)f+=ca.charAt(c[s])}else f=f.charAt(0)+"."+f.slice(1);f=f+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)f="0"+f;f="0."+f}else if(++a>l)for(a-=l;a--;)f+="0";else a<l&&(f=f.slice(0,a)+"."+f.slice(a))}f=(t==16?"0x":t==2?"0b":t==8?"0o":"")+f}return e.s<0?"-"+f:f}function ps(e,t){if(e.length>t)return e.length=t,!0}function qu(e){return new this(e).abs()}function Fu(e){return new this(e).acos()}function Du(e){return new this(e).acosh()}function Cu(e,t){return new this(e).plus(t)}function Pu(e){return new this(e).asin()}function $u(e){return new this(e).asinh()}function Vu(e){return new this(e).atan()}function zu(e){return new this(e).atanh()}function Lu(e,t){e=new this(e),t=new this(t);var i,r=this.precision,n=this.rounding,a=r+4;return!e.s||!t.s?i=new this(NaN):!e.d&&!t.d?(i=nt(this,a,1).times(t.s>0?.25:.75),i.s=e.s):!t.d||e.isZero()?(i=t.s<0?nt(this,r,n):new this(0),i.s=e.s):!e.d||t.isZero()?(i=nt(this,a,1).times(.5),i.s=e.s):t.s<0?(this.precision=a,this.rounding=1,i=this.atan(J(e,t,a,1)),t=nt(this,a,1),this.precision=r,this.rounding=n,i=e.s<0?i.minus(t):i.plus(t)):i=this.atan(J(e,t,a,1)),i}function Ru(e){return new this(e).cbrt()}function Bu(e){return E(e=new this(e),e.e+1,2)}function Uu(e,t,i){return new this(e).clamp(t,i)}function ju(e){if(!e||typeof e!="object")throw Error(Nn+"Object expected");var t,i,r,n=e.defaults===!0,a=["precision",1,ti,"rounding",0,8,"toExpNeg",-Ti,0,"toExpPos",0,Ti,"maxE",0,Ti,"minE",-Ti,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(i=a[t],n&&(this[i]=fa[i]),(r=e[i])!==void 0)if($e(r)===r&&r>=a[t+1]&&r<=a[t+2])this[i]=r;else throw Error(Kt+i+": "+r);if(i="crypto",n&&(this[i]=fa[i]),(r=e[i])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[i]=!0;else throw Error(ko);else this[i]=!1;else throw Error(Kt+i+": "+r);return this}function Gu(e){return new this(e).cos()}function Zu(e){return new this(e).cosh()}function Fo(e){var t,i,r;function n(a){var s,o,l,u=this;if(!(u instanceof n))return new n(a);if(u.constructor=n,ms(a)){u.s=a.s,q?!a.d||a.e>n.maxE?(u.e=NaN,u.d=null):a.e<n.minE?(u.e=0,u.d=[0]):(u.e=a.e,u.d=a.d.slice()):(u.e=a.e,u.d=a.d?a.d.slice():a.d);return}if(l=typeof a,l==="number"){if(a===0){u.s=1/a<0?-1:1,u.e=0,u.d=[0];return}if(a<0?(a=-a,u.s=-1):u.s=1,a===~~a&&a<1e7){for(s=0,o=a;o>=10;o/=10)s++;q?s>n.maxE?(u.e=NaN,u.d=null):s<n.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[a]):(u.e=s,u.d=[a]);return}else if(a*0!==0){a||(u.s=NaN),u.e=NaN,u.d=null;return}return ma(u,a.toString())}else if(l!=="string")throw Error(Kt+a);return(o=a.charCodeAt(0))===45?(a=a.slice(1),u.s=-1):(o===43&&(a=a.slice(1)),u.s=1),Eo.test(a)?ma(u,a):Iu(u,a)}if(n.prototype=v,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.EUCLID=9,n.config=n.set=ju,n.clone=Fo,n.isDecimal=ms,n.abs=qu,n.acos=Fu,n.acosh=Du,n.add=Cu,n.asin=Pu,n.asinh=$u,n.atan=Vu,n.atanh=zu,n.atan2=Lu,n.cbrt=Ru,n.ceil=Bu,n.clamp=Uu,n.cos=Gu,n.cosh=Zu,n.div=Hu,n.exp=Wu,n.floor=Qu,n.hypot=Ju,n.ln=Ku,n.log=Yu,n.log10=ec,n.log2=Xu,n.max=tc,n.min=ic,n.mod=rc,n.mul=nc,n.pow=ac,n.random=sc,n.round=oc,n.sign=lc,n.sin=uc,n.sinh=cc,n.sqrt=fc,n.sub=hc,n.sum=pc,n.tan=mc,n.tanh=dc,n.trunc=gc,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(i=r[t++])||(e[i]=this[i]);return n.config(e),n}function Hu(e,t){return new this(e).div(t)}function Wu(e){return new this(e).exp()}function Qu(e){return E(e=new this(e),e.e+1,3)}function Ju(){var e,t,i=new this(0);for(q=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)i.d&&(i=i.plus(t.times(t)));else{if(t.s)return q=!0,new this(1/0);i=t}return q=!0,i.sqrt()}function ms(e){return e instanceof T||e&&e.toStringTag===To||!1}function Ku(e){return new this(e).ln()}function Yu(e,t){return new this(e).log(t)}function Xu(e){return new this(e).log(2)}function ec(e){return new this(e).log(10)}function tc(){return Io(this,arguments,"lt")}function ic(){return Io(this,arguments,"gt")}function rc(e,t){return new this(e).mod(t)}function nc(e,t){return new this(e).mul(t)}function ac(e,t){return new this(e).pow(t)}function sc(e){var t,i,r,n,a=0,s=new this(1),o=[];if(e===void 0?e=this.precision:He(e,1,ti),r=Math.ceil(e/A),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));a<r;)n=t[a],n>=429e7?t[a]=crypto.getRandomValues(new Uint32Array(1))[0]:o[a++]=n%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);a<r;)n=t[a]+(t[a+1]<<8)+(t[a+2]<<16)+((t[a+3]&127)<<24),n>=214e7?crypto.randomBytes(4).copy(t,a):(o.push(n%1e7),a+=4);a=r/4}else throw Error(ko);else for(;a<r;)o[a++]=Math.random()*1e7|0;for(r=o[--a],e%=A,r&&e&&(n=xe(10,A-e),o[a]=(r/n|0)*n);o[a]===0;a--)o.pop();if(a<0)i=0,o=[0];else{for(i=-1;o[0]===0;i-=A)o.shift();for(r=1,n=o[0];n>=10;n/=10)r++;r<A&&(i-=A-r)}return s.e=i,s.d=o,s}function oc(e){return E(e=new this(e),e.e+1,this.rounding)}function lc(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function uc(e){return new this(e).sin()}function cc(e){return new this(e).sinh()}function fc(e){return new this(e).sqrt()}function hc(e,t){return new this(e).sub(t)}function pc(){var e=0,t=arguments,i=new this(t[e]);for(q=!1;i.s&&++e<t.length;)i=i.plus(t[e]);return q=!0,E(i,this.precision,this.rounding)}function mc(e){return new this(e).tan()}function dc(e){return new this(e).tanh()}function gc(e){return E(e=new this(e),e.e+1,1)}v[Symbol.for("nodejs.util.inspect.custom")]=v.toString;v[Symbol.toStringTag]="Decimal";var T=v.constructor=Fo(fa);en=new T(en);tn=new T(tn);var Bt=T;function bc(e){let t=[];for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){let n=e.charCodeAt(i+1);if(n>=56320&&n<=57343){let a=r-55296,s=n-56320;r=2**16+a*2**10+s,i++}}t.push(r)}return t}var Cr=8205,ds=[127462,127487];function gs(e){return e===Cr||e===65038||e===65039||e>=127995&&e<=128e3||e>=129456&&e<=129460||e>=917536&&e<=917632}function vc(e){return e>=ds[0]&&e<=ds[1]}function xc(e){if(/^[\u0020-\u00FF]*$/.test(e))return e;let t=[],i=bc(e),r=0;for(;r<i.length;){let n=i[r++],a=i[r];if(a===Cr){let s=r-1;for(r+=2;i[r]===Cr;)r+=2;t.push(String.fromCodePoint(...i.slice(s,2*r-s+1)))}else if(gs(a)){let s=r-1;for(;gs(i[r]);)r+=i[r]===Cr?2:1;t.push(String.fromCodePoint(...i.slice(s,2*r-s-1)))}else vc(n)?(r+=1,t.push(String.fromCodePoint(...i.slice(r-2,2)))):t.push(String.fromCodePoint(n))}return t}var yc=class{constructor(e){this.obeyspaces=!1,e=e.replace(/[\u200E\u200F\u2066-\u2069\u202A-\u202E]/g,""),this.s=xc(e),this.pos=0}end(){return this.pos>=this.s.length}get(){return this.pos<this.s.length?this.s[this.pos++]:""}peek(){return this.s[this.pos]}match(e){let t;return typeof this.s=="string"?t=e.exec(this.s.slice(this.pos)):t=e.exec(this.s.slice(this.pos).join("")),t!=null&&t[0]?(this.pos+=t[0].length,t[0]):null}next(){if(this.end())return null;if(!this.obeyspaces&&this.match(/^[ \f\n\r\t\v\xA0\u2028\u2029]+/)||this.obeyspaces&&this.match(/^[ \f\n\r\t\v\xA0\u2028\u2029]/))return"<space>";let e=this.get();if(e==="\\"){if(!this.end()){let t=this.match(/^[a-zA-Z*]+/);if(t)this.match(/^[ \f\n\r\t\v\xA0\u2028\u2029]*/);else if(t=this.get(),t===" ")return"<space>";return"\\"+t}}else{if(e==="{")return"<{>";if(e==="}")return"<}>";if(e==="^"){if(this.peek()==="^"){this.get();let t=this.match(/^(\^(\^(\^(\^[0-9a-f])?[0-9a-f])?[0-9a-f])?[0-9a-f])?[0-9a-f][0-9a-f]/);if(t)return String.fromCodePoint(parseInt(t.slice(t.lastIndexOf("^")+1),16))}return e}else if(e==="#"){if(!this.end()){let t=!1;if(/[0-9?]/.test(this.peek())&&(t=!0,this.pos+1<this.s.length)){let i=this.s[this.pos+1];t=/[^0-9A-Za-z]/.test(i)}return t?"#"+this.get():"#"}}else if(e==="$")return this.peek()==="$"?(this.get(),"<$$>"):"<$>"}return e}};function Nc(e,t){let i=e.next();if(!i)return[];let r=[];if(i!=="\\relax"){if(i==="\\noexpand")i=e.next(),i&&r.push(i);else if(i==="\\obeyspaces")e.obeyspaces=!0;else if(i==="\\space"||i==="~")r.push("<space>");else if(i==="\\bgroup")r.push("<{>");else if(i==="\\egroup")r.push("<}>");else if(i==="\\string")i=e.next(),i&&(i[0]==="\\"?Array.from(i).forEach(n=>r.push(n==="\\"?"\\backslash":n)):i==="<{>"?r.push("\\{"):i==="<space>"?r.push("~"):i==="<}>"&&r.push("\\}"));else if(i==="\\csname"){for(;e.peek()==="<space>";)e.next();let n="",a=!1,s=[];do{if(s.length===0)if(/^#[0-9?]$/.test(e.peek())){let o=e.get().slice(1);s=j((t==null?void 0:t[o])??(t==null?void 0:t["?"])??"\\placeholder{}",t),i=s[0]}else i=e.next(),s=i?[i]:[];a=s.length===0,!a&&i==="\\endcsname"&&(a=!0,s.shift()),a||(a=i==="<$>"||i==="<$$>"||i==="<{>"||i==="<}>"||!!i&&i.length>1&&i[0]==="\\"),a||(n+=s.shift())}while(!a);n&&r.push("\\"+n),r=r.concat(s)}else if(i!=="\\endcsname")if(i.length>1&&i[0]==="#"){let n=i.slice(1);r=r.concat(j((t==null?void 0:t[n])??(t==null?void 0:t["?"])??"\\placeholder{}",t))}else r.push(i)}return r}function j(e,t){let i=e.toString().split(/\r?\n/),r="",n="";for(let o of i){r+=n,n=" ";let l=o.match(/((?:\\%)|[^%])*/);l!==null&&(r+=l[0])}let a=new yc(r),s=[];do s.push(...Nc(a,t));while(!a.end());return s}function Do(e){return j(e,[]).length}function w(e){let t="",i="";for(let r of e)r&&(/[a-zA-Z*]/.test(r[0])&&(i+=t),/\\[a-zA-Z]+\*?$/.test(r)?t=" ":t="",i+=r);return i}function Qt(e){let t=[];if(Array.isArray(e))for(let i of e)Array.isArray(i)?t=[...t,...i]:t.push(i);else t=[e];return w(t.map(i=>({"<space>":" ","<$$>":"$$","<$>":"$","<{>":"{","<}>":"}"})[i]??i))}var _c=[{name:"To",latexTrigger:["\\to"],kind:"infix",precedence:270},{latexTrigger:["\\rightarrow"],kind:"infix",precedence:270,parse:"To"}],$i=["Error","'missing'"];function wn(e){return!!(typeof e=="number"||kn(e)||typeof e=="string"&&/^[+-]?[0-9\.]/.test(e))}function kn(e){return e!==null&&typeof e=="object"&&"num"in e}function Co(e){return e!==null&&typeof e=="object"&&"sym"in e}function Sc(e){return e!==null&&typeof e=="object"&&"str"in e}function mr(e){return e!==null&&typeof e=="object"&&"fn"in e}var jn;function Po(e){if(!jn){let t=`^[${["Zyyy","Zinh","Arab","Armn","Beng","Bopo","Cyrl","Deva","Ethi","Geor","Grek","Gujr","Guru","Hang","Hani","Hebr","Hira","Kana","Knda","Khmr","Laoo","Latn","Mlym","Mymr","Orya","Sinh","Taml","Telu","Thaa","Thai","Tibt"].map(i=>`\\p{Script=${i}}`).join("")}]*$`;jn=new RegExp(t,"u")}return jn.test(e)}function Ye(e){return/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e)||Tn.test(e)?!0:Po(e)?new RegExp("^[\\p{XIDS}_]\\p{XIDC}*$","u").test(e):!1}var wc="\\u{FE0F}",kc="\\u{20E3}",Tc="\\u{200D}",Ec="\\p{RI}\\p{RI}",Ac="(?:[\\u{E0020}-\\u{E007E}]+\\u{E007F})",bs=`(?:\\p{EMod}|${wc}${kc}?|${Ac})`,Mc="(?:(?=\\P{XIDC})\\p{Emoji})",vs=`(?:${Mc}${bs}*|\\p{Emoji}${bs}+|${Ec})`,$o=`(?:${vs})(${Tc}${vs})*`,Ic=new RegExp(`(?:${$o})+`,"u"),Tn=new RegExp(`^(?:${$o})+$`,"u");function hi(e){return typeof e!="string"?"not-a-string":e===""?"empty-string":e.normalize()!==e?"expected-nfc":/[\u200E\u200F\u2066-\u2069\u202A-\u202E]/.test(e)?"unexpected-bidi-marker":Tn.test(e)?"valid":new RegExp("\\p{XIDC}","u").test(e)&&Ic.test(e)?"unexpected-mixed-emoji":Po(e)?Ye(e)?"valid":Ye(e[0])?"invalid-char":"invalid-first-char":"unexpected-script"}function H(e){return e==null?null:typeof e=="object"&&"str"in e?e.str:typeof e!="string"||e.length<2||e[0]!=="'"||e[e.length-1]!=="'"?null:e.substring(1,e.length-1)}function Vo(e){if(e==null||H(e)!==null)return null;let t=x(e);return t==null?e:[t,...(I(e)??[]).map(i=>Vo(i)).filter(i=>i!==null)]}function x(e){return Array.isArray(e)?typeof e[0]=="string"&&!Ye(e[0])?(console.error(`Invalid identifier "${e[0]}": ${hi(e[0])}`),null):e[0]:e==null?null:mr(e)?e.fn[0]:null}function Oc(e){let t=x(e);return typeof t=="string"?t:""}function I(e){return Array.isArray(e)?e.slice(1):e==null?null:mr(e)?e.fn.slice(1):null}function g(e,t){return Array.isArray(e)?e[t]??null:e==null?null:mr(e)?e.fn[t]??null:null}function Ge(e){return g(e,1)}function kt(e){return g(e,2)}function ae(e){return e==null?0:Array.isArray(e)?Math.max(0,e.length-1):mr(e)?Math.max(0,e.fn.length-1):0}function xs(e){return e==null?null:x(e)==="Hold"?g(e,1):e}function Q(e){if(typeof e=="string")return/^[+-]?[0-9\.]/.test(e)||e.length>=2&&e[0]==="'"&&e[e.length-1]==="'"?null:e;if(e==null)return null;let t=Co(e)?e.sym:e;return typeof t!="string"?null:t}function ys(e){let t=x(e);if(t==="KeyValuePair"||t==="Tuple"||t==="Pair"){let i=H(Ge(e));return i?[i,kt(e)??"Nothing"]:null}return null}function En(e){if(e===null)return null;if(typeof e=="object"&&"dict"in e)return e.dict;let t=ys(e);if(t)return{[t[0]]:t[1]};if(x(e)==="Dictionary"){let i={};for(let r=1;r<ae(e);r++){let n=ys(g(e,r));n&&(i[n[0]]=n[1])}return i}return null}function qc(e){if(e=e.toLowerCase().replace(/[0-9][nd]$/,"").replace(/[\u0009-\u000d\u0020\u00a0]/g,""),e==="nan")return NaN;if(e==="infinity"||e==="+infinity")return 1/0;if(e==="-infinity")return-1/0;if(/\([0-9]+\)/.test(e)){let[t,i,r,n]=e.match(/(.+)\(([0-9]+)\)(.*)$/)??[];e=i+r.repeat(Math.ceil(16/r.length))+(n??"")}return parseFloat(e)}function D(e){return typeof e=="number"?e:typeof e=="string"?qc(e):e==null?null:kn(e)?D(e.num):null}function ur(e){if(e==null)return null;if(Q(e)==="Half")return[1,2];let t=x(e);if(!t)return null;let i=null,r=null;if(t==="Negate"){let n=ur(Ge(e));if(n)return[-n[0],n[1]]}if((t==="Rational"||t==="Divide")&&(i=D(Ge(e))??NaN,r=D(kt(e))??NaN),t==="Power"){let n=D(kt(e));n===1?(i=D(Ge(e)),r=1):n===-1&&(i=1,r=D(Ge(e)))}return t==="Multiply"&&x(kt(e))==="Power"&&D(kt(kt(e)))===-1&&(i=D(Ge(e)),r=D(Ge(kt(e)))),i===null||r===null?null:Number.isInteger(i)&&Number.isInteger(r)?[i,r]:null}function Pr(e,t){let i=x(e);if(i!==null)return[Pr(i,t),...(I(e)??[]).map(a=>Pr(a,t))];let r=En(e);if(r!==null){let a=Object.keys(r),s={};for(let o of a)s[o]=Pr(r[o],t);return{dict:s}}let n=Q(e);return n&&t[n]?t[n]:e}function da(e,t){let i=null;if(Array.isArray(e)&&(i=e),mr(e)&&(i=e.fn),i===null)return[];let r=1,n=[];for(;r<i.length;)n.push(t(i[r])),r+=1;return n}function $r(e,t,i,r="both"){if(r==="non")return[e,t,i];let n=x(t),a=x(i);return r==="left"?n===e?[e,...I(t)??[],i]:[e,t,i]:r==="right"?a===e?[e,t,...I(i)??[]]:[e,t,i]:n===e&&a===e?[e,...I(t)??[],...I(i)??[]]:n===e?[e,...I(t)??[],i]:a===e?[e,t,...I(i)??[]]:[e,t,i]}function zo(e){if(e===null)return null;let t=x(e);if(t==="Delimiter"){if(e=g(e,1),e===null)return[];if(t=x(e),t!=="Sequence")return[e]}return t!=="Sequence"?null:I(e)??[]}function ye(e){return x(e)==="Sequence"&&ae(e)===0}function G(e){return ye(e)?$i:e??$i}function ga(e){return e[0]==="Square"?ga(e.slice(1))+2:e.reduce((t,i)=>t+nn(i),0)}function nn(e){if(e===null)return 0;if(typeof e=="number"||typeof e=="string"||wn(e)||Co(e)||Sc(e))return 1;if(Array.isArray(e))return ga(e);if("fn"in e)return ga(e.fn);let t=En(e);if(t){let i=Object.keys(t);return 1+i.length+i.reduce((r,n)=>r+nn(t[n]),0)}return 0}function Fc(e){if(x(e)!=="Multiply")return[[],[]];let t=[],i=[],r=I(e)??[];for(let n of r)if(x(n)==="Power"){let a=g(n,1),s=g(n,2);if(x(s)==="Negate"){let o=g(s,1);a&&o&&i.push(["Power",a,o])}else{let o=D(s)??NaN;o===-1?a&&i.push(a):o<0?a&&i.push(["Power",a,-o]):t.push(n)}}else if(x(n)==="Rational"&&ae(n)===2){let a=g(n,1),s=g(n,2);D(a)!==1&&t.push(a),D(s)!==1&&i.push(s)}else{let a=ur(n);a!==null?(a[0]!==1&&t.push(a[0]),i.push(a[1])):t.push(n)}return[t,i]}function Dc(e){let t=e.parseOptionalGroup(),i=e.parseGroup()??e.parseToken();return i===null||ye(i)?t!==null?["Root",$i,G(t)]:["Sqrt",$i]:t!==null?["Root",i,t]:["Sqrt",i]}function Ji(e,t,i,r){return i===null?"\\sqrt{}":(r=r??2,t==="solidus"?e.wrapShort(i)+"^{1\\/"+e.serialize(r)+"}":t==="quotient"?e.wrapShort(i)+"^{\\frac{1}{"+e.serialize(r)+"}}":D(r)===2?"\\sqrt{"+e.serialize(i)+"}":"\\sqrt["+e.serialize(r)+"]{"+e.serialize(i)+"}")}function Cc(e,t){e.level-=1;let i=x(t),r="",n=g(t,1);if(i==="Negate")r="-"+e.wrap(n,276);else if(i==="Add"){if(e.canonical&&ae(t)===2&&e.options.invisiblePlus!=="+"){let[o,l]=[g(t,1),g(t,2)],[u,f]=[o,l],c=D(u),h=ur(f);if((c===null||h===null)&&([u,f]=[l,o],c=D(u),h=ur(f)),c!==null&&h!==null&&isFinite(c)&&Number.isInteger(c)&&c>=0&&c<=1e3&&isFinite(h[0])&&isFinite(h[1])&&h[0]>0&&h[0]<=100&&h[1]<=100)return r=w([e.serialize(u),e.options.invisiblePlus,e.serialize(f)]),e.level+=1,r}let a=D(n)??NaN;r=e.serialize(n);let s=ae(t)+1;for(let o=2;o<s;o++)if(n=g(t,o),a=D(n)??NaN,a<0)r+=e.serialize(n);else if(x(n)==="Negate")r+=e.wrap(n,he);else{let l=e.wrap(n,he);l[0]==="-"||l[0]==="+"?r+=l:r+="+"+l}}else if(i==="Subtract"){r=e.wrap(n,he);let a=g(t,2);if(a!==null){let s=e.wrap(a,he);s[0]==="-"?r+="+"+s.slice(1):s[0]==="+"?r+="-"+s.slice(1):r=r+"-"+s}}return e.level+=1,r}function Lo(e,t){if(t===null)return"";e.level-=1;let i="";if(e.canonical===!0){let[o,l]=Fc(t);l.length>0&&(l.length===1&&l[0]===1?o.length===0?i="1":o.length===1?i=e.serialize(o[0]):i=Lo(e,["Multiply",...o]):i=e.serialize(["Divide",o.length===1?o[0]:["Multiply",...o],l.length===1?l[0]:["Multiply",...l]]))}if(i)return e.level+=1,i;let r=!1,n=null,a=ae(t)+1,s=!1;for(let o=1;o<a;o++){if(n=g(t,o),n===null)continue;let l;if(wn(n)){l=e.serialize(n),l==="-1"&&!i?(i="",r=!r):(l[0]==="-"&&(l=l.slice(1),r=!r),i=i?w([i,e.options.multiply,l]):l),s=!0;continue}if(x(n)==="Power"){let u=ur(g(n,2));if(u){let[f,c]=u;if(f===1&&c!==null){i+=Ji(e,e.rootStyle(n,e.level),g(n,1),c),s=!1;continue}}}if(x(n)==="Power"&&!isNaN(D(g(n,1))??NaN)){l=e.serialize(n),i=i?w([i,e.options.multiply,l]):l,s=!0;continue}if(x(n)==="Negate"&&(n=g(n,1),r=!r),l=e.wrap(n,St),!i)i=l;else{let u=x(n);s&&(u==="Divide"||u==="Rational")?i=w([i,e.options.multiply,l]):e.options.invisibleMultiply?i=w([i,e.options.invisibleMultiply,l]):i=w([i,l])}s=!1}return e.level+=1,r?"-"+i:i}function Pc(e){let t=e.parseGroup(),i=null;if(t===null?(t=e.parseToken(),i=e.parseToken()):i=e.parseGroup(),t=G(t),i=G(i),x(t)==="PartialDerivative"&&(x(i)==="PartialDerivative"||x(i)==="Multiply"&&x(g(i,1))==="PartialDerivative")){let r=g(t,3)??null,n=g(t,1);n===null&&(n=G(e.parseExpression()));let a=[];if(x(i)==="Multiply"){for(let s of I(i)??[])if(x(s)==="PartialDerivative"){let o=g(s,2);o&&a.push(o)}}else{let s=g(i,2);s&&a.push(s)}return a.length>1&&(a=["List",...a]),["PartialDerivative",n,...a,r===null?1:r]}return["Divide",t,i]}function Ns(e,t){if(t===null)return"";let i=G(g(t,1)),r=G(g(t,2)),n=e.canonical?e.fractionStyle(t,e.level):"quotient";if(n==="inline-solidus"||n==="nice-solidus"){let l=e.wrapShort(i),u=e.wrapShort(r);return n==="inline-solidus"?`${l}\\/${u}`:`{}^{${l}}\\!\\!/\\!{}_{${u}}`}else{if(n==="reciprocal")return D(i)===1?e.wrap(r)+"^{-1}":e.wrap(i)+e.wrap(r)+"^{-1}";if(n==="factor")return D(r)===1?e.wrap(i):"\\frac{1}{"+e.serialize(r)+"}"+e.wrapString(e.serialize(i),e.groupStyle(t,1))}let a="\\frac";n==="block-quotient"?a="\\dfrac":n==="inline-quotient"&&(a="\\tfrac");let s=e.serialize(i),o=e.serialize(r);return`${a}{${s}}{${o}}`}function Gn(e,t){if(!t)return"";let i=x(t),r=G(g(t,1));if(i==="Sqrt")return Ji(e,e.rootStyle(t,e.level-1),r,2);let n=G(g(t,2));if(i==="Root")return Ji(e,e.rootStyle(t,e.level-1),r,n);if(e.canonical){let a=D(n)??1;if(a===-1)return e.serialize(["Divide","1",r]);if(a<0)return e.serialize(["Divide","1",["Power",r,-a]]);if(x(n)==="Divide"||x(n)==="Rational"){if(D(g(n,1))===1){let s=e.rootStyle(t,e.level);return Ji(e,s,r,g(n,2))}if(D(g(n,2))===2)return`${e.serialize(["Sqrt",r])}^{${e.serialize(g(n,1))}}`}else if(x(n)==="Power"&&D(g(n,2))===-1){let s=e.rootStyle(t,e.level);return Ji(e,s,r,g(n,1))}}return e.wrapShort(r)+"^{"+e.serialize(n)+"}"}var $c=[{name:"CatalanConstant",identifierTrigger:"G"},{name:"GoldenRatio",latexTrigger:"\\varphi"},{name:"EulerGamma",latexTrigger:"\\gamma"},{name:"Degrees",latexTrigger:["\\degree"],kind:"postfix",precedence:880,parse:(e,t)=>["Degrees",t],serialize:(e,t)=>w([e.serialize(g(t,1)),"\\degree"])},{latexTrigger:["\\degree"],kind:"postfix",precedence:880,parse:(e,t)=>["Degrees",t]},{latexTrigger:["^","<{>","\\circ","<}>"],kind:"postfix",parse:(e,t)=>["Degrees",t]},{latexTrigger:["^","\\circ"],kind:"postfix",parse:(e,t)=>["Degrees",t]},{latexTrigger:[""],kind:"postfix",precedence:880,parse:(e,t)=>["Degrees",t]},{latexTrigger:["\\ang"],parse:e=>{let t=e.parseGroup();return t===null?["Degrees"]:["Degrees",t]}},{latexTrigger:["\\infty"],parse:{num:"+Infinity"}},{name:"ComplexInfinity",latexTrigger:["\\tilde","\\infty"],serialize:"\\tilde\\infty"},{latexTrigger:["\\tilde","<{>","\\infty","<}>"],parse:"ComplexInfinity"},{name:"Pi",kind:"symbol",latexTrigger:["\\pi"]},{latexTrigger:[""],parse:"Pi"},{name:"ExponentialE",latexTrigger:["\\exponentialE"],parse:"ExponentialE",serialize:"\\exponentialE"},{latexTrigger:"\\operatorname{e}",parse:"ExponentialE"},{latexTrigger:"\\mathrm{e}",parse:"ExponentialE"},{kind:"function",identifierTrigger:"exp",parse:"Exp"},{latexTrigger:"\\exp",parse:"Exp"},{name:"ImaginaryUnit",latexTrigger:["\\imaginaryI"]},{latexTrigger:"\\operatorname{i}",parse:"ImaginaryUnit"},{latexTrigger:"\\mathrm{i}",parse:"ImaginaryUnit"},{name:"Abs",kind:"matchfix",openTrigger:"|",closeTrigger:"|",parse:(e,t)=>ye(t)?null:["Abs",t]},{kind:"matchfix",openTrigger:["\\vert"],closeTrigger:["\\vert"],parse:(e,t)=>ye(t)?null:["Abs",t]},{identifierTrigger:"abs",kind:"function",parse:"Abs"},{name:"Add",latexTrigger:["+"],kind:"infix",associativity:"both",precedence:he,parse:(e,t,i)=>{if(i&&he<i.minPrec)return null;let r=e.parseExpression({...i,minPrec:he});return r===null?null:$r("Add",t,r)},serialize:Cc},{kind:"prefix",latexTrigger:["+"],precedence:he,parse:(e,t)=>t&&he<t.minPrec?null:e.parseExpression({...t,minPrec:400})},{name:"Ceil",kind:"matchfix",openTrigger:"\\lceil",closeTrigger:"\\rceil",parse:(e,t)=>ye(t)?null:["Ceil",t]},{kind:"matchfix",openTrigger:[""],closeTrigger:[""],parse:(e,t)=>ye(t)?null:["Ceil",t]},{identifierTrigger:"ceil",kind:"function",parse:"Ceil"},{name:"Chop",identifierTrigger:"chop",kind:"function",parse:"Chop"},{name:"Complex",precedence:he-1,serialize:(e,t)=>{let i=e.serialize(g(t,1)),r=D(g(t,2));if(r===0)return i;let n=r===1?"\\imaginaryI":r===-1?"-\\imaginaryI":w([e.serialize(g(t,2)),"\\imaginaryI"]);return D(g(t,1))===0?n:r!==null&&r<0?w([i,n]):w([i,"+",n])}},{name:"Divide",latexTrigger:"\\frac",precedence:Pt,parse:Pc,serialize:Ns},{kind:"infix",latexTrigger:"\\over",precedence:Pt,parse:"Divide"},{latexTrigger:["\\/"],kind:"infix",associativity:"non",precedence:Pt,parse:"Divide"},{latexTrigger:["/"],kind:"infix",associativity:"non",precedence:Pt,parse:"Divide"},{latexTrigger:["\\div"],kind:"infix",associativity:"non",precedence:Pt,parse:"Divide"},{name:"Exp",serialize:(e,t)=>{let i=g(t,1);return Q(i)||D(i)!==null?w(["\\exponentialE^{",e.serialize(i),"}"]):w(["\\exp",e.wrap(G(i))])}},{name:"Factorial",latexTrigger:["!"],kind:"postfix",precedence:fs},{name:"Factorial2",latexTrigger:["!","!"],kind:"postfix",precedence:fs},{name:"Floor",kind:"matchfix",openTrigger:"\\lfloor",closeTrigger:"\\rfloor",parse:(e,t)=>ye(t)?null:["Floor",t]},{kind:"matchfix",openTrigger:[""],closeTrigger:[""],parse:(e,t)=>ye(t)?null:["Floor",t]},{identifierTrigger:"floor",kind:"function",parse:"Floor"},{latexTrigger:["\\Gamma"],parse:"Gamma"},{name:"GCD",identifierTrigger:"gcd",kind:"function"},{identifierTrigger:"GCD",kind:"function",parse:"GCD"},{name:"Half",serialize:"\\frac12"},{name:"Lg",latexTrigger:["\\lg"],serialize:(e,t)=>"\\log_{10}"+e.wrapArguments(t),parse:e=>{let t=e.parseArguments("implicit");return t===null?"Lg":["Log",...t,10]}},{name:"Lb",latexTrigger:"\\lb",parse:e=>{let t=e.parseArguments("implicit");return t===null?"Log":["Log",t[0],2]}},{name:"Ln",latexTrigger:["\\ln"],parse:e=>ws("Ln",e),serialize:(e,t)=>"\\ln"+e.wrapArguments(t)},{name:"Log",latexTrigger:["\\log"],parse:e=>ws("Log",e),serialize:(e,t)=>{let i=kt(t);return i?w(["\\log_{",e.serialize(i),"}",e.wrap(Ge(t))]):"\\log"+e.wrapArguments(t)}},{name:"LCM",identifierTrigger:"lcm",kind:"function"},{identifierTrigger:"LCM",kind:"function",parse:"LCM"},{identifierTrigger:"max",kind:"function",parse:"Max"},{identifierTrigger:"min",kind:"function",parse:"Min"},{name:"Max",latexTrigger:"\\max",kind:"function"},{name:"Min",latexTrigger:"\\min",kind:"function"},{name:"Supremum",latexTrigger:"\\sup",kind:"function"},{name:"Infimum",latexTrigger:"\\inf",kind:"function"},{name:"Limit",latexTrigger:"\\lim",kind:"expression",parse:e=>{if(!e.match("_"))return null;let t=e.parseGroup();if(x(t)!=="To")return null;let i=e.parseArguments("implicit");return i?["Limit",["Function",i[0],g(t,1)],g(t,2)]:null},serialize:(e,t)=>{let i=g(t,1),r=g(i,2),n=g(t,2);return w(["\\lim_{",e.serialize(r),"\\to",e.serialize(n),"}",e.serialize(g(i,1))])}},{name:"MinusPlus",latexTrigger:["\\mp"],kind:"infix",associativity:"both",precedence:li},{name:"Multiply",latexTrigger:["\\times"],kind:"infix",associativity:"both",precedence:St,serialize:Lo},{latexTrigger:["\\cdot"],kind:"infix",associativity:"both",precedence:St,parse:(e,t,i)=>{let r=e.parseExpression({...i,minPrec:St+2});return r===null?["Multiply",t,$i]:$r("Multiply",t,r)}},{latexTrigger:["*"],kind:"infix",associativity:"both",precedence:St,parse:(e,t,i)=>{let r=e.parseExpression({...i,minPrec:St+2});return r===null?["Multiply",t,$i]:$r("Multiply",t,r)}},{name:"Mod",latexTrigger:"\\bmod",kind:"infix",precedence:Pt,serialize:(e,t)=>{if(ae(t)!==2)return"";let i=e.serialize(g(t,1)),r=e.serialize(g(t,2));return w([i,"\\bmod",r])}},{latexTrigger:"\\mod",kind:"infix",precedence:Pt,parse:"Mod"},{latexTrigger:"\\pmod",kind:"prefix",precedence:$,parse:e=>{let t=e.parseGroup()??e.parseToken();return["Mod",G(t)]}},{name:"Congruent",serialize:(e,t)=>{let i=e.serialize(g(t,1)),r=e.serialize(g(t,2));if(g(t,3)===null)return w([i,"\\equiv",r]);let n=e.serialize(g(t,3));return w([i,"\\equiv",r,"\\pmod{",n,"}"])}},{name:"Negate",latexTrigger:["-"],kind:"prefix",precedence:he+2,parse:(e,t)=>{if(/\d/.test(e.peek))return null;let i=e.index;if(e.parseNumber()!==null)return e.index=i,null;let r=e.parseExpression({...t,minPrec:he+3});return["Negate",G(r)]}},{kind:"matchfix",openTrigger:"||",closeTrigger:"||",parse:(e,t)=>ye(t)?null:["Norm",t]},{name:"Norm",kind:"matchfix",openTrigger:["\\left","\\Vert"],closeTrigger:["\\right","\\Vert"],parse:(e,t)=>ye(t)?null:["Norm",t]},{name:"PlusMinus",latexTrigger:["\\pm"],kind:"infix",associativity:"both",precedence:li,serialize:(e,t)=>{let i=g(t,1);if(i===null)return"\\pm";if(ae(t)===1)return w(["\\pm",e.serialize(i)]);let r=g(t,2);return w([e.serialize(i),"\\pm",e.serialize(r)])}},{latexTrigger:["\\pm"],kind:"prefix",precedence:li,parse:(e,t)=>{let i=e.parseExpression({...t,minPrec:400});return["PlusMinus",G(i)]}},{latexTrigger:["\\plusmn"],kind:"infix",associativity:"both",precedence:li,parse:(e,t,i)=>{let r=e.parseExpression({...i,minPrec:400});return["PlusMinus",t,G(r)]}},{latexTrigger:["\\plusmn"],kind:"prefix",precedence:li,parse:(e,t)=>{let i=e.parseExpression({...t,minPrec:400});return["PlusMinus",G(i)]}},{name:"Power",latexTrigger:["^"],kind:"infix",serialize:Gn},{latexTrigger:"\\prod",precedence:St,name:"Product",parse:_s("Product",St),serialize:Ss("\\prod")},{name:"Rational",precedence:Pt,serialize:(e,t)=>t&&ae(t)===1?"\\operatorname{Rational}"+e.wrapArguments(t):Ns(e,t)},{name:"Root",serialize:Gn},{name:"Round",identifierTrigger:"round",kind:"function"},{name:"Square",precedence:720,serialize:(e,t)=>e.wrapShort(g(t,1))+"^2"},{latexTrigger:["\\sum"],precedence:he,name:"Sum",parse:_s("Sum",he),serialize:Ss("\\sum")},{name:"Sign",identifierTrigger:"sgn",kind:"function"},{name:"Sqrt",latexTrigger:["\\sqrt"],parse:Dc,serialize:Gn},{name:"Subtract",latexTrigger:["-"],kind:"infix",associativity:"both",precedence:he+2,parse:(e,t,i)=>{let r=e.parseExpression({...i,minPrec:he+3});return["Subtract",t,G(r)]},serialize:(e,t)=>{let i=e.wrap(g(t,1),he+2),r=e.wrap(g(t,2),he+3);return w([i,"-",r])}}];function _s(e,t){return i=>{i.skipSpace();let r=null,n=null;for(;!(n&&r)&&(i.peek==="_"||i.peek==="^");)i.match("_")?n=i.parseGroup()??i.parseToken():i.match("^")&&(r=i.parseGroup()??i.parseToken()),i.skipSpace();(n==="Nothing"||ye(n))&&(n=null),(r==="Nothing"||ye(r))&&(r=null);let a=null,s=null;x(n)==="Equal"?(a=g(n,1),s=g(n,2)):a=n;let o=i.parseExpression({minPrec:t+1});return o?r?[e,o,["Tuple",a??"Nothing",s??1,r]]:s?[e,o,["Tuple",a??"Nothing",s]]:a?[e,o,["Tuple",a]]:[e,o]:[e]}}function Ss(e){return(t,i)=>{if(!g(i,1))return e;let r=g(i,2),n=x(r);n!=="Tuple"&&n!=="Triple"&&n!=="Pair"&&n!=="Single"&&(r=null);let a=g(r,1);a&&x(a)==="Hold"&&(a=g(a,1));let s=g(i,1);if(!r)return g(i,2)?w([e,"_{",t.serialize(g(i,2)),"}",t.serialize(s)]):w([e,t.serialize(s)]);let o=g(r,2),l=[];a&&Q(a)!=="Nothing"&&o?l=[t.serialize(a),"=",t.serialize(o)]:a&&Q(a)!=="Nothing"?l=[t.serialize(a)]:o&&(l=[t.serialize(o)]),l.length>0&&(l=["_{",...l,"}"]);let u=[];return g(r,3)&&(u=["^{",t.serialize(g(r,3)),"}"]),w([e,...u,...l,t.serialize(s)])}}function ws(e,t){let i=null;t.match("_")&&(i=t.parseGroup()??t.nextToken());let r=t.parseArguments("implicit");return r===null&&i===null?[e]:r===null?[e,i]:i===null?[e,...r]:i===10?["Log",r[0]]:i===2?["Lb",...r]:["Log",r[0],i]}function Zn(e,t,i,r,n){if(t&&t.minPrec>=r)return null;let a=i?[i]:["Nothing"],s=!1;for(;!s;){for(s=!0,e.skipSpace();e.match(n);)a.push("Nothing"),e.skipSpace();if(e.atTerminator(t))a.push("Nothing");else{let o=e.parseExpression({...t,minPrec:r});a.push(o??"Nothing"),s=o===null}s||(e.skipSpace(),s=!e.match(n))}return a}function _r(e=""){return(t,i)=>{if(!i)return"";let r=I(i)??[];if(r.length===0)return"";if(r.length===1)return t.serialize(r[0]);e={"&":"\\&",":":"\\colon","|":"\\mvert","-":"-","":"\\cdot","":"-","":"--","":"---","":"-","":"\\bullet","":"\\ldots"}[e]??e;let n=r.reduce((a,s)=>(a.push(t.serialize(s),e),a),[]);return n.pop(),w(n)}}var Vc=[{latexTrigger:["\\placeholder"],kind:"symbol",parse:e=>{for(;e.match("<space>"););if(e.match("["))for(;!e.match("]")&&!e.atBoundary;)e.nextToken();for(;e.match("<space>"););if(e.match("<{>"))for(;!e.match("<}>")&&!e.atBoundary;)e.nextToken();return"Nothing"}},{name:"Function",latexTrigger:["\\mapsto"],kind:"infix",precedence:li,parse:(e,t)=>{let i=[];if(x(t)==="Delimiter"&&(t=g(t,1)??"Nothing"),x(t)==="Sequence")for(let n of I(t)??[]){if(!Q(n))return null;i.push(Q(n))}else{if(!Q(t))return null;i=[Q(t)]}let r=e.parseExpression({minPrec:li})??"Nothing";return x(r)==="Delimiter"&&(r=g(r,1)??"Nothing"),x(r)==="Sequence"&&(r=["Block",...I(r)??[]]),["Function",r,...i]},serialize:(e,t)=>{var r;let i=I(t);return i===null||i.length<1?"()\\mapsto()":i.length===1?w(["()","\\mapsto",e.serialize(g(t,1))]):i.length===2?w([e.serialize(g(t,2)),"\\mapsto",e.serialize(g(t,1))]):w([e.wrapString((((r=I(t))==null?void 0:r.slice(1))??[]).map(n=>e.serialize(n)).join(", "),"normal"),"\\mapsto",e.serialize(g(t,1))])}},{name:"Apply",kind:"function",identifierTrigger:"apply",serialize:(e,t)=>{if(typeof g(t,1)=="string"){let i=t.slice(1);return e.serialize(i)}return e.serializeFunction(I(t))}},{latexTrigger:"\\lhd",kind:"infix",precedence:20,parse:"Apply"},{latexTrigger:"\\rhd",kind:"infix",precedence:20,parse:(e,t)=>["Apply",e.parseExpression({minPrec:21})??"Nothing",t]},{name:"Assign",latexTrigger:"\\coloneq",kind:"infix",associativity:"right",precedence:Nr,serialize:(e,t)=>{var r;let i=xs(g(t,1));if(x(g(t,2))==="Function"){let n=g(t,2),a=xs(g(n,1)),s=((r=I(n))==null?void 0:r.slice(1))??[];return w([e.serialize(i),e.wrapString(s.map(o=>e.serialize(o)).join(", "),e.options.applyFunctionStyle(t,e.level)),"\\coloneq",e.serialize(a)])}return w([e.serialize(i),"\\coloneq",e.serialize(g(t,2))])},parse:Sr},{latexTrigger:"\\coloneqq",kind:"infix",associativity:"right",precedence:Nr,parse:Sr},{latexTrigger:"\\colonequals",kind:"infix",associativity:"right",precedence:Nr,parse:Sr},{latexTrigger:[":","="],kind:"infix",associativity:"right",precedence:Nr,parse:Sr},{name:"BaseForm",serialize:(e,t)=>{let i=D(g(t,2))??NaN;if(isFinite(i)&&i>=2&&i<=36){let r=D(g(t,1))??NaN;if(isFinite(r)&&Number.isInteger(r)){let n=Number(r).toString(i),a=0;if(i===2||i===10?a=4:i===16?a=2:i>16&&(a=4),a>0){let s=n;n="";for(let o=0;o<s.length;o++)o>0&&o%a===0&&(n="\\, "+n),n=s[s.length-o-1]+n}return`(\\text{${n}}_{${i}}`}}return"\\operatorname{BaseForm}("+e.serialize(g(t,1))+", "+e.serialize(g(t,2))+")"}},{name:"Sequence",serialize:_r(" ")},{name:"InvisibleOperator",serialize:_r("")},{name:"Delimiter",serialize:(e,t)=>{let i=e.options.groupStyle(t,e.level+1),r=g(t,1),n=x(r),a={Set:"{,}",List:"[,]",Tuple:"(,)",Single:"(,)",Pair:"(,)",Triple:"(,)",Sequence:"(,)",String:'""'}[typeof n=="string"?n:""],s=a?r:["Sequence",r];if(a??(a="(,)"),ae(t)>1){let c=H(g(t,2));typeof c=="string"&&c.length<=3&&(a=c)}let[o,l,u]=["","",""];a.length===3?[o,l,u]=a:a.length===2?[o,u]=a:a.length===1&&(l=a);let f=r?s?_r(l)(e,s):e.serialize(r):"";return e.wrapString(f,i,o+u)}},{name:"Domain",serialize:(e,t)=>x(t)==="Error"?e.serialize(t):`\\mathbf{${e.serialize(g(t,1))}}`},{latexTrigger:["\\mathtip"],parse:e=>{let t=e.parseGroup();return e.parseGroup(),t}},{latexTrigger:["\\texttip"],parse:e=>{let t=e.parseGroup();return e.parseGroup(),t}},{latexTrigger:["\\error"],parse:e=>["Error",e.parseGroup()]},{name:"Error",serialize:(e,t)=>{let i=g(t,1);if(H(i)==="missing")return`\\error{${e.options.missingSymbol??"\\placeholder{}"}}`;let r=Rc(e,t)||"\\blacksquare",n=x(i)==="ErrorCode"?H(g(i,1)):H(i);return n==="incompatible-domain"?Q(g(i,3))==="Undefined"?`\\mathtip{\\error{${r}}}{\\notin ${e.serialize(g(i,2))}}`:`\\mathtip{\\error{${r}}}{\\in ${e.serialize(g(i,3))}\\notin ${e.serialize(g(i,2))}}`:typeof n=="string"?`\\error{${r}}`:`\\error{${r}}`}},{name:"ErrorCode",serialize:(e,t)=>{let i=H(g(t,1));return i==="missing"?e.options.missingSymbol??"\\placeholder{}":i==="unexpected-command"||i==="unexpected-operator"||i==="unexpected-token"||i==="invalid-identifier"||i==="unknown-environment"||i==="unexpected-base"||i==="incompatible-domain"||i==="invalid-domain"?"":`\\texttip{\\error{\\blacksquare}}{\\mathtt{${i}}}`}},{name:"FromLatex",serialize:(e,t)=>`\\texttt{${Lc(H(g(t,1)))}}`},{name:"Latex",serialize:(e,t)=>t===null?"":w(da(t,i=>H(i)??e.serialize(i)))},{name:"LatexString",serialize:(e,t)=>t===null?"":w(da(t,i=>e.serialize(i)))},{name:"LatexTokens",serialize:zc},{name:"List",kind:"matchfix",openTrigger:"[",closeTrigger:"]",parse:Ro,serialize:(e,t)=>w(["\\bigl\\lbrack",_r(", ")(e,t),"\\bigr\\rbrack"])},{kind:"matchfix",openTrigger:"(",closeTrigger:")",parse:Bc},{latexTrigger:[","],kind:"infix",precedence:20,parse:(e,t,i)=>{let r=Zn(e,i,t,20,",");return r===null?null:["Delimiter",["Sequence",...r],{str:","}]}},{latexTrigger:[","],kind:"prefix",precedence:20,parse:(e,t)=>{let i=Zn(e,t,null,20,",");return i===null?null:["Delimiter",["Sequence",...i],{str:","}]}},{name:"Range",latexTrigger:[".","."],kind:"infix",precedence:10,parse:Uc,serialize:(e,t)=>{let i=I(t);if(i===null)return"";if(i.length===1)return"1.."+e.serialize(g(t,1));if(i.length===2)return e.wrap(g(t,1),10)+".."+e.wrap(g(t,2),10);if(i.length===3){let r=D(g(t,3)),n=D(g(t,1));return r!==null&&n!==null?e.wrap(g(t,1),10)+","+e.wrap(n+r,10)+".."+e.wrap(g(t,2),10):e.wrap(g(t,1),10)+","+(e.wrap(g(t,3),he)+"+"+e.wrap(g(t,3),he))+".."+e.wrap(g(t,2),10)}return""}},{latexTrigger:[";"],kind:"infix",precedence:19,parse:(e,t,i)=>{let r=Zn(e,i,t,19,";");return r===null?null:["Delimiter",["Sequence",...r],"';'"]}},{name:"String",latexTrigger:["\\text"],parse:e=>ba(e),serialize:(e,t)=>{let i=I(t);return i===null||i.length===0?"\\text{}":w(["\\text{",i.map(r=>e.serialize(r)).join(""),"}"])}},{name:"Subscript",latexTrigger:["_"],kind:"infix",serialize:(e,t)=>ae(t)===2?e.serialize(g(t,1))+"_{"+e.serialize(g(t,2))+"}":"_{"+e.serialize(g(t,1))+"}"},{name:"Superplus",latexTrigger:["^","+"],kind:"postfix"},{name:"Subplus",latexTrigger:["_","+"],kind:"postfix"},{name:"Superminus",latexTrigger:["^","-"],kind:"postfix"},{name:"Subminus",latexTrigger:["_","-"],kind:"postfix"},{latexTrigger:["^","*"],kind:"postfix",parse:(e,t)=>["Superstar",t]},{latexTrigger:["_","*"],kind:"postfix",parse:(e,t)=>["Substar",t]},{name:"Substar",latexTrigger:["_","\\star"],kind:"postfix"},{name:"Superdagger",latexTrigger:["^","\\dagger"],kind:"postfix"},{latexTrigger:["^","\\dag"],kind:"postfix",parse:(e,t)=>["Superdagger",t]},{name:"Prime",latexTrigger:["^","\\prime"],kind:"postfix",parse:(e,t)=>vt(e,t,1),serialize:(e,t)=>{let i=D(g(t,2))??1,r=e.serialize(g(t,1));return i===1?r+"^\\prime":i===2?r+"^\\doubleprime":i===3?r+"^\\tripleprime":r+"^{("+e.serialize(g(t,2))+")}"}},{latexTrigger:"^{\\prime\\prime}",kind:"postfix",parse:(e,t)=>vt(e,t,2)},{latexTrigger:"^{\\prime\\prime\\prime}",kind:"postfix",parse:(e,t)=>vt(e,t,3)},{latexTrigger:["^","\\doubleprime"],kind:"postfix",parse:(e,t)=>vt(e,t,2)},{latexTrigger:["^","\\tripleprime"],kind:"postfix",parse:(e,t)=>vt(e,t,3)},{latexTrigger:"'",kind:"postfix",precedence:810,parse:(e,t)=>vt(e,t,1)},{latexTrigger:"\\prime",kind:"postfix",precedence:810,parse:(e,t)=>vt(e,t,1)},{latexTrigger:"\\doubleprime",kind:"postfix",precedence:810,parse:(e,t)=>vt(e,t,2)},{latexTrigger:"\\tripleprime",kind:"postfix",precedence:810,parse:(e,t)=>vt(e,t,3)},{latexTrigger:["^","<{>","("],kind:"postfix",parse:(e,t,i)=>{var a,s,o;if(!((o=(s=(a=e.computeEngine)==null?void 0:a.box(t))==null?void 0:s.domain)!=null&&o.isFunction))return null;let r=e.index;e.addBoundary([")"]);let n=e.parseExpression(i);return!e.matchBoundary()||!e.match("<}>")?(e.index=r,null):["Derivative",t,n]}},{name:"InverseFunction",latexTrigger:"^{-1",kind:"postfix",parse:(e,t)=>{var n,a,s;if(!((s=(a=(n=e.computeEngine)==null?void 0:n.box(t))==null?void 0:a.domain)!=null&&s.isFunction))return null;let i=0,r=e.index;for(;!e.atEnd&&!e.match("<}>");)if(e.match("'"))i++;else if(e.match("\\prime"))i++;else if(e.match("\\doubleprime"))i+=2;else if(e.match("\\tripleprime"))i+=3;else return e.index=r,null;return i===1?["Derivative",["InverseFunction",t]]:i>0?["Derivative",["InverseFunction",t],i]:["InverseFunction",t]},serialize:(e,t)=>e.serialize(g(t,1))+"^{-1}"},{name:"Derivative",serialize:(e,t)=>{let i=D(g(t,2))??1,r=e.serialize(g(t,1));return i===1?r+"^{\\prime}":i===2?r+"^{\\doubleprime}":i===3?r+"^{\\tripleprime}":r+"^{("+e.serialize(g(t,2))+")}"}},{kind:"environment",name:"Which",identifierTrigger:"cases",parse:Hn,serialize:(e,t)=>{let i=[],r=I(t);if(r)for(let n=0;n<=r.length-2;n+=2){let a=[];a.push(e.serialize(r[n+1])),a.push(e.serialize(r[n])),i.push(a.join("&"))}return w(["\\begin{cases}",i.join("\\\\"),"\\end{cases}"])}},{kind:"environment",identifierTrigger:"dcases",parse:Hn},{kind:"environment",identifierTrigger:"rcases",parse:Hn}];function ba(e,t){if(!e.match("<{>"))return"''";let i=[],r="",n=null;for(;!e.atEnd&&!e.match("<}>");)if(e.peek==="<{>")i.push(ba(e));else if(e.match("\\textbf")&&e.match("<{>"))i.push(ba(e,{"font-weight":"bold"}));else if(e.match("\\color")){let s=e.parseStringGroup();s!==null&&(n!==null&&r?i.push(["Style",r,{dict:n}]):r&&i.push(["String",r]),r="",n={color:s})}else if(e.match("<space>"))r+=" ";else if(e.match("<$>")){let s=e.index,o=e.parseExpression()??["Sequence"];e.skipSpace(),e.match("<$>")?i.push(o):(r+="$",e.index=s)}else if(e.match("<$$>")){let s=e.index,o=e.parseExpression()??["Sequence"];e.skipSpace(),e.match("<$$>")?i.push(o):(r+="$$",e.index=s)}else{let s=e.matchChar()??e.nextToken();r+={"\\enskip":"","\\enspace":"","\\quad":"","\\qquad":"","\\space":"","\\ ":"","\\;":"","\\,":"","\\:":"","\\!":"","\\{":"{","\\}":"}","\\$":"$","\\&":"&","\\#":"#","\\%":"%","\\_":"_","\\textbackslash":"\\","\\textasciitilde":"~","\\textasciicircum":"^","\\textless":"<","\\textgreater":">","\\textbar":"|","\\textunderscore":"_","\\textbraceleft":"{","\\textbraceright":"}","\\textasciigrave":"`","\\textquotesingle":"'","\\textquotedblleft":"","\\textquotedblright":"","\\textquotedbl":'"',"\\textquoteleft":"","\\textquoteright":"","\\textbullet":"","\\textdagger":"","\\textdaggerdbl":"","\\textsection":"","\\textparagraph":"","\\textperiodcentered":"","\\textellipsis":"","\\textemdash":"","\\textendash":"","\\textregistered":"","\\texttrademark":"","\\textdegree":""}[s]??s}n!==null&&r?i.push(["Style",`'${r}'`,{dict:n}]):r&&i.push(`'${r}'`);let a;return i.length===1?a=i[0]:i.every(s=>H(s)!==null)?a="'"+i.map(s=>H(s)).join()+"'":a=["String",...i],t?["Style",a,{dict:t}]:a}function zc(e,t){return t===null?"":w(da(t,i=>{let r=H(i);return r===null?e.serialize(i):r==="<{>"?"{":r==="<}>"?"}":r==="<$>"?"$":r==="<$$>"?"$$":r==="<space>"?" ":r}))}function Lc(e){return e===null?"":e.replace(/[{}\[\]\\:\-\$%]/g,t=>({"{":"\\lbrace ","}":"\\rbrace ","[":"\\lbrack ","]":"\\rbrack ",":":"\\colon ","\\":"\\backslash "})[t]??"\\"+t)}function Rc(e,t){let i=g(t,2);return i?x(i)==="LatexString"?H(g(i,1))??"":x(i)==="Hold"?e.serialize(g(i,1)):e.serialize(i):""}function vt(e,t,i){var n,a,s;let r=x(t);if(r==="Derivative"||r==="Prime"){let o=D(g(t,2))??1;return[r,G(g(t,1)),o+i]}return(s=(a=(n=e.computeEngine)==null?void 0:n.box(t))==null?void 0:a.domain)!=null&&s.isFunction?i===1?["Derivative",t]:["Derivative",t,i]:i===1?["Prime",G(t)]:["Prime",G(t),i]}function Bc(e,t){if(t===null||ye(t))return["Delimiter"];let i=x(t);if(i==="Delimiter"&&g(t,2)){let r=H(g(t,2));if((r==null?void 0:r.length)===1)return["Delimiter",g(t,1)??["Sequence"],{str:`(${r})`}]}return i==="Sequence"?ae(t)===0?["Delimiter"]:ae(t)===1?["Delimiter",g(t,1)]:["Delimiter",t]:i==="Matrix"&&(H(g(t,2))??"..")===".."?["Matrix",g(t,1)]:["Delimiter",t]}function Ro(e,t){if(t===null||ye(t))return["List"];let i=x(t);if(i==="Range"||i==="Linspace")return t;if(i==="Sequence")return["List",...I(t)??[]];if(i==="Delimiter"){let r=H(g(t,2))??"...";if(r===";"||r===".;.")return["List",...(I(g(t,1))??[]).map(n=>Ro(e,n))];if(r===","||r===".,.")return t=g(t,1),x(t)==="Sequence"?["List",...I(t)??[]]:["List",t??["Sequence"]]}return["List",t]}function Uc(e,t){let i=e.index;if(!t)return null;let r=null,n=null;if(x(t)==="Sequence"){if(ae(t)!==2)return null;if(r=g(t,1),n=g(t,2),n===null)return e.index=i,null}else r=g(t,1);if(r===null)return null;let a=e.parseExpression({minPrec:0});if(!a)return e.index=i,null;if(n){let s=D(n),o=D(r);return s!==null&&o!==null?["Range",r,a,s-o]:["Range",r,a,["Subtract",n,r]]}return["Range",r,a]}var an={"(":"(",")":")","[":"\\lbrack","]":"\\rbrack","":"\\llbrack","":"\\rrbrack","{":"\\lbrace","}":"\\rbrace","<":"\\langle",">":"\\rangle","":"\\Vert","\\":"\\backslash","":"\\lceil","":"\\rceil","":"\\lfloor","":"\\rfloor","":"\\ulcorner","":"\\urcorner","":"\\llcorner","":"\\lrcorner","":"\\lmoustache","":"\\rmoustache"};function Sr(e,t){let i=e.index;if(x(t)==="InvisibleOperator"&&ae(t)===2&&x(g(t,2))==="Delimiter"){let n=Q(g(t,1));if(!n)return null;let a=e.parseExpression({minPrec:0});if(a===null)return e.index=i,null;let s=g(g(t,2),1),o=[];return x(s)==="Sequence"?o=I(s)??[]:s&&(o=[s]),["Assign",n,["Function",a,...o??[]]]}if(typeof x(t)=="string"){let n=x(t),a=I(t)??[],s=e.parseExpression({minPrec:0});return s===null?(e.index=i,null):["Assign",n,["Function",s,...a]]}if(!Q(t))return null;let r=e.parseExpression({minPrec:0});return r===null?(e.index=i,null):["Assign",t,r]}function Hn(e){let t=e.parseTabular();if(!t)return["Which"];let i=["Which"];for(let r of t)if(r.length===1)i.push("True"),i.push(r[0]);else if(r.length===2){let n=H(r[1]);i.push(n?"True":Vo(r[1])??"True"),i.push(r[0])}return i}var Bo=[{latexTrigger:["\\not","<"],kind:"infix",associativity:"right",precedence:246,parse:"NotLess"},{name:"NotLess",latexTrigger:["\\nless"],kind:"infix",associativity:"right",precedence:246},{latexTrigger:["<"],kind:"infix",associativity:"right",precedence:245,parse:"Less"},{name:"Less",latexTrigger:["\\lt"],kind:"infix",associativity:"right",precedence:245},{latexTrigger:["<","="],kind:"infix",associativity:"right",precedence:241,parse:"LessEqual"},{name:"LessEqual",latexTrigger:["\\le"],kind:"infix",associativity:"right",precedence:241},{latexTrigger:["\\leq"],kind:"infix",associativity:"right",precedence:241,parse:"LessEqual"},{latexTrigger:["\\leqslant"],kind:"infix",associativity:"right",precedence:$+5,parse:"LessEqual"},{name:"LessNotEqual",latexTrigger:["\\lneqq"],kind:"infix",associativity:"right",precedence:$},{name:"NotLessNotEqual",latexTrigger:["\\nleqq"],kind:"infix",associativity:"right",precedence:$},{name:"LessOverEqual",latexTrigger:["\\leqq"],kind:"infix",associativity:"right",precedence:$+5},{name:"GreaterOverEqual",latexTrigger:["\\geqq"],kind:"infix",associativity:"right",precedence:$+5,parse:"GreaterEqual"},{name:"Equal",latexTrigger:["="],kind:"infix",associativity:"right",precedence:$},{latexTrigger:["*","="],kind:"infix",associativity:"right",precedence:$,parse:"StarEqual"},{name:"StarEqual",latexTrigger:["\\star","="],kind:"infix",associativity:"right",precedence:$},{name:"PlusEqual",latexTrigger:["+","="],kind:"infix",associativity:"right",precedence:$},{name:"MinusEqual",latexTrigger:["-","="],kind:"infix",associativity:"right",precedence:$},{name:"SlashEqual",latexTrigger:["/","="],kind:"infix",associativity:"right",precedence:$},{name:"EqualEqual",latexTrigger:["=","="],kind:"infix",associativity:"right",precedence:$},{name:"EqualEqualEqual",latexTrigger:["=","=","="],kind:"infix",associativity:"right",precedence:$+5},{name:"TildeFullEqual",latexTrigger:["\\cong"],kind:"infix",associativity:"right",precedence:$},{name:"NotTildeFullEqual",latexTrigger:["\\ncong"],kind:"infix",associativity:"right",precedence:$},{name:"Approx",latexTrigger:["\\approx"],kind:"infix",associativity:"right",precedence:247},{name:"NotApprox",latexTrigger:["\\not","\\approx"],kind:"infix",associativity:"right",precedence:247},{name:"ApproxEqual",latexTrigger:["\\approxeq"],kind:"infix",associativity:"right",precedence:$},{name:"NotApproxEqual",latexTrigger:["\\not","\\approxeq"],kind:"infix",associativity:"right",precedence:250},{name:"NotEqual",latexTrigger:["\\ne"],kind:"infix",associativity:"right",precedence:255},{name:"Unequal",latexTrigger:["!","="],kind:"infix",associativity:"right",precedence:$},{name:"GreaterEqual",latexTrigger:["\\ge"],kind:"infix",associativity:"right",precedence:242},{latexTrigger:["\\geq"],kind:"infix",associativity:"right",precedence:242,parse:"GreaterEqual"},{latexTrigger:[">","="],kind:"infix",associativity:"right",precedence:243,parse:"GreaterEqual"},{latexTrigger:["\\geqslant"],kind:"infix",associativity:"right",precedence:$+5,parse:"GreaterEqual"},{name:"GreaterNotEqual",latexTrigger:["\\gneqq"],kind:"infix",associativity:"right",precedence:$},{name:"NotGreaterNotEqual",latexTrigger:["\\ngeqq"],kind:"infix",associativity:"right",precedence:$},{latexTrigger:[">"],kind:"infix",associativity:"right",precedence:245,parse:"Greater"},{name:"Greater",latexTrigger:["\\gt"],kind:"infix",associativity:"right",precedence:245},{name:"NotGreater",latexTrigger:["\\ngtr"],kind:"infix",associativity:"right",precedence:244},{latexTrigger:["\\not",">"],kind:"infix",associativity:"right",precedence:244,parse:"NotGreater"},{name:"RingEqual",latexTrigger:["\\circeq"],kind:"infix",associativity:"right",precedence:$},{name:"TriangleEqual",latexTrigger:["\\triangleq"],kind:"infix",associativity:"right",precedence:$},{name:"DotEqual",latexTrigger:["\\doteq"],kind:"infix",associativity:"right",precedence:$+5},{name:"DotEqualDot",latexTrigger:["\\doteqdot"],kind:"infix",associativity:"right",precedence:$+5},{name:"FallingDotEqual",latexTrigger:["\\fallingdotseq"],kind:"infix",associativity:"right",precedence:$+5},{name:"RisingDotEqual",latexTrigger:["\\fallingdotseq"],kind:"infix",associativity:"right",precedence:$+5},{name:"QuestionEqual",latexTrigger:["\\questeq"],kind:"infix",associativity:"right",precedence:$},{name:"MuchLess",latexTrigger:["\\ll"],kind:"infix",associativity:"right",precedence:$},{name:"MuchGreater",latexTrigger:["\\gg"],kind:"infix",associativity:"right",precedence:$},{name:"Precedes",latexTrigger:["\\prec"],kind:"infix",associativity:"right",precedence:$},{name:"Succeeds",latexTrigger:["\\succ"],kind:"infix",associativity:"right",precedence:$},{name:"PrecedesEqual",latexTrigger:["\\preccurlyeq"],kind:"infix",associativity:"right",precedence:$},{name:"SucceedsEqual",latexTrigger:["\\curlyeqprec"],kind:"infix",associativity:"right",precedence:$},{name:"NotPrecedes",latexTrigger:["\\nprec"],kind:"infix",associativity:"right",precedence:$},{name:"NotSucceeds",latexTrigger:["\\nsucc"],kind:"infix",associativity:"right",precedence:$},{name:"Between",latexTrigger:["\\between"],kind:"infix",associativity:"right",precedence:$+5}];function dr(e){return typeof e!="string"?!1:Bo.some(t=>t.name===e)}var jc=[{name:"Matrix",serialize:(e,t)=>{let i=I(g(t,1))??[];return ks(e,i,H(g(t,2)),H(g(t,3)))}},{name:"Vector",serialize:(e,t)=>{let i=I(t)??[];return ks(e,i.map(r=>["List",r]),H(g(t,2)),H(g(t,3)))}},{kind:"environment",identifierTrigger:"pmatrix",parse:e=>{let t=yt(e),[i,r]=xt(e);return t?[i,r,{str:"()"},{str:t}]:[i,r]}},{kind:"environment",identifierTrigger:"bmatrix",parse:e=>{let t=yt(e),[i,r]=xt(e);return t?[i,r,{str:"[]"},{str:t}]:[i,r,{str:"[]"}]}},{kind:"environment",identifierTrigger:"Bmatrix",parse:e=>{let t=yt(e),[i,r]=xt(e);return t?[i,r,{str:"{}"},{str:t}]:[i,r,{str:"{}"}]}},{kind:"environment",identifierTrigger:"vmatrix",parse:e=>{let t=yt(e),[i,r]=xt(e);return t?[i,r,{str:"||"},{str:t}]:[i,r,{str:"||"}]}},{kind:"environment",identifierTrigger:"Vmatrix",parse:e=>{let t=yt(e),[i,r]=xt(e);return t?[i,r,{str:""},{str:t}]:[i,r,{str:""}]}},{kind:"environment",identifierTrigger:"smallmatrix",parse:e=>{let t=yt(e),[i,r]=xt(e);return t?[i,r,{str:"()"},{str:t}]:[i,r]}},{kind:"environment",identifierTrigger:"array",parse:e=>{let t=yt(e,!1),[i,r]=xt(e);return t?[i,r,{str:".."},{str:t}]:[i,r,{str:".."}]}},{kind:"environment",identifierTrigger:"matrix",parse:e=>{let t=yt(e),[i,r]=xt(e);return t?[i,r,{str:".."},{str:t}]:[i,r,{str:".."}]}},{kind:"environment",identifierTrigger:"matrix*",parse:e=>{let t=yt(e),[i,r]=xt(e);return t?[i,r,{str:".."},{str:t}]:[i,r,{str:".."}]}},{name:"ConjugateTranspose",kind:"postfix",latexTrigger:["^","\\star"]},{kind:"postfix",latexTrigger:["^","\\H"],parse:"ConjugateTranspose"},{kind:"postfix",latexTrigger:["^","\\dagger"],parse:(e,t)=>["ConjugateTranspose",t]},{kind:"postfix",latexTrigger:["^","\\ast"],parse:(e,t)=>["ConjugateTranspose",t]},{kind:"postfix",latexTrigger:["^","\\top"],parse:(e,t)=>["Transpose",t]},{kind:"postfix",latexTrigger:["^","\\intercal"],parse:(e,t)=>["Transpose",t]},{name:"Transpose",kind:"postfix",latexTrigger:["^","T"]},{name:"PseudoInverse",kind:"postfix",latexTrigger:["^","+"]},{name:"Trace",kind:"function",identifierTrigger:"tr"},{name:"Determinant",kind:"function",identifierTrigger:"det"}];function xt(e){let t=e.parseTabular();return t?["Matrix",["List",...t.map(i=>["List",...i])]]:["",null]}function yt(e,t=!0){var n;let i=(n=e.parseStringGroup(t))==null?void 0:n.trim();if(!i)return"";let r="";for(let a of i)a==="c"&&(r+="="),a==="l"&&(r+="<"),a==="r"&&(r+=">"),a==="|"&&(r+="|"),a===":"&&(r+=":");return r}function ks(e,t,i,r){i??(i="()");let[n,a]=["",""];typeof i=="string"&&i.length===2&&([n,a]=i);let s="";if(r)for(let f of r)f==="<"?s+="l":f===">"?s+="r":f==="="?s+="c":f==="|"?s+="|":f===":"&&(s+=":");let o=[];for(let f of t??[]){let c=[];for(let h of I(f)??[])c.push(e.serialize(h));o.push(c.join(" & "))}let l=o.join(`\\\\
`),u=s.length>0?`[${s}]`:"";return w(n==="("&&a===")"?["\\begin{pmatrix}",u,l,"\\end{pmatrix}"]:n==="["&&a==="]"?["\\begin{bmatrix}",u,l,"\\end{bmatrix}"]:n==="{"&&a==="}"?["\\begin{Bmatrix}",u,l,"\\end{Bmatrix}"]:n==="|"&&a==="|"?["\\begin{vmatrix}",u,l,"\\end{vmatrix}"]:n===""&&a===""?["\\begin{Vmatrix}",u,l,"\\end{Vmatrix}"]:n==="{"&&a==="."?["\\begin{dcases}",u,l,"\\end{dcases}"]:n==="."&&a==="}"?["\\begin{rcases}",u,l,"\\end{rcases}"]:s||n!=="."||a!=="."?["\\left",an[n]??n,"\\begin{array}",`{${s}}`,l,"\\end{array}","\\right",an[a]??a]:["\\begin{matrix}",l,"\\end{matrix}"])}var Gc=[{name:"True",kind:"symbol",latexTrigger:["\\top"]},{kind:"symbol",latexTrigger:"\\mathrm{True}",parse:"True"},{kind:"symbol",latexTrigger:"\\operator{True}",parse:"True"},{kind:"symbol",latexTrigger:"\\mathsf{T}",parse:"True"},{name:"False",kind:"symbol",latexTrigger:["\\bot"]},{kind:"symbol",latexTrigger:"\\operator{False}",parse:"False"},{kind:"symbol",latexTrigger:"\\mathsf{F}",parse:"False"},{name:"And",kind:"infix",latexTrigger:["\\land"],precedence:317},{kind:"infix",latexTrigger:["\\wedge"],parse:"And",precedence:317},{kind:"infix",latexTrigger:"\\&",parse:"And",precedence:317},{kind:"infix",latexTrigger:"\\operatorname{and}",parse:"And",precedence:317},{name:"Or",kind:"infix",latexTrigger:["\\lor"],precedence:310},{kind:"infix",latexTrigger:["\\vee"],parse:"Or",precedence:310},{kind:"infix",latexTrigger:"\\parallel",parse:"Or",precedence:310},{kind:"infix",latexTrigger:"\\operatorname{or}",parse:"Or",precedence:310},{name:"Xor",kind:"infix",latexTrigger:["\\veebar"],precedence:315},{name:"Not",kind:"prefix",latexTrigger:["\\lnot"],precedence:880},{kind:"prefix",latexTrigger:["\\neg"],parse:"Not",precedence:880},{name:"Nand",kind:"infix",latexTrigger:["\\barwedge"],precedence:315},{name:"Nor",kind:"infix",latexTrigger:[""],precedence:315},{kind:"function",identifierTrigger:"and",parse:"And"},{kind:"function",identifierTrigger:"or",parse:"Or"},{kind:"function",identifierTrigger:"not",parse:"Not"},{name:"Implies",kind:"infix",precedence:220,associativity:"right",latexTrigger:["\\implies"],serialize:"\\implies"},{latexTrigger:["\\Rightarrow"],kind:"infix",precedence:220,associativity:"right",parse:"Implies"},{name:"Equivalent",latexTrigger:["\\iff"],kind:"infix",associativity:"right",precedence:219},{latexTrigger:["\\Leftrightarrow"],kind:"infix",associativity:"right",precedence:219,parse:"Equivalent"},{latexTrigger:["\\equiv"],kind:"infix",associativity:"right",precedence:219,parse:(e,t,i)=>{let r=e.parseExpression({...i,minPrec:219}),n=e.index,a=e.parseExpression({...i,minPrec:219});return a&&x(a)==="Mod"?["Congruent",t,r,G(g(a,1))]:(e.index=n,["Equivalent",t,G(r)])}},{name:"Proves",kind:"infix",latexTrigger:["\\vdash"],precedence:220,associativity:"right",serialize:"\\vdash"},{name:"Entails",kind:"infix",latexTrigger:["\\vDash"],precedence:220,associativity:"right",serialize:"\\vDash"},{name:"Satisfies",kind:"infix",latexTrigger:["\\models"],precedence:220,associativity:"right",serialize:"\\models"},{name:"ForAll",kind:"prefix",latexTrigger:["\\forall"],precedence:200,serialize:"\\forall",parse:wr("ForAll")},{name:"Exists",kind:"prefix",latexTrigger:["\\exists"],precedence:200,serialize:"\\exists",parse:wr("Exists")},{name:"ForAllUnique",kind:"prefix",latexTrigger:["\\forall","!"],precedence:200,serialize:"\\forall!",parse:wr("ForAllUnique")},{name:"ExistsUnique",kind:"prefix",latexTrigger:["\\exists","!"],precedence:200,serialize:"\\exists!",parse:wr("ExistsUnique")}];function wr(e){return(t,i)=>{let r=t.index,n=t.parseSymbol(i);if(n){if(t.skipSpace(),t.match(",")||t.match("\\mid")){let s=t.parseExpression(i);return[e,n,G(s)]}if(t.match("(")){let s=t.parseExpression(i);return t.match(")")?[e,n,G(s)]:(t.index=r,null)}}t.index=r;let a=t.parseExpression(i);if(!a)return t.index=r,null;if(t.skipSpace(),t.matchAny([",","\\mid",":","\\colon"])){let s=t.parseExpression(i);return[e,a,G(s)]}if(t.match("(")){let s=t.parseExpression(i);return t.match(")")?[e,a,G(s)]:(t.index=r,null)}return t.index=r,null}}function Be(e){return t=>{let i=t.parseGroup();return i===null?[e]:[e,i]}}var Zc=[{name:"Overscript",latexTrigger:["\\overset"],kind:"infix",precedence:700},{name:"Underscript",latexTrigger:["\\underset"],kind:"infix",precedence:700},{name:"Increment",latexTrigger:["+","+"],kind:"postfix",precedence:880},{name:"Decrement",latexTrigger:["-","-"],kind:"postfix",precedence:880},{name:"PreIncrement",latexTrigger:["+","+"],kind:"prefix",precedence:880},{name:"PreDecrement",latexTrigger:["-","-"],kind:"prefix",precedence:880},{name:"Ring",latexTrigger:["\\circ"],kind:"infix",precedence:265},{name:"StringJoin",latexTrigger:["\\lt","\\gt"],kind:"infix",precedence:780},{name:"Starstar",latexTrigger:["\\star","\\star"],kind:"infix",precedence:780},{name:"PartialDerivative",latexTrigger:["\\partial"],kind:"prefix",parse:e=>{let t=!1,i="Nothing",r="Nothing";for(;!t;)e.skipSpace(),e.match("_")?r=e.parseGroup()??e.parseToken():e.match("^")?i=e.parseGroup()??e.parseToken():t=!0;let n=zo(r);if(n&&(r=["List",...n]),r===null||i===null)return null;let a=e.parseGroup()??"Nothing";if(a!=="Nothing"&&!ye(a)){let s=e.parseArguments()??["Nothing"];a=[a,...s]}return["PartialDerivative",a,r,i]},serialize:(e,t)=>{let i="\\partial",r=g(t,1),n=g(t,2),a=g(t,3);return n!==null&&n!=="Nothing"&&(x(n)==="List"?i+="_{"+e.serialize(["Sequence",...I(n)??[]])+"}":i+="_{"+e.serialize(n)+"}"),a!==null&&a!=="Nothing"&&(i+="^{"+e.serialize(a)+"}"),r!==null&&r!=="Nothing"&&(i+=e.serialize(r)),i},precedence:740},{name:"OverBar",latexTrigger:["\\overline"],parse:Be("OverBar")},{name:"UnderBar",latexTrigger:["\\underline"],parse:Be("UnderBar")},{name:"OverVector",latexTrigger:["\\vec"],parse:Be("OverVector")},{name:"OverTilde",latexTrigger:["\\tilde"],parse:Be("OverTilde")},{name:"OverHat",latexTrigger:["\\hat"],parse:Be("OverHat")},{name:"OverRightArrow",latexTrigger:["\\overrightarrow"],parse:Be("OverRightArrow")},{name:"OverLeftArrow",latexTrigger:["\\overleftarrow"],parse:Be("OverLeftArrow")},{name:"OverRightDoubleArrow",latexTrigger:["\\Overrightarrow"],parse:Be("OverRightDoubleArrow")},{name:"OverLeftHarpoon",latexTrigger:["\\overleftharpoon"],parse:Be("OverLeftHarpoon")},{name:"OverRightHarpoon",latexTrigger:["\\overrightharpoon"],parse:Be("OverRightHarpoon")},{name:"OverLeftRightArrow",latexTrigger:["\\overleftrightarrow"],parse:Be("OverLeftRightArrow")},{name:"OverBrace",latexTrigger:["\\overbrace"],parse:Be("OverBrace")},{name:"OverLineSegment",latexTrigger:["\\overlinesegment"],parse:Be("OverLineSegment")},{name:"OverGroup",latexTrigger:["\\overgroup"],parse:Be("OverGroup")},{latexTrigger:["\\displaystyle"],parse:()=>["Sequence"]},{latexTrigger:["\\textstyle"],parse:()=>["Sequence"]},{latexTrigger:["\\scriptstyle"],parse:()=>["Sequence"]},{latexTrigger:["\\scriptscriptstyle"],parse:()=>["Sequence"]},{latexTrigger:["\\tiny"],parse:()=>["Sequence"]},{latexTrigger:["\\scriptsize"],parse:()=>["Sequence"]},{latexTrigger:["\\footnotesize"],parse:()=>["Sequence"]},{latexTrigger:["\\small"],parse:()=>["Sequence"]},{latexTrigger:["\\normalsize"],parse:()=>["Sequence"]},{latexTrigger:["\\large"],parse:()=>["Sequence"]},{latexTrigger:["\\Large"],parse:()=>["Sequence"]},{latexTrigger:["\\LARGE"],parse:()=>["Sequence"]},{latexTrigger:["\\huge"],parse:()=>["Sequence"]},{latexTrigger:["\\Huge"],parse:()=>["Sequence"]},{name:"Style",serialize:(e,t)=>{let i=e.serialize(g(t,1)),r=En(g(t,2));if(r===null)return i;H(r.display)==="block"?i=w(["{\\displaystyle",i,"}"]):H(r.display)==="inline"?i=w(["{\\textstyle",i,"}"]):H(r.display)==="script"?i=w(["{\\scriptstyle",i,"}"]):H(r.display)==="scriptscript"&&(i=w(["{\\scriptscriptstyle",i,"}"]));let n=D(r.size);return n!==null&&n>=1&&n<=10&&(i=w(["{",{1:"\\tiny",2:"\\scriptsize",3:"\\footnotesize",4:"\\small",5:"\\normalsize",6:"\\large",7:"\\Large",8:"\\LARGE",9:"\\huge",10:"\\Huge"}[n],i,"}"])),i}},{latexTrigger:["\\!"],parse:()=>["HorizontalSpacing",-3]},{latexTrigger:["\\ "],parse:()=>["HorizontalSpacing",6]},{latexTrigger:["\\:"],parse:()=>["HorizontalSpacing",4]},{latexTrigger:["\\enskip"],parse:()=>["HorizontalSpacing",9]},{latexTrigger:["\\quad"],parse:()=>["HorizontalSpacing",18]},{latexTrigger:["\\qquad"],parse:()=>["HorizontalSpacing",36]},{latexTrigger:["\\,"],parse:()=>["HorizontalSpacing",3]},{latexTrigger:["\\;"],parse:()=>["HorizontalSpacing",5]},{latexTrigger:["\\enspace"],parse:()=>["HorizontalSpacing",9]},{name:"HorizontalSpacing",serialize:(e,t)=>{if(g(t,2))return e.serialize(g(t,1));let i=D(g(t,1));return i===null?"":{"-3":"\\!",6:"\\ ",3:"\\,",4:"\\:",5:"\\;",9:"\\enspace",18:"\\quad",36:"\\qquad"}[i]??""}}];function B(e){return(t,i)=>{let r={"\\arcsin":"Arcsin","\\arccos":"Arccos","\\arctan":"Arctan","\\arctg":"Arctan","\\arcctg":"Arctan","\\arcsec":"Arcsec","\\arccsc":" Arccsc","\\arsinh":"Arsinh","\\arcosh":"Arcosh","\\artanh":"Artanh","\\arcsech":"Arcsech","\\arccsch":"Arcsch","\\ch":"Cosh","\\cos":"Cos","\\cosec":"Csc","\\cosh":"Csch","\\cot":"Cot","\\cotg":"Cot","\\coth":"Coth","\\csc":"Csc","\\ctg":"Cot","\\cth":"Coth","\\sec":"Sec","\\sin":"Sin","\\sinh":"Sinh","\\sh":"Sinh","\\tan":"Tan","\\tanh":"Tanh","\\tg":"Tan","\\th":"Tanh"}[e??""]??e??"";if(t.atTerminator(i))return r;let n=r;do{let l=t.parsePostfixOperator(n,i);if(l===null)break;n=l}while(!0);let a=null;t.match("^")&&(a=t.parseGroup()??t.parseToken());let s=t.parseArguments("implicit",i),o=s===null?n:typeof n=="string"?[n,...s]:["Apply",n,...s];return a===null?o:["Power",o,a]}}var Hc=[{name:"Arcsin",latexTrigger:["\\arcsin"],parse:B("Arcsin")},{name:"Arccos",latexTrigger:["\\arccos"],parse:B("Arccos")},{name:"Arctan",latexTrigger:["\\arctan"],parse:B("Arctan")},{latexTrigger:["\\arctg"],parse:B("Arctan")},{name:"Arccot",latexTrigger:["\\arcctg"],parse:B("Arccot")},{name:"Arcsec",latexTrigger:"arcsec",parse:B("Arcsec")},{name:"Arccsc",latexTrigger:["\\arccsc"],parse:B("Arccsc")},{name:"Arsinh",latexTrigger:["\\arsinh"],parse:B("Arsinh")},{name:"Arcosh",latexTrigger:["\\arcosh"],parse:B("Arcosh")},{name:"Artanh",latexTrigger:["\\artanh"],parse:B("Artanh")},{name:"Arsech",latexTrigger:["\\arsech"],parse:B("Arsech")},{name:"Arcsch",latexTrigger:["\\arcsch"],parse:B("Arcsch")},{latexTrigger:["\\ch"],parse:B("Cosh")},{name:"Cosec",latexTrigger:["\\cosec"],parse:B("Cosec")},{name:"Cosh",latexTrigger:["\\cosh"],parse:B("Cosh")},{name:"Cot",latexTrigger:["\\cot"],parse:B("Cot")},{latexTrigger:["\\cotg"],parse:B("Cot")},{name:"Coth",latexTrigger:["\\coth"],parse:B("Coth")},{name:"Csc",latexTrigger:["\\csc"],parse:B("Csc")},{latexTrigger:["\\ctg"],parse:B("Cot")},{latexTrigger:["\\cth"],parse:B("Cotanh")},{name:"Sec",latexTrigger:["\\sec"],parse:B("Sec")},{name:"Sinh",latexTrigger:["\\sinh"],parse:B("Sinh")},{latexTrigger:["\\sh"],parse:B("Sinh")},{name:"Tan",latexTrigger:["\\tan"],parse:B("Tan")},{latexTrigger:["\\tg"],parse:B("Tan")},{name:"Tanh",latexTrigger:["\\tanh"],parse:B("Tanh")},{latexTrigger:["\\th"],parse:B("Tanh")},{name:"Cos",latexTrigger:["\\cos"],parse:B("Cos")},{name:"Sin",latexTrigger:["\\sin"],parse:B("Sin")}],Wc=[{name:"AlgebraicNumbers",latexTrigger:"\\bar\\Q"},{name:"ComplexNumbers",latexTrigger:["\\C"]},{latexTrigger:"\\mathbb{C}",parse:"ComplexNumbers"},{name:"ImaginaryNumbers",latexTrigger:["\\imaginaryI","\\R"]},{name:"ExtendedComplexNumbers",latexTrigger:["\\bar","\\C"]},{name:"EmptySet",latexTrigger:["\\emptyset"]},{latexTrigger:["\\varnothing"],parse:"EmptySet"},{name:"Integers",latexTrigger:["\\Z"]},{latexTrigger:"\\mathbb{Z}",parse:"Integers"},{name:"RationalNumbers",latexTrigger:["\\Q"]},{name:"RealNumbers",latexTrigger:["\\R"]},{latexTrigger:"\\mathbb{R}",parse:"RealNumbers"},{name:"ExtendedRealNumbers",latexTrigger:["\\bar","\\R"]},{name:"TranscendentalNumberss",latexTrigger:"\\R-\\bar\\Q"},{latexTrigger:"\\R\\backslash\\bar\\Q",parse:"TranscendentalNumbers"},{name:"NegativeNumbers",latexTrigger:"\\R^-"},{latexTrigger:"\\R^{-}",parse:"NegativeNumbers"},{latexTrigger:"\\R_-",parse:"NegativeNumbers"},{latexTrigger:"\\R_{-}",parse:"NegativeNumbers"},{latexTrigger:"\\R^{\\lt}",parse:"NegativeNumbers"},{name:"PositiveNumbers",latexTrigger:"\\R^+"},{latexTrigger:"\\R^{+}",parse:"PositiveNumbers"},{latexTrigger:"\\R_+",parse:"PositiveNumbers"},{latexTrigger:"\\R_{+}",parse:"PositiveNumbers"},{latexTrigger:"\\R^{\\gt}",parse:"PositiveNumbers"},{name:"NonPositiveNumbers",latexTrigger:"\\R^{0-}"},{latexTrigger:"\\R^{-0}",parse:"NonPositiveNumbers"},{latexTrigger:"\\R^{\\leq}",parse:"NonPositiveNumbers"},{name:"NegativeIntegers",latexTrigger:"\\Z^-"},{latexTrigger:"\\Z^-",parse:"NegativeIntegers"},{latexTrigger:"\\Z^{-}",parse:"NegativeIntegers"},{latexTrigger:"\\Z_-",parse:"NegativeIntegers"},{latexTrigger:"\\Z_{-}",parse:"NegativeIntegers"},{latexTrigger:"\\Z^{\\lt}",parse:"NegativeIntegers"},{name:"PositiveIntegers",latexTrigger:"\\Z^+"},{latexTrigger:"\\Z^{+}",parse:"PositiveIntegers"},{latexTrigger:"\\Z_+",parse:"PositiveIntegers"},{latexTrigger:"\\Z_{+}",parse:"PositiveIntegers"},{latexTrigger:"\\Z^{\\gt}",parse:"PositiveIntegers"},{latexTrigger:"\\Z^{\\gt0}",parse:"PositiveIntegers"},{latexTrigger:"\\N^+",parse:"PositiveIntegers"},{latexTrigger:"\\N^{+}",parse:"PositiveIntegers"},{latexTrigger:"\\N^*",parse:"PositiveIntegers"},{latexTrigger:"\\N^{*}",parse:"PositiveIntegers"},{latexTrigger:"\\N^\\star",parse:"PositiveIntegers"},{latexTrigger:"\\N^{\\star}",parse:"PositiveIntegers"},{latexTrigger:"\\N_1",parse:"PositiveIntegers"},{latexTrigger:"\\N_{1}",parse:"PositiveIntegers"},{name:"NonNegativeIntegers",latexTrigger:["\\N"]},{latexTrigger:"\\Z^{+0}",parse:"NonNegativeIntegers"},{latexTrigger:"\\Z^{\\geq}",parse:"NonNegativeIntegers"},{latexTrigger:"\\Z^{\\geq0}",parse:"NonNegativeIntegers"},{latexTrigger:"\\Z^{0+}",parse:"NonNegativeIntegers"},{latexTrigger:"\\mathbb{N}",parse:"NonNegativeIntegers"},{latexTrigger:"\\N_0",parse:"NonNegativeIntegers"},{latexTrigger:"\\N_{0}",parse:"NonNegativeIntegers"},{name:"CartesianProduct",latexTrigger:["\\times"],kind:"infix",associativity:"right",precedence:390,parse:(e,t,i)=>{var s,o;if(390<i.minPrec)return null;let r=e.computeEngine;if(!r||!((s=r.box(t).domain)!=null&&s.isCompatible("Sets")))return null;let n=e.index,a=e.parseExpression({...i,minPrec:390});return a===null||((o=r.box(t).domain)==null?void 0:o.isCompatible("Sets"))!==!0?(e.index=n,null):["CartesianProduct",t,a]}},{latexTrigger:["^","\\complement"],kind:"postfix",parse:(e,t)=>["Complement",t]},{name:"Complement",latexTrigger:["^","<{>","\\complement","<}>"],kind:"postfix"},{name:"Intersection",latexTrigger:["\\cap"],kind:"infix",precedence:350},{name:"Interval",serialize:Ts},{name:"Multiple",serialize:Ts},{name:"Union",latexTrigger:["\\cup"],kind:"infix",precedence:350},{name:"Set",kind:"matchfix",openTrigger:"{",closeTrigger:"}",parse:(e,t)=>t===null||ye(t)?"EmptySet":(x(t)=="Delimiter"&&H(g(t,2))===","&&(t=g(t,1)),x(t)!=="Sequence"?["Set",t]:["Set",...I(t)??[]]),serialize:(e,t)=>w(["\\lbrace",(I(t)??[]).map(i=>e.serialize(i)).join(", "),"\\rbrace"])},{name:"SetMinus",latexTrigger:["\\setminus"],kind:"infix",precedence:650},{name:"SymmetricDifference",latexTrigger:["\\triangle"],kind:"infix",precedence:$},{latexTrigger:["\\ni"],kind:"infix",associativity:"right",precedence:160,parse:(e,t,i)=>{let r=e.parseExpression(i);return r===null?null:["Element",r,t]}},{name:"Element",latexTrigger:["\\in"],kind:"infix",precedence:240},{name:"NotElement",latexTrigger:["\\notin"],kind:"infix",precedence:240},{name:"NotSubset",latexTrigger:["\\nsubset"],kind:"infix",associativity:"right",precedence:240},{name:"NotSuperset",latexTrigger:["\\nsupset"],kind:"infix",associativity:"right",precedence:240},{name:"NotSubsetNotEqual",latexTrigger:["\\nsubseteq"],kind:"infix",associativity:"right",precedence:240},{name:"NotSupersetNotEqual",latexTrigger:["\\nsupseteq"],kind:"infix",associativity:"right",precedence:240},{name:"SquareSubset",latexTrigger:["\\sqsubset"],kind:"infix",associativity:"right",precedence:265},{name:"SquareSubsetEqual",latexTrigger:["\\sqsubseteq"],kind:"infix",associativity:"right",precedence:265},{name:"SquareSuperset",latexTrigger:["\\sqsupset"],kind:"infix",associativity:"right",precedence:265},{name:"SquareSupersetEqual",latexTrigger:["\\sqsupseteq"],kind:"infix",associativity:"right",precedence:265},{name:"Subset",latexTrigger:["\\subset"],kind:"infix",associativity:"right",precedence:240},{latexTrigger:["\\subsetneq"],kind:"infix",associativity:"right",precedence:240,parse:"Subset"},{latexTrigger:["\\varsubsetneqq"],kind:"infix",associativity:"right",precedence:240,parse:"Subset"},{name:"SubsetEqual",latexTrigger:["\\subseteq"],kind:"infix",precedence:240},{name:"Superset",latexTrigger:["\\supset"],kind:"infix",associativity:"right",precedence:240},{latexTrigger:["\\supsetneq"],kind:"infix",associativity:"right",precedence:240,parse:"Superset"},{latexTrigger:["\\varsupsetneq"],kind:"infix",associativity:"right",precedence:240,parse:"Superset"},{name:"SupersetEqual",latexTrigger:["\\supseteq"],kind:"infix",associativity:"right",precedence:240}];function Ts(e,t){if(t===null)return"";let i=x(t);if(i===null)return"";if(i==="Set")return ae(t)===0?"\\emptyset":ae(t)===2&&x(g(t,2))==="Condition"?w(["\\left\\lbrace",e.serialize(g(t,1)),"\\middle\\mid",e.serialize(g(t,2)),"\\right\\rbrace"]):w(["\\left\\lbrace",...(I(t)??[]).map(r=>e.serialize(r)+" ,"),"\\right\\rbrace"]);if(i==="Range")return w(["\\mathopen\\lbrack",e.serialize(g(t,1)),", ",e.serialize(g(t,2)),"\\mathclose\\rbrack"]);if(i==="Interval"){let r=g(t,1),n=g(t,2),a=!1,s=!1;return x(r)==="Open"&&(r=g(r,1),a=!0),x(n)==="Open"&&(n=g(n,1),s=!0),w([`\\mathopen${a?"\\rbrack":"\\lbrack"}`,e.serialize(r),", ",e.serialize(n),`\\mathclose${s?"\\lbrack":"\\rbrack"}`])}return e.numericSetStyle(t,e.level),""}function xi(e,t=1){return i=>{i.skipSpace();let r=null,n=null;for(;!(n!==null&&r!==null)&&(i.peek==="_"||i.peek==="^");)i.match("_")?n=i.parseGroup()??i.parseToken():i.match("^")&&(r=i.parseGroup()??i.parseToken()),i.skipSpace();(n==="Nothing"||ye(n))&&(n=null),(r==="Nothing"||ye(r))&&(r=null);let[a,s]=Jc(i,t);if(a&&!s){if(x(a)==="Add"||x(a)==="Subtract"){let o=[],l=[];for(let u of I(a)??[])if(s)l.push(u);else{let f;[f,s]=ft(u),o.push(f??u)}if(s!==null&&l.length>0)return["Add",Es(i,e,["Add",...o],[{index:s,sub:n,sup:r}]),...l]}else if(x(a)==="Divide"){let o;[o,s]=ft(g(a,1)),o!==null&&s!==null&&(a=["Divide",o,g(a,2)])}}return Es(i,e,a,[{index:s,sub:n,sup:r}])}}function Es(e,t,i,r){if(i&&r.length===0)return[t,i];if(i??(i="Nothing"),e.computeEngine){let n=e.computeEngine,a=!1,s={};for(let o of r)o.index&&(a=!0,s[o.index]={domain:"ExtendedRealNumbers"});a&&n.pushScope().declare(s),i=n.box(i).json,a&&n.popScope()}return[t,i,...r.map(n=>Qc(n))]}function Qc(e){let t=e.index?["Hold",e.index]:"Nothing";return e.sup!==null?["Tuple",t,e.sub??"Nothing",e.sup]:e.sub!==null?["Tuple",t,e.sub]:t}function Jc(e,t=1){let i=e.index,r=!1,n=e.parseExpression({minPrec:266,condition:()=>((e.matchAll(["\\mathrm","<{>","d","<}>"])||e.matchAll(["\\operatorname","<{>","d","<}>"]))&&(r=!0),r)});if(r||(e.index=i,n=e.parseExpression({minPrec:266,condition:()=>(e.match("d")&&(r=!0),r)})),n&&!r)return ft(n);let a=Kc(e,t);return[n,a[0]??null]}function Kc(e,t=1){e.skipSpace();let i=[],r=Q(e.parseSymbol());return r===null?[]:(i.push(r),i)}function ft(e){let t=x(e),i=g(e,1);if(!i)return[e,null];if(t==="Sequence"&&ae(e)===1)return ft(i);if(t==="Multiply"||t==="InvisibleOperator"){let r=I(e);if(r&&r.length>1){let n=Q(r[r.length-2]);if(n==="d"||n==="d_upright")return r.length===2?[null,Q(r[1])]:r.length===3?[r[0],Q(r[2])]:[["Multiply",...r.slice(0,-2)],Q(r[r.length-1])];let[a,s]=ft(r[r.length-1]);if(a)return[["Multiply",...r.slice(0,-1),a],s]}}else if(t==="Delimiter"){let[r,n]=ft(i);if(n)return r?[["Delimiter",["Sequence",r],...I(e).slice(1)],n]:[null,n]}else if(t==="Add"){let r=I(e);if(r&&r.length>0){let[n,a]=ft(r[r.length-1]);if(a){if(n)return[["Add",...r.slice(0,-1),n],a];if(r.length>2)return[["Add",...r.slice(0,-1)],a];if(r.length>2)return[r[0],a]}}}else if(t==="Negate"){let[r,n]=ft(i);if(n)return[r?["Negate",r]:null,n]}else if(t==="Divide"){let[r,n]=ft(i);if(n)return[["Divide",r??1,g(e,2)],n]}else{let r=I(e);if((r==null?void 0:r.length)===1){let[n,a]=ft(r[0]);if(a)return[[x(e),n],a]}}return[e,null]}function As(e){return(t,i)=>{if(!g(i,1))return e;let r=g(i,2),n=x(r),a=null;n==="Tuple"||n==="Triple"||n==="Pair"||n==="Single"||n==="Hold"?a=g(r,1):(a=g(r,1)??"x",r=null),x(a)==="Hold"&&(a=g(a,1));let s=a!==null?Q(a):null,o=g(i,1);if(x(o)==="Lambda"&&g(o,1)&&(o=Pr(g(o,1),{_:s??"x",_1:s??"x"})),!r)return w(!s||s==="Nothing"?[e,"\\!",t.serialize(o)]:[e,"\\!",t.serialize(o),"\\,\\operatorname{d}",t.serialize(s)]);let l=g(r,2)?Q(g(r,2)):null,u=r&&l!=="Nothing"?t.serialize(g(r,2)):"";u.length>0&&(u=`_{${u}}`);let f="",c=g(r,3)?Q(g(r,3)):null;return g(r,3)&&c!=="Nothing"&&(f=`^{${t.serialize(g(r,3))}}`),w([e,f,u,"\\!",t.serialize(o),...s&&Q(s)!=="Nothing"?["\\,\\operatorname{d}",t.serialize(s)]:[]])}}var Yc=[{kind:"expression",name:"Integrate",latexTrigger:["\\int"],parse:xi("Integrate"),serialize:As("\\int")},{kind:"expression",latexTrigger:["\\iint"],parse:xi("Integrate",2)},{kind:"expression",latexTrigger:["\\iiint"],parse:xi("Integrate",3)},{kind:"expression",name:"CircularIntegrate",latexTrigger:["\\oint"],parse:xi("CircularIntegrate"),serialize:As("\\oint")},{kind:"expression",latexTrigger:["\\oiint"],parse:xi("CircularIntegrate",2)},{kind:"expression",latexTrigger:["\\oiiint"],parse:xi("CircularIntegrate",3)}],Et=[["alpha","\\alpha",945],["beta","\\beta",946],["gamma","\\gamma",947],["delta","\\delta",948],["epsilon","\\epsilon",949],["epsilonSymbol","\\varepsilon",1013],["zeta","\\zeta",950],["eta","\\eta",951],["theta","\\theta",952],["thetaSymbol","\\vartheta",977],["iota","\\iota",953],["kappa","\\kappa",954],["kappaSymbol","\\varkappa",1008],["lambda","\\lambda",955],["mu","\\mu",956],["nu","\\nu",957],["xi","\\xi",958],["omicron","\\omicron",959],["pi","\\pi",960],["piSymbol","\\varpi",982],["rho","\\rho",961],["rhoSymbol","\\varrho",1009],["sigma","\\sigma",963],["finalSigma","\\varsigma",962],["tau","\\tau",964],["phi","\\phi",981],["phiLetter","\\varphi",966],["upsilon","\\upsilon",965],["chi","\\chi",967],["psi","\\psi",968],["omega","\\omega",969],["Alpha","\\Alpha",913],["Beta","\\Beta",914],["Gamma","\\Gamma",915],["Delta","\\Delta",916],["Epsilon","\\Epsilon",917],["Zeta","\\Zeta",918],["Eta","\\Eta",919],["Theta","\\Theta",920],["Iota","\\Iota",921],["Kappa","\\Kappa",922],["Lambda","\\Lambda",923],["Mu","\\Mu",924],["Nu","\\Nu",925],["Xi","\\Xi",926],["Omicron","\\Omicron",927],["Rho","\\Rho",929],["Sigma","\\Sigma",931],["Tau","\\Tau",932],["Phi","\\Phi",934],["Upsilon","\\Upsilon",933],["Chi","\\Chi",935],["Psi","\\Psi",936],["Omega","\\Omega",937],["digamma","\\digamma",989],["aleph","\\aleph",8501],["bet","\\beth",8502],["gimel","\\gimel",8503],["dalet","\\daleth",8504],["ell","\\ell",8499],["turnedCapitalF","\\Finv",8498],["turnedCapitalG","\\Game",8513],["weierstrass","\\wp",8472],["eth","\\eth",240],["invertedOhm","\\mho",8487],["hBar","\\hbar",295],["hSlash","\\hslash",8463],["blackClubSuit","\\clubsuit",9827],["whiteHeartSuit","\\heartsuit",9825],["blackSpadeSuit","\\spadesuit",9824],["whiteDiamondSuit","\\diamondsuit",9826],["sharp","\\sharp",9839],["flat","\\flat",9837],["natural","\\natural",9838]],Xc=[...Et.map(([e,t,i])=>({kind:"symbol",name:e,latexTrigger:[t],parse:e})),...Et.map(([e,t,i])=>({kind:"symbol",latexTrigger:[String.fromCodePoint(i)],parse:e}))],ef=[{name:"Real",kind:"function",latexTrigger:["\\Re"]},{name:"Imaginary",kind:"function",latexTrigger:["\\Im"]},{name:"Argument",kind:"function",latexTrigger:["\\arg"]},{name:"Conjugate",latexTrigger:["^","\\star"],kind:"postfix"}],tf=[{name:"Mean",kind:"function",identifierTrigger:"mean"},{name:"Median",kind:"function",identifierTrigger:"median"},{name:"StandarDeviation",kind:"function",identifierTrigger:"stddev"},{latexTrigger:["\\bar"],kind:"expression",parse:(e,t)=>{let i=e.parseGroup()??e.parseToken();return!i||!Q(i)?null:["Mean",i]}}],Ms={"(":"(",")":")","[":"\\lbrack","]":"\\rbrack","{":"\\lbrace","}":"\\rbrace","<":"\\langle",">":"\\rangle","|":"\\vert","||":"\\Vert","\\lceil":"\\lceil","\\lfloor":"\\lfloor","\\rceil":"\\rceil","\\rfloor":"\\rfloor"};function Uo(e,t,i){let r=rf(t,i);if(r===null)return;let n="kind"in t?t.kind:"expression",a=r.latexTrigger;typeof a=="string"&&(e.lookahead=Math.max(e.lookahead,Do(a)));let s=j(a??"",[]);if(s.length===2&&/[_^]/.test(s[0])&&s[1]!=="<{>"&&n!=="function"&&n!=="environment"&&n!=="matchfix"){let o=t.parse;!o&&t.name&&(n==="postfix"||n==="prefix"?o=(l,u)=>[t.name,u]:o=t.name),Uo(e,{...t,kind:n,name:void 0,serialize:void 0,parse:o,latexTrigger:[s[0],"<{>",s[1],"<}>"]},i)}e.defs.push(r),r.name!==void 0&&(e.ids.has(r.name)&&i({severity:"warning",message:["invalid-dictionary-entry",r.name,"Duplicate definition. The name (MathJSON identifier) must be unique, but triggers can be shared by multiple definitions."]}),e.ids.set(r.name,r))}function Is(e,t){let i={lookahead:1,ids:new Map,defs:[]};for(let r of e)Uo(i,r,t);return i}function rf(e,t){if(!sf(e,t))return null;let i={kind:"kind"in e?e.kind:"expression"},r=null;"latexTrigger"in e&&(typeof e.latexTrigger=="string"?r=j(e.latexTrigger,[]):r=e.latexTrigger);let n=null;"identifierTrigger"in e&&(n=e.identifierTrigger),r!==null&&(i.latexTrigger=Qt(r)),n!==null&&(i.identifierTrigger=n),e.name&&(i.name=e.name,i.serialize=nf(e,r,n)),i.kind==="matchfix"&&Xr(e)&&(i.openTrigger=e.openTrigger,i.closeTrigger=e.closeTrigger),i.kind==="symbol"&&_u(e)&&(i.precedence=e.precedence??1e4),i.kind==="expression"&&Nu(e)&&(i.precedence=e.precedence??1e4),(i.kind==="prefix"||i.kind==="postfix")&&(ua(e)||_o(e))&&(r&&(r[0]==="^"||r[0]==="_")?(i.precedence=720,e.precedence):i.precedence=e.precedence??1e4),i.kind==="infix"&&No(e)&&(!r||r[0]!=="^"&&r[0]!=="_"||!e.associativity||e.associativity,i.associativity=e.associativity??"non",i.precedence=e.precedence??1e4);let a=af(e,r,n);return a&&(i.parse=a),i}function nf(e,t,i){if(typeof e.serialize=="function")return e.serialize;let r=e.kind??"expression";if(r==="environment"){let s=e.identifierTrigger??e.name??"unknown";return(o,l)=>w([`\\begin{${s}}`,o.serialize(g(l,1)),`\\end{${s}}`])}if(Xr(e)){let s=typeof e.openTrigger=="string"?Ms[e.openTrigger]:Qt(e.openTrigger),o=typeof e.closeTrigger=="string"?Ms[e.closeTrigger]:Qt(e.closeTrigger);return(l,u)=>w([s,l.serialize(g(u,1)),o])}let n=e.serialize;if(n===void 0&&t&&(n=Qt(t)),n)return r==="postfix"?(s,o)=>w([s.serialize(g(o,1)),n]):r==="prefix"?(s,o)=>w([n,s.serialize(g(o,1))]):r==="infix"?(s,o)=>{let l=ae(o);if(l===0)return"";let u=e.precedence??1e4;return w(I(o).flatMap((f,c)=>{let h=s.wrap(f,u+1);return c<l-1?[h,n]:[h]}))}:(s,o)=>x(o)?w([n,s.wrapArguments(o)]):n;let a=i??e.name??"unknown";return r==="postfix"?(s,o)=>w([s.serialize(g(o,1)),s.serializeSymbol(a)]):r==="prefix"?(s,o)=>w([s.serializeSymbol(a),s.serialize(g(o,1))]):r==="infix"?(s,o)=>w([s.serialize(g(o,1)),s.serializeSymbol(a),s.serialize(g(o,2))]):(s,o)=>x(o)?w([s.serializeSymbol(a),s.wrapArguments(o)]):s.serializeSymbol(a)}function af(e,t,i){if("parse"in e&&typeof e.parse=="function")return e.parse;let r="kind"in e?e.kind:"expression";if(r==="environment"){let n=e.parse??e.name??i;if(n)return(a,s)=>{let o=a.parseTabular();return o===null?null:[n,["List",o.map(l=>["List",...l])]]}}if(r==="function"){let n=e.parse??e.name??i;if(n)return(a,s)=>{let o=a.parseArguments("enclosure",s);return o===null?n:[n,...o]}}if(r==="symbol"){let n=e.parse??e.name??i;if(n)return(a,s)=>n}if(r==="prefix"){let n=e.parse??e.name??i;if(n){let a=e.precedence??1e4;return(s,o)=>{let l=s.parseExpression({...o??[],minPrec:a});return l===null?null:[n,l]}}}if(r==="postfix"){let n=e.parse??e.name;if(n)return(a,s)=>s===null?null:[n,s]}if(r==="infix"){if(/[_^]/.test((t==null?void 0:t[0])??"")){let o=e.name??e.parse;return(l,u)=>[o,G(g(u,1)),G(g(u,2))]}let n=e.parse??e.name??i,a=e.precedence??1e4,s=e.associativity??"non";if(n)return(o,l,u)=>{if(l===null||a<u.minPrec)return null;let f=G(o.parseExpression({...u,minPrec:a}));return typeof n=="string"?$r(n,l,f,s):[n,l,f]}}if(r==="matchfix"){let n=e.parse??e.name;if(n)return(a,s)=>s===null||ye(s)?null:[n,s]}if(r==="expression"){let n=e.parse??e.name??i;if(n)return()=>n}if("parse"in e){let n=e.parse;return()=>n}}function sf(e,t){let i=e.name??e.latexTrigger??e.identifierTrigger??e.openTrigger;if(!i)try{i=JSON.stringify(e)}catch{i="???"}if(Array.isArray(i)&&(i=Qt(i)),"trigger"in e&&t({severity:"warning",message:["invalid-dictionary-entry",i,"The 'trigger' property is deprecated. Use 'latexTrigger' or 'identifierTrigger' instead"]}),"kind"in e&&!["expression","symbol","function","infix","postfix","prefix","matchfix","environment"].includes(e.kind)&&t({severity:"warning",message:["invalid-dictionary-entry",i,"The 'kind' property must be one of 'expression', 'symbol', 'function', 'infix', 'postfix', 'prefix', 'matchfix', 'environment'"]}),e.serialize!==void 0&&!e.name)return t({severity:"warning",message:["invalid-dictionary-entry",i,"A 'name' property must be provided if a 'serialize' handler is provided"]}),!1;if("identifierTrigger"in e&&(!("kind"in e)||e.kind!=="environment")&&(typeof e.identifierTrigger!="string"||!Ye(e.identifierTrigger))&&t({severity:"warning",message:["invalid-dictionary-entry",i,"The 'identifierTrigger' property must be a valid identifier"]}),"name"in e&&(typeof e.name!="string"?e.name!==void 0&&t({severity:"warning",message:["invalid-dictionary-entry",i,"The 'name' property must be a string"]}):Ye(e.name)||t({severity:"warning",message:["invalid-dictionary-entry",e.name,"The 'name' property must be a valid identifier"]})),Xr(e)){if("latexTrigger"in e||"identifierTrigger"in ua)return t({severity:"warning",message:["invalid-dictionary-entry",i,"'matchfix' operators use a 'openTrigger' and 'closeTrigger' instead of a 'latexTrigger' or 'identifierTrigger'. "]}),!1;if(!e.openTrigger||!e.closeTrigger)return t({severity:"warning",message:["invalid-dictionary-entry",i,"Expected `openTrigger` and a `closeTrigger` for matchfix operator"]}),!1;if(typeof e.openTrigger!=typeof e.closeTrigger)return t({severity:"warning",message:["invalid-dictionary-entry",i,"Expected `openTrigger` and `closeTrigger` to both be strings or array of LatexToken"]}),!1}if(No(e)||_o(e)||ua(e)){if(Array.isArray(e.latexTrigger)&&(e.latexTrigger[0]==="_"||e.latexTrigger[0]==="^")||typeof e.latexTrigger=="string"&&(e.latexTrigger.startsWith("^")||e.latexTrigger.startsWith("_"))){if(e.precedence!==void 0||e.associativity!==void 0)return t({severity:"warning",message:["invalid-dictionary-entry",i,'Unexpected "precedence" or "associativity" for superscript/subscript operator']}),!1}else if(e.precedence===void 0)return t({severity:"warning",message:["invalid-dictionary-entry",i,`Expected a "precedence" for ${e.kind} operator`]}),!1}else if(e.associativity!==void 0)return t({severity:"warning",message:["invalid-dictionary-entry",i,'Unexpected "associativity" operator']}),!1;return!Xr(e)&&!Su(e)&&!e.latexTrigger&&!e.identifierTrigger&&!e.name?(t({severity:"warning",message:["invalid-dictionary-entry",i,"Expected a 'name', a 'latexTrigger' or a 'identifierTrigger'"]}),!1):e.parse===void 0&&e.name===void 0?(t({severity:"warning",message:["invalid-dictionary-entry",i,"Expected a 'parse' or 'name'"]}),!1):!0}var ji={algebra:_c,arithmetic:$c,calculus:Yc,complex:ef,core:Vc,"linear-algebra":jc,logic:Gc,relop:Bo,other:Zc,physics:[{name:"mu0",kind:"symbol",latexTrigger:"\\mu_0"}],sets:Wc,statistics:tf,symbols:Xc,trigonometry:Hc},of={"\\mathord":"","\\mathop":"","\\mathbin":"","\\mathrel":"","\\mathopen":"","\\mathclose":"","\\mathpunct":"","\\mathinner":"","\\operatorname":"","\\mathrm":"_upright","\\mathit":"_italic","\\mathbf":"_bold","\\mathscr":"_script","\\mathcal":"_calligraphic","\\mathfrak":"_fraktur","\\mathsf":"_sansserif","\\mathtt":"_monospace","\\mathbb":"_doublestruck"},lf={"\\mathring":"_ring","\\hat":"_hat","\\tilde":"_tilde","\\vec":"_vec","\\overline":"_bar","\\underline":"_underbar","\\dot":"_dot","\\ddot":"_ddot","\\dddot":"_dddot","\\ddddot":"_ddddot","\\acute":"_acute","\\grave":"_grave","\\breve":"_breve","\\check":"_check"};function jo(e,t){if(e.atEnd)return null;let i=e.peek,r={"\\_":"_","\\#":"hash"}[i];if(!r&&!t.toplevel&&(r={"+":"plus","-":"minus","\\plusmn":"pm","\\pm":"pm","\\ast":"ast","\\dag":"dag","\\ddag":"ddag","\\bot":"bottom","\\top":"top","\\bullet":"bullet","\\cir":"circle","\\diamond":"diamond","\\times":"times","\\square":"square","\\star":"star"}[i]),r)return e.nextToken(),r;let n=Et.findIndex(a=>a[1]===i);return n>=0?(e.nextToken(),Et[n][0]):e.matchChar()??e.nextToken()}function Vr(e){let t=Ga(e),i=e.index,r=lf[e.peek]??null;if(r){if(e.nextToken(),!e.match("<{>"))return e.index=i,null;let s=Vr(e);if(s===null||!e.match("<}>"))return e.index=i,null;t=`${s}${r}`}if(t===null){for(t="";!e.atEnd;){let s=e.peek;if(s==="<}>"||s==="_"||s==="^")break;let o=jo(e,{toplevel:!1});if(o===null)return e.index=i,null;t+=o}for(;!e.atEnd&&/\d/.test(e.peek);)t+=e.nextToken()}for(;!e.atEnd;)if(e.match("\\degree"))t+="_deg";else if(e.matchAll(["^","\\prime"]))t+="_prime";else if(e.matchAll(["^","<{>","\\prime","<}>"]))t+="_prime";else if(e.matchAll(["^","<{>","\\doubleprime","<}>"]))t+="_dprime";else if(e.matchAll(["^","<{>","\\prime","\\prime","<}>"]))t+="_dprime";else break;let n=[],a=[];for(;!e.atEnd;)if(e.match("_")){let s=e.match("<{>"),o=Vr(e);if(s&&!e.match("<}>")||o===null)return e.index=i,null;a.push(o)}else if(e.match("^")){let s=e.match("<{>"),o=Vr(e);if(s&&!e.match("<}>")||o===null)return e.index=i,null;n.push(o)}else break;return n.length>0&&(t+="__"+n.join("")),a.length>0&&(t+="_"+a.join("")),t}function Ga(e){let t=e.index,i=of[e.peek]??null;if(i===null)return null;if(e.nextToken(),e.match("<{>")){let r="",n={0:"zero",1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"seven",8:"eight",9:"nine"}[e.peek]??"";return n&&(r=n,e.nextToken()),r+=Vr(e),r===null||!e.match("<}>")?(e.index=t,null):i==="_upright"&&r.length>1?r:r+i}return e.index=t,null}function Os(e){let t=e.index,i=Ga(e);return i===null||Ye(i)?(e.index=t,null):e.error(["invalid-identifier",{str:hi(i)}],t)}function zr(e){if(/^[a-zA-Z]$/.test(e.peek)||new RegExp("^\\p{XIDS}$","u").test(e.peek))return e.nextToken();let t=e.index,i=Ga(e);if(!i){for(i="";!e.atEnd&&Tn.test(i+e.peek);)i+=e.nextToken();i||(i=null)}return i??(i=jo(e,{toplevel:!0})),i&&(i=i.normalize(),Ye(i))?i:(e.index=t,null)}var qs={"(":["\\lparen","("],")":["\\rparen",")"],"[":["\\lbrack","\\[","["],"]":["\\rbrack","\\]","]"],"<":["<","\\langle"],">":[">","\\rangle"],"{":["\\{","\\lbrace"],"}":["\\}","\\rbrace"],":":[":","\\colon"],"|":["|","\\|","\\lvert","\\rvert"],"||":["||","\\Vert","\\lVert","\\rVert"],"\\lfloor":["\\lfloor"],"\\rfloor":["\\rfloor"],"\\lceil":["\\lceil"],"\\rceil":["\\rceil"],"\\ulcorner":["\\ulcorner"],"\\urcorner":["\\urcorner"],"\\llcorner":["\\llcorner"],"\\lrcorner":["\\lrcorner"],"\\lgroup":["\\lgroup"],"\\rgroup":["\\rgroup"],"\\lmoustache":["\\lmoustache"],"\\rmoustache":["\\rmoustache"]},sn={"\\left":"\\right","\\bigl":"\\bigr","\\Bigl":"\\Bigr","\\biggl":"\\biggr","\\Biggl":"\\Biggr","\\big":"\\big","\\Big":"\\Big","\\bigg":"\\bigg","\\Bigg":"\\Bigg"},tr={"(":")","[":"]","|":"|","\\{":"\\}","\\[":"\\]","\\lbrace":"\\rbrace","\\lparen":"\\rparen","\\langle":"\\rangle","\\lfloor":"\\rfloor","\\lceil":"\\rceil","\\vert":"\\vert","\\lvert":"\\rvert","\\Vert":"\\Vert","\\lVert":"\\rVert","\\lbrack":"\\rbrack","\\ulcorner":"\\urcorner","\\llcorner":"\\lrcorner","\\lgroup":"\\rgroup","\\lmoustache":"\\rmoustache"},Go={precision:6,positiveInfinity:"\\infty",negativeInfinity:"-\\infty",notANumber:"\\operatorname{NaN}",decimalMarker:".",groupSeparator:"\\,",exponentProduct:"\\cdot",beginExponentMarker:"10^{",endExponentMarker:"}",notation:"auto",truncationMarker:"\\ldots",beginRepeatingDigits:"\\overline{",endRepeatingDigits:"}",imaginaryUnit:"\\imaginaryI",avoidExponentsInRange:[-7,20]},Zo={skipSpace:!0,parseArgumentsOfUnknownLatexCommands:!0,parseNumbers:"auto",parseUnknownIdentifier:(e,t)=>{var i;return((i=t.computeEngine)==null?void 0:i.lookupFunction(e))!==void 0?"function":"symbol"},preserveLatex:!1},uf=class{constructor(e,t,i,r){this._index=0,this._boundaries=[],this._lastPeek="",this._peekCounter=0,this._tokens=e,this.options={...Go,...Zo,...t},this._dictionary=i,this.computeEngine=r,this._positiveInfinityTokens=j(this.options.positiveInfinity,[]),this._negativeInfinityTokens=j(this.options.negativeInfinity,[]),this._notANumberTokens=j(this.options.notANumber,[]),this._decimalMarkerTokens=j(this.options.decimalMarker,[]),this._groupSeparatorTokens=j(this.options.groupSeparator,[]),this._exponentProductTokens=j(this.options.exponentProduct,[]),this._beginExponentMarkerTokens=j(this.options.beginExponentMarker,[]),this._endExponentMarkerTokens=j(this.options.endExponentMarker,[]),this._truncationMarkerTokens=j(this.options.truncationMarker,[]),this._beginRepeatingDigitsTokens=j(this.options.beginRepeatingDigits,[]),this._endRepeatingDigitsTokens=j(this.options.endRepeatingDigits,[]),this._imaginaryNumberTokens=j(this.options.imaginaryUnit,[])}get index(){return this._index}set index(e){this._index=e,this._lastPeek="",this._peekCounter=0}updateOptions(e){for(let[t,i]of Object.entries(e))if(t in this.options)this.options[t]=i,typeof i=="string"&&(t==="positiveInfinity"&&(this._positiveInfinityTokens=j(i,[])),t==="negativeInfinity"&&(this._negativeInfinityTokens=j(i,[])),t==="notANumber"&&(this._notANumberTokens=j(i,[])),t==="decimalMarker"&&(this._decimalMarkerTokens=j(i,[])),t==="groupSeparator"&&(this._groupSeparatorTokens=j(i,[])),t==="exponentProduct"&&(this._exponentProductTokens=j(i,[])),t==="beginExponentMarker"&&(this._beginExponentMarkerTokens=j(i,[])),t==="endExponentMarker"&&(this._endExponentMarkerTokens=j(i,[])),t==="truncationMarker"&&(this._truncationMarkerTokens=j(i,[])),t==="beginRepeatingDigits"&&(this._beginRepeatingDigitsTokens=j(i,[])),t==="endRepeatingDigits"&&(this._endRepeatingDigitsTokens=j(i,[])),t==="imaginaryNumber"&&(this._imaginaryNumberTokens=j(i,[])));else throw Error(`Unexpected option "${t}"`)}get atEnd(){return this.index>=this._tokens.length}get peek(){let e=this._tokens[this.index];if(e===this._lastPeek?this._peekCounter+=1:this._peekCounter=0,this._peekCounter>=1024){let t=`Infinite loop detected while parsing "${this.latex(0)}" at "${this._lastPeek}" (index ${this.index})`;throw console.error(t),new Error(t)}return this._lastPeek=e,e}nextToken(){return this._tokens[this.index++]}atTerminator(e){return this.atBoundary||(((e==null?void 0:e.condition)&&e.condition(this))??!1)}get atBoundary(){if(this.atEnd)return!0;let e=this.index;for(let t of this._boundaries)if(this.matchAll(t.tokens))return this.index=e,!0;return!1}addBoundary(e){this._boundaries.push({index:this.index,tokens:e})}removeBoundary(){this._boundaries.pop()}matchBoundary(){let e=this._boundaries[this._boundaries.length-1],t=e&&this.matchAll(e.tokens);return t&&this._boundaries.pop(),t}boundaryError(e){let t=this._boundaries[this._boundaries.length-1];return this._boundaries.pop(),this.error(e,t.index)}latex(e,t){return Qt(this._tokens.slice(e,t))}latexAhead(e){return this.latex(this.index,this.index+e)}lookAhead(){let e=Math.min(this._dictionary.lookahead,this._tokens.length-this.index);if(e<=0)return[];let t=[];for(;e>0;)t.push([e,this.latexAhead(e--)]);return t}peekDefinitions(e){if(this.atEnd)return[];let t=[],i=[...this.getDefs(e)];for(let r of i)r.latexTrigger===""&&t.push([r,0]);for(let[r,n]of this.lookAhead())for(let a of i)a.latexTrigger===n&&t.push([a,r]);for(let r of i)if(r.identifierTrigger){let n=cf(this,r.identifierTrigger);n>0&&t.push([r,n])}return t}skipSpaceTokens(){for(;this.match("<space>"););}skipSpace(){if(!this.atEnd&&this.peek==="<{>"){let t=this.index;for(this.nextToken();this.match("<space>"););if(this.nextToken()==="<}>")return this.skipSpace(),!0;this.index=t}if(!this.options.skipSpace)return!1;let e=!1;for(;this.match("<space>");)e=!0;return e&&this.skipSpace(),e}skipVisualSpace(){this.options.skipSpace&&(this.skipSpace(),["\\!","\\,","\\:","\\;","\\enskip","\\enspace","\\space","\\quad","\\qquad"].includes(this.peek)&&(this.nextToken(),this.skipVisualSpace()),this.skipSpace())}match(e){return this._tokens[this.index]===e?(this.index++,!0):!1}matchAll(e){if(e.length===0)return!1;let t=!0,i=0;do t=this._tokens[this.index+i]===e[i++];while(t&&i<e.length);return t&&(this.index+=i),t}matchAny(e){return e.includes(this._tokens[this.index])?this._tokens[this.index++]:""}matchChar(){let e=this.index,t=0;for(;this.match("^");)t+=1;if(t<2&&(this.index=e),t>=2){let i="",r=0;for(;r!=t;){let n=this.matchAny(["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"]);if(!n)break;i+=n,r+=1}if(i.length===t)return String.fromCodePoint(Number.parseInt(i,16))}else if(this.match("\\char")){let i=Math.floor(this.matchLatexNumber()??Number.NaN);return(!Number.isFinite(i)||i<0||i>1114111)&&(i=10067),String.fromCodePoint(i)}else if(this.match("\\unicode"))if(this.skipSpaceTokens(),this.match("<{>")){let i=this.matchLatexNumber();if(this.match("<}>")&&i!==null&&i>=0&&i<=1114111)return String.fromCodePoint(i)}else{let i=this.matchLatexNumber();if(i!==null&&i>=0&&i<=1114111)return String.fromCodePoint(i)}return this.index=e,null}matchDelimiter(e,t){if(this.peek==="[")return!1;if(Array.isArray(e))return this.matchAll(e)?(this.addBoundary(t),!0):!1;let i=this.index,r=sn[this.peek];return r&&this.nextToken(),e==="||"&&this.matchAll(["|","|"])?(this.addBoundary(["|","|"]),!0):(qs[e]??[e]).includes(this.peek)?(e=this.nextToken(),t=tr[e]??t,this.addBoundary(r?[r,t]:[t]),!0):(this.index=i,!1)}parseGroup(){let e=this.index;if(this.skipSpaceTokens(),this.match("<{>")){this.addBoundary(["<}>"]);let t=this.parseExpression();if(this.skipSpace(),this.matchBoundary())return t??["Sequence"];for(;!this.matchBoundary()&&!this.atEnd;)this.nextToken();if(x(t)==="Error")return t;let i=this.error("expected-closing-delimiter",e);return t?["InvisibleOperator",t,i]:i}return this.index=e,null}parseToken(){return this.skipSpace(),[...'!"#$%&(),/;:?@[]\\`|~'.split(""),"\\left","\\bigl"].includes(this.peek)?null:/^[0-9]$/.test(this.peek)?parseInt(this.nextToken()):(this.parseGenericExpression()??this.parseSymbol())||null}parseOptionalGroup(){let e=this.index;if(this.skipSpaceTokens(),this.match("[")){this.addBoundary(["]"]);let t=this.parseExpression();return this.skipSpace(),this.matchBoundary()?t:this.boundaryError("expected-closing-delimiter")}return this.index=e,null}parseTabular(){let e=[],t=[],i=null;for(;!this.atBoundary;)if(this.skipSpace(),this.match("&"))t.push(i??"Nothing"),i=null;else if(this.match("\\\\")||this.match("\\cr"))this.skipSpace(),this.parseOptionalGroup(),i!==null&&t.push(i),e.push(t),t=[],i=null;else{let r=[],n=this.peek;for(;n!=="&"&&n!=="\\\\"&&n!=="\\cr"&&!this.atBoundary;)i=this.parseExpression({minPrec:0,condition:a=>{let s=a.peek;return s==="&"||s==="\\\\"||s==="\\cr"}}),i?r.push(i):(r.push(["Error",["'unexpected-token'",n]]),this.nextToken()),this.skipSpace(),n=this.peek;r.length>1?i=["Sequence",...r]:i=r[0]??"Nothing"}return i!==null&&t.push(i),t.length>0&&e.push(t),e}parseStringGroup(e){e===void 0&&(e=!1);let t=this.index;for(;this.match("<space>"););if(this.match(e?"[":"<{>")){this.addBoundary([e?"]":"<}>"]);let i=this.parseStringGroupContent();if(this.matchBoundary())return i;this.removeBoundary()}return this.index=t,null}parseEnvironment(e){var r;let t=this.index;if(!this.match("\\begin"))return null;let i=(r=this.parseStringGroup())==null?void 0:r.trim();if(!i)return this.error("expected-environment-name",t);this.addBoundary(["\\end","<{>",...i.split(""),"<}>"]);for(let n of this.getDefs("environment"))if(n.identifierTrigger===i){let a=n.parse(this,e);return this.skipSpace(),this.matchBoundary()?a!==null?this.decorate(a,t):(this.index=t,null):this.boundaryError("unbalanced-environment")}return this.parseTabular(),this.skipSpace(),this.matchBoundary()?this.error(["unknown-environment",{str:i}],t):this.boundaryError("unbalanced-environment")}parseOptionalSign(){let e=!!this.matchAny(["-",""]);for(;this.matchAny(["+",""])||this.skipSpace();)this.matchAny(["-",""])&&(e=!e);return e?"-":"+"}parseDecimalDigits(e){e??(e={}),e.withGrouping??(e.withGrouping=!0);let t=[],i=!1;for(;!i;){for(;/^[0-9]$/.test(this.peek);)t.push(this.nextToken()),this.skipVisualSpace();if(i=!0,e.withGrouping&&this.options.groupSeparator){let r=this.index;this.skipVisualSpace(),this.matchAll(this._groupSeparatorTokens)&&(this.skipVisualSpace(),/^[0-9]$/.test(this.peek)?i=!1:this.index=r)}}return t.join("")}parseSignedInteger(e){e??(e={}),e.withGrouping??(e.withGrouping=!0);let t=this.index,i=this.parseOptionalSign(),r=this.parseDecimalDigits(e);return r?i==="-"?"-"+r:r:(this.index=t,"")}parseExponent(){let e=this.index;if(this.matchAny(["e","E"])){let t=this.parseSignedInteger({withGrouping:!1});if(t)return t}if(this.index=e,this.match("\\times")&&(this.skipSpaceTokens(),this.match("1")&&this.match("0")&&this.match("^"))){if(/^[0-9]$/.test(this.peek))return this.nextToken();if(this.match("<{>")){this.skipSpaceTokens();let t=this.parseSignedInteger();if(this.skipSpaceTokens(),this.match("<}>")&&t)return t}}if(this.index=e,this.skipSpaceTokens(),this.match("\\%"))return"-2";if(this.index=e,this.matchAll(this._exponentProductTokens)&&(this.skipSpaceTokens(),this.matchAll(this._beginExponentMarkerTokens))){this.skipSpaceTokens();let t=this.parseSignedInteger({withGrouping:!1});if(this.skipSpaceTokens(),this.matchAll(this._endExponentMarkerTokens)&&t)return t}return this.index=e,""}parseRepeatingDecimal(){let e=this.index,t="";return this.match("(")?(t=this.parseDecimalDigits(),t&&this.match(")")?"("+t+")":(this.index=e,"")):(this.index=e,this.matchAll(["\\left","("])?(t=this.parseDecimalDigits(),t&&this.matchAll(["\\right",")"])?"("+t+")":(this.index=e,"")):(this.index=e,this.matchAll(["\\overline","<{>"])?(t=this.parseDecimalDigits(),t&&this.match("<}>")?"("+t+")":(this.index=e,"")):(this.index=e,this.matchAll(this._beginRepeatingDigitsTokens)?(t=this.parseDecimalDigits(),t&&this.matchAll(this._endRepeatingDigitsTokens)?"("+t+")":(this.index=e,"")):(this.index=e,""))))}parseNumber(){if(this.options.parseNumbers===!1||this.options.parseNumbers==="never")return null;let e=this.index;this.skipVisualSpace();let t=1;for(;this.peek==="-"||this.peek==="+";)this.match("-")?t*=-1:this.match("+"),this.skipVisualSpace();let i="",r="",n=!1;if(this.match(".")||this.matchAll(this._decimalMarkerTokens)){let u=this.peek;(u==="\\overline"||u===this._beginRepeatingDigitsTokens[0]||/[0-9\(]/.test(u))&&(n=!0,i="0")}else i=this.parseDecimalDigits();if(!i)return this.index=e,null;let a=this.index,s=!1;(n||this.match(".")||this.matchAll(this._decimalMarkerTokens))&&(r=this.parseDecimalDigits(),s=!0);let o=!1;if(s){let u=this.parseRepeatingDecimal();u?(r+=u,o=!0):this.match("\\ldots")||this.matchAll(this._truncationMarkerTokens)}if(s&&!r)return this.index=a,{num:t<0?"-"+i:i};this.skipVisualSpace();let l=this.parseExponent();if(!o&&this.options.parseNumbers==="rational"){let u=parseInt(i,10);if(!r)return l?["Multiply",t*u,["Power",10,l]]:t*u;let f=parseInt(r,10),c=r.length,h=u*Math.pow(10,c)+f,p=Math.pow(10,c);return l?["Multiply",["Rational",t*h,p],["Power",10,l]]:["Rational",t*h,p]}return{num:(t<0?"-":"")+i+(s?"."+r:"")+(l?"e"+l:"")}}matchLatexNumber(e=!0){let t=!1,i=this.peek;for(;i==="<space>"||i==="+"||i==="-";)i==="-"&&(t=!t),this.nextToken(),i=this.peek;let r=10,n=["0","1","2","3","4","5","6","7","8","9"];if(this.match("'"))r=8,n=["0","1","2","3","4","5","6","7"],e=!0;else if(this.match('"')||this.match("x"))r=16,n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],e=!0;else if(this.match("`"))return i=this.nextToken(),i?i.startsWith("\\")&&i.length===2?(t?-1:1)*(i.codePointAt(1)??0):(t?-1:1)*(i.codePointAt(0)??0):null;let a="";for(;n.includes(this.peek);)a+=this.nextToken();if(!e&&this.match("."))for(a+=".";n.includes(this.peek);)a+=this.nextToken();let s=e?Number.parseInt(a,r):Number.parseFloat(a);return Number.isNaN(s)?null:t?-s:s}parsePrefixOperator(e){e||(e={minPrec:0}),e.minPrec||(e={...e,minPrec:0});let t=this.index;for(let[i,r]of this.peekDefinitions("prefix")){this.index=t+r;let n=i.parse(this,{...e,minPrec:i.precedence+1});if(n)return n}return this.index=t,null}parseInfixOperator(e,t){t??(t={minPrec:0}),t.minPrec,t.minPrec===void 0&&(t={...t,minPrec:0});let i=this.index;for(let[r,n]of this.peekDefinitions("infix"))if(r.precedence>=t.minPrec){this.index=i+n;let a=r.parse(this,e,t);if(a)return a}return this.index=i,null}parseArguments(e="enclosure",t){if(this.atTerminator(t))return null;let i=this.index,r=this.parseEnclosure();if(e==="enclosure")return r===null?null:zo(r)??[];if(e==="implicit"){if(x(r)==="Delimiter"){if(x(Ge(r))==="Sequence"){let a=Ge(Ge(r));return a?[a]:[]}return Ge(r)?[Ge(r)]:[]}if(r!==null)return[r];let n=this.parseExpression({...t,minPrec:390});return n===null?null:[n]}return this.index=i,null}matchOpenDelimiter(e,t){let i=this.index,r=sn[this.peek];r&&this.nextToken();let n=qs[e]??[e],a=r?[r]:[];return n.includes("||")&&this.matchAll(["|","|"])?(a.push("|"),a.push("|"),a):n.includes(this.peek)?(tr[e]===t?a.push(tr[this.peek]):a.push(t),this.nextToken(),a):(this.index=i,null)}parseEnclosure(){let e=this.getDefs("matchfix"),t=this.index;for(let i of e){if(this.index=t,!this.matchDelimiter(i.openTrigger,i.closeTrigger))continue;let r=this.index;this.skipSpace();let n=this.parseExpression();if(this.skipSpace(),!this.matchBoundary()){let s=this._boundaries[this._boundaries.length-1].tokens;if(this.removeBoundary(),this.index=r,this.skipSpace(),n=this.parseExpression(),this.skipSpace(),!this.matchAll(s)){if(!this.atEnd)continue;return this.index=t,null}}let a=i.parse(this,n??["Sequence"]);if(a!==null)return a}return this.index=t,null}parseGenericExpression(e){if(this.atTerminator(e))return null;let t=this.index,i=null,r=this.peekDefinitions("expression")??[];for(let[n,a]of r)if(this.index=t+a,typeof n.parse=="function"){if(i=n.parse(this,e),i!==null)return i}else return n.name;return this.index=t,null}parseFunction(e){if(this.atTerminator(e))return null;let t=this.index,i=null;for(let[n,a]of this.peekDefinitions("function"))if(this.index=t+a,typeof n.parse=="function"){if(i=n.parse(this,e),i!==null)return i}else{i=n.name;break}if(i===null&&(this.index=t,i=zr(this),!this.isFunctionHead(i)))return this.index=t,null;do{let n=this.parsePostfixOperator(i,e);if(n===null)break;i=n}while(!0);let r=this.parseArguments("enclosure",e);return r===null?i:typeof i=="string"?[i,...r]:["Apply",i,...r]}parseSymbol(e){var r,n;if(this.atTerminator(e))return null;let t=this.index;for(let[a,s]of this.peekDefinitions("symbol"))if(this.index=t+s,typeof a.parse=="function"){let o=a.parse(this,e);if(o)return o}else return a.name;this.index=t;let i=zr(this);return i===null?null:((n=(r=this.options).parseUnknownIdentifier)==null?void 0:n.call(r,i,this))==="symbol"?i:(this.index=t,null)}parseSupsub(e){if(this.atEnd)return e;let t=this.index;this.skipSpace();let i=[],r=[],n=t;for(;this.peek==="_"||this.peek==="^";){if(this.match("_"))if(n=this.index,this.match("_")||this.match("^"))r.push(this.error("syntax-error",n));else{let s=this.parseGroup()??this.parseToken()??this.parseStringGroup();if(s===null)return this.error("missing",t);r.push(s)}else if(this.match("^"))if(n=this.index,this.match("_")||this.match("^"))i.push(this.error("syntax-error",n));else{let s=this.parseGroup()??this.parseToken();if(s===null)return this.error("missing",t);i.push(s)}n=this.index,this.skipSpace()}if(i.length===0&&r.length===0)return this.index=t,e;let a=e;if(r.length>0){let s=[...this.getDefs("infix")].filter(o=>o.latexTrigger==="_");if(s){let o=["Subscript",a,r.length===1?r[0]:["List",...r]];for(let l of s)if(typeof l.parse=="function"?a=l.parse(this,o,{minPrec:0}):a=o,a)break}}if(i.length>0){let s=[...this.getDefs("infix")].filter(o=>o.latexTrigger==="^");if(s){let o=i.filter(l=>!(x(l)==="Sequence"&&ae(l)===0));if(o.length!==0){let l=o.length===1?o[0]:["List",...o],u=["Superscript",a,l];for(let f of s)if(typeof f.parse=="function"?a=f.parse(this,u,{minPrec:0}):a=u,a)break}}}return a===null&&(this.index=t),a}parsePostfixOperator(e,t){if(e===null||this.atEnd)return null;let i=this.index;for(let[r,n]of this.peekDefinitions("postfix")){this.index=i+n;let a=r.parse(this,e,t);if(a!==null)return a}return this.index=i,null}parseStringGroupContent(){let e=this.index,t="",i=0;for(;!this.atBoundary||i>0;){let r=this.nextToken();if(r==="<$>"||r==="<$$>")return this.index=e,"";r==="<{>"?(i+=1,t+="\\{"):r==="<}>"?(i-=1,t+="\\}"):r==="<space>"?t+=" ":(r[0],t+=r)}return t}parseSyntaxError(){let e=this.index;if(this.peek==="^")return this.index+=1,["Superscript",this.error("missing",e),G(this.parseGroup())];let t=this.peekDefinitions("operator");if(t.length>0){if(t=this.peekDefinitions("postfix"),t.length>0){let[s,o]=t[0];if(this.index+=o,typeof s.parse=="function"){let l=s.parse(this,this.error("missing",e));if(l)return l}return s.name?[s.name,this.error("missing",e)]:this.error("unexpected-operator",e)}if(t=this.peekDefinitions("prefix"),t.length>0){let[s,o]=t[0];if(this.index+=o,typeof s.parse=="function"){let l=s.parse(this,{minPrec:0});if(l)return l}return s.name?[s.name,this.parseExpression()??this.error("missing",e)]:this.error("unexpected-operator",e)}if(t=this.peekDefinitions("infix"),t.length>0){let[s,o]=t[0];return this.index+=o,s.parse(this,this.error("missing",e),{minPrec:0})||this.error("unexpected-operator",e)}}let i=this.index,r=Os(this);if(r)return r;if(r=zr(this),r)return this.error(["unexpected-identifier",r],i);let n=this.peek;if(!n)return this.error("syntax-error",e);if(n[0]!=="\\")return this.error(["unexpected-token",{str:Qt(n)}],e);if(ff(this))return this.error("unexpected-delimiter",e);let a=this.nextToken();if(this.skipSpaceTokens(),a==="\\end"){let s=this.parseStringGroup();return s===null?this.error("expected-environment-name",e):this.error(["unbalanced-environment",{str:s}],e)}for(;this.match("[");){let s=0;for(;!this.atEnd&&s===0&&this.peek!=="]";)this.peek==="["&&(s+=1),this.peek==="]"&&(s-=1),this.nextToken();this.match("]")}for(;this.match("<{>");){let s=0;for(;!this.atEnd&&s===0&&this.peek!=="<}>";)this.peek==="<{>"&&(s+=1),this.peek==="<}>"&&(s-=1),this.nextToken();this.match("<}>")}return this.error(["unexpected-command",{str:Qt(a)}],e)}parsePrimary(e){if(this.atBoundary||this.atTerminator(e))return null;let t=null,i=this.index;if(this.match("<}>"))return this.error("unexpected-closing-delimiter",i);if(t??(t=this.parseGroup()),t??(t=this.parseNumber()),t??(t=this.parseEnclosure()),t??(t=this.parseEnvironment(e)),t===null&&this.matchAll(this._positiveInfinityTokens)&&(t={num:"+Infinity"}),t===null&&this.matchAll(this._negativeInfinityTokens)&&(t={num:"-Infinity"}),t===null&&this.matchAll(this._notANumberTokens)&&(t={num:"NaN"}),t??(t=this.parseGenericExpression(e)??this.parseFunction(e)??this.parseSymbol(e)??Os(this)),t!==null){t=this.decorate(t,i);let r=null,n=this.index;do{if(r=this.parsePostfixOperator(t,e),t=r??t,this.index===n&&r!==null){this.index;break}n=this.index}while(r!==null)}return t!==null&&(t=this.parseSupsub(t)),this.decorate(t,i)}parseExpression(e){this.skipSpace();let t=this.index;if(this.atBoundary)return this.index=t,null;e??(e={minPrec:0}),e.minPrec,e.minPrec===void 0&&(e={...e,minPrec:0});let i=this.parsePrefixOperator({...e,minPrec:0});if(i===null&&(i=this.parsePrimary(e),x(i)==="Sequence"&&ae(i)===0&&(i=null)),i){let r=!1;for(;!r&&!this.atTerminator(e);){this.skipSpace();let n=this.parseInfixOperator(i,e);if(n===null&&this.peekDefinitions("operator").length===0){let a=this.parseExpression({...e,minPrec:St});a!==null&&(x(i)==="InvisibleOperator"?x(a)==="InvisibleOperator"?n=["InvisibleOperator",...I(i),...I(a)]:n=["InvisibleOperator",...I(i),a]:x(a)==="InvisibleOperator"?n=["InvisibleOperator",i,...I(a)]:n=["InvisibleOperator",i,a])}n!==null?i=n:r=!0}}return this.decorate(i,t)}decorate(e,t){if(e===null)return null;if(!this.options.preserveLatex)return e;let i=this.latex(t,this.index);return Array.isArray(e)?e={latex:i,fn:e}:typeof e=="number"?e={latex:i,num:Number(e).toString()}:typeof e=="string"?e={latex:i,sym:e}:typeof e=="object"&&e!==null&&(e.latex=i),e}error(e,t){let i;typeof e=="string"?(e.startsWith("'"),i={str:e}):(e[0].startsWith("'"),i=["ErrorCode",{str:e[0]},...e.slice(1)]);let r=this.latex(t,this.index);return r?["Error",i,["LatexString",{str:r}]]:["Error",i]}isFunctionHead(e){var i,r,n;if(e===null)return!1;let t=Q(e);return t?((i=this.computeEngine)==null?void 0:i.lookupFunction(t))!==void 0||((n=(r=this.options).parseUnknownIdentifier)==null?void 0:n.call(r,t,this))==="function":!1}*getDefs(e){if(e==="operator")for(let t of this._dictionary.defs)/^prefix|infix|postfix/.test(t.kind)&&(yield t);else for(let t of this._dictionary.defs)t.kind===e&&(yield t)}};function cf(e,t){var a;let i=e.index,r=(a=zr(e))==null?void 0:a.trim();if(r===null)return 0;let n=r!==t?0:e.index-i;return e.index=i,n}function ff(e){let t=e.peek;return Object.values(tr).includes(t)||tr[t]?(e.nextToken(),!0):sn[t]||Object.values(sn).includes(t)?(e.nextToken(),e.nextToken(),!0):!1}function Ho(e,t){let i=e.length,r=e;if(t.beginRepeatingDigits&&t.endRepeatingDigits){e=e.slice(0,-1);for(let a=0;a<e.length-16;a++){let s=e.substring(0,a);for(let o=0;o<17;o++){let l=e.substring(a,a+o+1),u=Math.floor((e.length-s.length)/l.length);if(u<=3)break;if((s+l.repeat(u+1)).startsWith(e))return l==="0"?s.replace(/(\d{3})/g,"$1"+t.groupSeparator):s.replace(/(\d{3})/g,"$1"+t.groupSeparator)+t.beginRepeatingDigits+l+t.endRepeatingDigits}}}let n=i>t.precision-1;return e=r,n&&(e=e.substring(0,t.precision-1)),t.groupSeparator&&(e=e.replace(/(\d{3})/g,"$1"+t.groupSeparator),e.endsWith(t.groupSeparator)&&(e=e.slice(0,-t.groupSeparator.length))),n?e+t.truncationMarker:e}function Wo(e,t){return e?t.beginExponentMarker?t.beginExponentMarker+e+(t.endExponentMarker??""):"10^{"+e+"}":""}function hf(e,t){if(e===null)return"";let i;if(typeof e=="number"||typeof e=="string")i=e;else if(typeof e=="object"&&"num"in e)i=e.num;else return"";if(typeof i=="number"){if(i===1/0)return t.positiveInfinity;if(i===-1/0)return t.negativeInfinity;if(Number.isNaN(i))return t.notANumber;let a;return t.notation==="engineering"?a=kr(i.toExponential(),t,3):t.notation==="scientific"&&(a=kr(i.toExponential(),t)),a??va(i.toString(),t)}if(i=i.toLowerCase().replace(/[\u0009-\u000d\u0020\u00a0]/g,""),i==="infinity"||i==="+infinity")return t.positiveInfinity;if(i==="-infinity")return t.negativeInfinity;if(i==="nan")return t.notANumber;if(!/^[-+\.]?[0-9]/.test(i))return"";if(i=i.replace(/[nd]$/,""),/\([0-9]+\)/.test(i)){let[a,s,o,l]=i.match(/(.+)\(([0-9]+)\)(.*)$/)??[];i=s+o.repeat(Math.ceil(t.precision/o.length))+l}let r="";for(i[0]==="-"?(r="-",i=i.substring(1)):i[0]==="+"&&(i=i.substring(1));i[0]==="0";)i=i.substring(1);i.length===0?i="0":i[0]==="."&&(i="0"+i);let n;return t.notation==="engineering"?n=kr(i,t,3):t.notation==="scientific"&&(n=kr(i,t)),r+(n??va(i,t))}function kr(e,t,i=1){let r=e.match(/^(.*)[e|E]([-+]?[0-9]+)$/);if(!r){let f="";if(e[0]==="-"?(f="-",e=e.substring(1)):e[0]==="+"&&(e=e.substring(1)),e.indexOf(".")<0)e.length===1?e=f+e+"e+0":e=f+e[0]+"."+e.slice(1)+"e+"+(e.length-1).toString();else{let[c,h,p]=e.match(/^(.*)\.(.*)$/);for(p||(p="");h.startsWith("0");)h=h.substring(1);h?e=f+h[0]+"."+h.slice(1)+p+"e+"+(h.length-1).toString():e=f+"0."+p+"e+0"}r=e.match(/^(.*)[e|E]([-+]?[0-9]+)$/)}if(!r)return va(e,t);let n=parseInt(r[2]),a=r[1];if(Math.abs(n)%i!==0){let f=n>0?n%i:-((i+n)%i);n=n>=0?n-f:n+f;let[c,h,p]=a.match(/^(.*)\.(.*)$/)??["",a,""];a=h+(p+"00000000000000000").slice(0,Math.abs(f))+"."+p.slice(Math.abs(f))}let s=t.avoidExponentsInRange;if(s&&n>=s[0]&&n<=s[1])return;let o="",l=a;r=l.match(/^(.*)\.(.*)$/),r&&(l=r[1],o=r[2]);let u=n!==0?Wo(Number(n).toString(),t):"";return t.groupSeparator&&(l=l.replace(/\B(?=(\d{3})+(?!\d))/g,t.groupSeparator),o=Ho(o,t)),o&&(o=t.decimalMarker+o),u?l==="1"&&!o?u:l+o+t.exponentProduct+u:l+o}function va(e,t){let i=e.match(/^(.*)[e|E]([-+]?[0-9]+)$/i),r;i!=null&&i[1]&&i[2]&&(r=Wo(i[2],t));let n=(i==null?void 0:i[1])??e,a="";return i=(r?i[1]:e).match(/^(.*)\.(.*)$/),i!=null&&i[1]&&i[2]&&(n=i[1],a=i[2]),t.groupSeparator&&(n=n.replace(/\B(?=(\d{3})+(?!\d))/g,t.groupSeparator),a=Ho(a,t)),a&&(a=t.decimalMarker+a),r?n==="1"&&!a?r:n+a+t.exponentProduct+r:n+a}var xa={deg:e=>`${e}\\degree`,prime:e=>`${e}^{\\prime}`,dprime:e=>`${e}^{\\doubleprime}`,ring:e=>`\\mathring{${e}}`,hat:e=>`\\hat{${e}}`,tilde:e=>`\\tilde{${e}}`,vec:e=>`\\vec{${e}}`,bar:e=>`\\overline{${e}}`,underbar:e=>`\\underline{${e}}`,dot:e=>`\\dot{${e}}`,ddot:e=>`\\ddot{${e}}`,tdot:e=>`\\dddot{${e}}`,qdot:e=>`\\ddddot{${e}}`,acute:e=>`\\acute{${e}}`,grave:e=>`\\grave{${e}}`,breve:e=>`\\breve{${e}}`,check:e=>`\\check{${e}}`},ya={upright:e=>`\\mathrm{${e}}`,italic:e=>`\\mathit{${e}}`,bold:e=>`\\mathbf{${e}}`,script:e=>`\\mathscr{${e}}`,fraktur:e=>`\\mathfrak{${e}}`,doublestruck:e=>`\\mathbb{${e}}`,blackboard:e=>`\\mathbb{${e}}`,calligraphic:e=>`\\mathcal{${e}}`,gothic:e=>`\\mathfrak{${e}}`,sansserif:e=>`\\mathsf{${e}}`,monospace:e=>`\\mathtt{${e}}`},pf=class{constructor(e,t,i){this.level=-1,this.options=e,e.invisibleMultiply&&(!/#1/.test(e.invisibleMultiply)||!/#2/.test(e.invisibleMultiply))&&i([{severity:"warning",message:["expected-argument","invisibleMultiply"]}]),this.onError=i,this.dictionary=t,this.canonical=void 0}updateOptions(e){for(let t of Object.keys(this.options))t in e&&(this.options[t]=e[t])}wrap(e,t){if(e===null)return"";if(t===void 0)return this.wrapString(this.serialize(e),this.options.groupStyle(e,this.level+1));if(typeof e=="number"||kn(e)){let r=D(e);return r!==null&&r<0&&t>he?this.wrap(e):this.serialize(e)}let i=x(e);if(typeof i=="string"&&i!=="Delimiter"&&i!=="Subscript"){let r=this.dictionary.ids.get(i);if(r&&(r.kind==="symbol"||r.kind==="expression"||r.kind==="prefix"||r.kind==="infix"||r.kind==="postfix")&&r.precedence<t)return this.wrapString(this.serialize(e),this.options.applyFunctionStyle(e,this.level))}return this.serialize(e)}wrapShort(e){if(e===null)return"";let t=this.serialize(e);if(Q(e)!==null||x(e)==="Delimiter"&&ae(e)===1||wn(e)&&!/^(-|\.)/.test(t))return t;let i=x(e);return i!=="Add"&&i!=="Negate"&&i!=="Subtract"&&i!=="PlusMinus"&&i!=="Multiply"?t:this.wrapString(t,this.options.groupStyle(e,this.level+1))}wrapString(e,t,i){if(t==="none")return e;i??(i="()");let r=(i==null?void 0:i[0])??".",n=(i==null?void 0:i[1])??".";return r==='"'?r="``":r==="|"?r="\\lvert":r=an[r]??r,n==='"'?n="''":n==="|"?n="\\rvert":n=an[n]??n,r==="."&&n==="."?e:((r==="."||n===".")&&t==="normal"&&(t="scaled"),t==="scaled"?`\\left${r}${e}\\right${n}}`:t==="big"?`${`\\Bigl${r}`}${e}${`\\Bigr${n}`})`:r+e+n)}wrapArguments(e){return this.wrapString((I(e)??[]).map(t=>this.serialize(t)).join(", "),this.options.applyFunctionStyle(e,this.level))}serializeSymbol(e,t){var i;return(t==null?void 0:t.kind)==="function"?Wn(Q(e)??"")??"":((i=t==null?void 0:t.serialize)==null?void 0:i.call(t,this,e))??Wn(Q(e))??""}serializeFunction(e,t){if(t!=null&&t.serialize)return t.serialize(this,e);let i=x(e);if(typeof i=="string")return Wn(i,"auto")+this.wrapArguments(e);if(x(i)==="InverseFunction"||x(i)==="Derivative")return this.serializeFunction(i,this.dictionary.ids.get(x(i)))+this.wrapArguments(e);let r=I(e)??[];if(r.length===1)return w([this.serialize(r[0]),"\\rhd",this.wrapString(this.serialize(i),this.options.applyFunctionStyle(e,this.level))]);let n=this.options.applyFunctionStyle(e,this.level);return w(["\\operatorname{apply}",this.wrapString(this.serialize(i)+", "+this.serialize(["List",...r]),n)])}serializeDictionary(e){return`\\left\\lbrack\\begin{array}{lll}${Object.keys(e).map(t=>`\\textbf{${t}} & \\rightarrow & ${this.serialize(e[t])}`).join("\\\\")}\\end{array}\\right\\rbrack`}serialize(e,t){if(e==null)return"";t??(t={}),t={...t},"canonical"in t||(t.canonical=!0);let i=this.canonical;this.canonical===void 0&&(this.canonical=t.canonical),this.level+=1;try{let r=(()=>{let n=hf(e,this.options);if(n)return n;let a=H(e);if(a!==null)return`\\text{${a}}`;let s=En(e);if(s!==null)return this.serializeDictionary(s);let o=Q(e);if(o!==null)return this.serializeSymbol(e,this.dictionary.ids.get(o));let l=Oc(e);if(l)return this.serializeFunction(e,this.dictionary.ids.get(l));if(x(e)!==null)return this.serializeFunction(e);this.onError([{severity:"warning",message:["syntax-error",e?JSON.stringify(e):"undefined"]}])})();return this.level-=1,this.canonical=i,r??""}catch{}return this.level-=1,this.canonical=i,""}applyFunctionStyle(e,t){return this.options.applyFunctionStyle(e,t)}groupStyle(e,t){return this.options.groupStyle(e,t)}rootStyle(e,t){return this.options.rootStyle(e,t)}fractionStyle(e,t){return this.options.fractionStyle(e,t)}logicStyle(e,t){return this.options.logicStyle(e,t)}powerStyle(e,t){return this.options.powerStyle(e,t)}numericSetStyle(e,t){return this.options.numericSetStyle(e,t)}};function mf(e){var s;let t=((s=e.match(/^([^_]+)/))==null?void 0:s[1])??"",i=Et.findIndex(o=>t===o[0]);if(i>=0)return[Et[i][1],e.substring(Et[i][0].length)];let r={zero:"0",one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",ten:"10"};if(i=Object.keys(r).findIndex(o=>e.startsWith(o)),i>=0){let o=Object.keys(r)[i];return[r[o],e.substring(o.length)]}let n=e.codePointAt(0);if(i=Et.findIndex(o=>o[2]===n),i>=0)return[Et[i][1],e.substring(1)];let a={plus:"+",minus:"-",pm:"\\pm",ast:"\\ast",dag:"\\dag",ddag:"\\ddag",hash:"\\#",bottom:"\\bot",top:"\\top",bullet:"\\bullet",circle:"\\circ",diamond:"\\diamond",times:"\\times",square:"\\square",star:"\\star"};if(i=Object.keys(a).findIndex(o=>t===o),i>=0){let o=Object.keys(a)[i];return[a[o],e.substring(o.length)]}return[t,e.substring(t.length)]}function df(e){let[t,i]=mf(e),r=[];for(;i.length>0;){let a=i.match(/^_([a-zA-Z]+)(.*)/);if(!a||!xa[a[1]])break;r.push(a[1]),i=a[2]}let n=[];for(;i.length>0;){let a=i.match(/^_([a-zA-Z]+)(.*)/);if(!a||!ya[a[1]])break;n.push(a[1]),i=a[2]}return[t,r,n,i]}function on(e,t=!0,i="auto"){let[r,n,a,s]=df(e);for(let o of n)xa[o]&&(r=xa[o](r));if(t){let o=[],l=[],u=r.match(/^([^\d].*?)(\d+)$/);for(u&&(l.push(u[2]),r=u[1]);s.length>0;)if(s.startsWith("__")){let[f,c]=on(s.substring(2),!1,"none");o.push(f),s=c}else if(s.startsWith("_")){let[f,c]=on(s.substring(1),!1,"none");l.push(f),s=c}else break;o.length>0&&(r=`${r}^{${o.join(",")}}`),l.length>0&&(r=`${r}_{${l.join(",")}}`)}for(let o of a)ya[o]&&(r=ya[o](r));if(a.length===0&&i!=="none")switch(i){case"auto":Do(r)>1&&(r=`\\mathrm{${r}}`);break;case"operator":r=`\\operatorname{${r}}`;break;case"italic":r=`\\mathit{${r}}`;break;case"upright":r=`\\mathrm{${r}}`;break}return[r,s]}function Wn(e,t="auto"){if(e===null)return null;if(Tn.test(e))return e;let i=e.match(/^(_+)(.*)/);if(i){let[a,s]=on(i[2],!0,"none");return`\\operatorname{${"\\_".repeat(i[1].length)+a+s}}`}let[r,n]=on(e,!0,t);return n.length>0?`\\operatorname{${e}}`:r}function gf(e,t){return"normal"}function bf(e,t){return"normal"}function vf(e,t){return t>2?"solidus":"radical"}function xf(e,t){if(t>3)return"inline-solidus";if(x(e)==="Divide"){let[i,r]=[nn(Ge(e)),nn(kt(e))];if(r<=2&&i>5)return"factor";if(i<=2&&r>5)return"reciprocal"}return"quotient"}function yf(e,t){return"boolean"}function Nf(e,t){return"solidus"}function _f(e,t){return"compact"}var Sf={invisibleMultiply:"",invisiblePlus:"",multiply:"\\times",missingSymbol:"\\blacksquare",applyFunctionStyle:gf,groupStyle:bf,rootStyle:vf,fractionStyle:xf,logicStyle:yf,powerStyle:Nf,numericSetStyle:_f},Fs=class Qo{constructor(t){let i=n=>{if(typeof window<"u")for(let a of n)console.warn(a.message)};this.onError=t.onError??i,this.computeEngine=t.computeEngine;let r={...t};delete r.dictionary,delete r.onError,this.options={...Go,...Zo,...Sf,...r},this._dictionaryInput=t.dictionary??Qo.getDictionary(),this._dictionary=Is(this._dictionaryInput,n=>this.onError([n]))}get dictionary(){return this._dictionaryInput}set dictionary(t){this._dictionaryInput=t,this._dictionary=Is(t,i=>this.onError([i]))}updateOptions(t){for(let i of Object.keys(this.options))i in t&&(this.options[i]=t[i]);this.serializer.updateOptions(t)}static getDictionary(t="all"){if(t==="all"){let i=[];for(let r of Object.keys(ji))ji[r]&&i.push(...ji[r]);return i}return ji[t]?Object.freeze([...ji[t]]):[]}parse(t){let i=new uf(j(t,[]),this.options,this._dictionary,this.computeEngine),r=i.parseExpression();if(!i.atEnd){let n=i.parseSyntaxError();for(r=r?["Sequence",r,n]:n;!i.atEnd;)i.nextToken()}return r??(r=["Sequence"]),this.options.preserveLatex&&(Array.isArray(r)?r={latex:t,fn:r}:typeof r=="number"?r={latex:t,num:Number(r).toString()}:typeof r=="string"?r={latex:t,sym:r}:typeof r=="object"&&r!==null&&(r.latex=t)),r??["Sequence"]}serialize(t,i){return this.serializer.serialize(t,i)}get serializer(){return this._serializer?this._serializer:(this._serializer=new pf(this.options,this._dictionary,this.onError),this._serializer)}},wf=me(de(),1),Na=me(de(),1),ci=me(de(),1);function Jo(e,t,i={}){let{contract:r=.125,step:n=1,power:a=2,atol:s=1e-16,rtol:o=s>0?0:Math.sqrt(Number.EPSILON),maxeval:l=1e6,breaktol:u=2}=i;if(!isFinite(t))return Jo(b=>e(1/b),1/t,{rtol:o,atol:s,maxeval:l,contract:Math.abs(r)>1?1/r:r,step:1/n,power:a});let f=n,c=Math.pow(1/r,a),h=e(t+f),p=[h],m=1/0,d=1;for(;d<l;){d+=1,f*=r,p.push(e(t+f));let b=c,y=1/0;for(let _=p.length-2;_>=0;_--){let S=p[_];p[_]=p[_+1]+(p[_+1]-p[_])/(b-1);let k=Math.abs(p[_]-S);y=Math.min(y,k),k<m&&(h=p[_],m=k),b*=c}if(y>u*m||!isFinite(y)||m<=Math.max(o*Math.abs(h),s))break}return[h,m]}var kf=53,yi=Math.log10(Math.pow(2,kf)),ln=Math.pow(10,-10),Ni=1e6,Qn=1e6,_a=200,Ds=new Set([2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999,5003,5009,5011,5021,5023,5039,5051,5059,5077,5081,5087,5099,5101,5107,5113,5119,5147,5153,5167,5171,5179,5189,5197,5209,5227,5231,5233,5237,5261,5273,5279,5281,5297,5303,5309,5323,5333,5347,5351,5381,5387,5393,5399,5407,5413,5417,5419,5431,5437,5441,5443,5449,5471,5477,5479,5483,5501,5503,5507,5519,5521,5527,5531,5557,5563,5569,5573,5581,5591,5623,5639,5641,5647,5651,5653,5657,5659,5669,5683,5689,5693,5701,5711,5717,5737,5741,5743,5749,5779,5783,5791,5801,5807,5813,5821,5827,5839,5843,5849,5851,5857,5861,5867,5869,5879,5881,5897,5903,5923,5927,5939,5953,5981,5987,6007,6011,6029,6037,6043,6047,6053,6067,6073,6079,6089,6091,6101,6113,6121,6131,6133,6143,6151,6163,6173,6197,6199,6203,6211,6217,6221,6229,6247,6257,6263,6269,6271,6277,6287,6299,6301,6311,6317,6323,6329,6337,6343,6353,6359,6361,6367,6373,6379,6389,6397,6421,6427,6449,6451,6469,6473,6481,6491,6521,6529,6547,6551,6553,6563,6569,6571,6577,6581,6599,6607,6619,6637,6653,6659,6661,6673,6679,6689,6691,6701,6703,6709,6719,6733,6737,6761,6763,6779,6781,6791,6793,6803,6823,6827,6829,6833,6841,6857,6863,6869,6871,6883,6899,6907,6911,6917,6947,6949,6959,6961,6967,6971,6977,6983,6991,6997,7001,7013,7019,7027,7039,7043,7057,7069,7079,7103,7109,7121,7127,7129,7151,7159,7177,7187,7193,7207,7211,7213,7219,7229,7237,7243,7247,7253,7283,7297,7307,7309,7321,7331,7333,7349,7351,7369,7393,7411,7417,7433,7451,7457,7459,7477,7481,7487,7489,7499,7507,7517,7523,7529,7537,7541,7547,7549,7559,7561,7573,7577,7583,7589,7591,7603,7607,7621,7639,7643,7649,7669,7673,7681,7687,7691,7699,7703,7717,7723,7727,7741,7753,7757,7759,7789,7793,7817,7823,7829,7841,7853,7867,7873,7877,7879,7883,7901,7907,7919]),Tf=7919;function Ko(e){if(e<=3)return{[e]:1};let t={},i=0;for(;e%2===0;)i+=1,e/=2;for(i>0&&(t[2]=i),i=0;e%3===0;)i+=1,e/=3;i>0&&(t[3]=i);let r=!1;for(;!r;){if(e===1)return t;let n=Math.sqrt(e);r=!0;for(let a=6;a<=n+6;a+=6){if(e%(a-1)===0){t[a-1]=(t[a-1]??0)+1,e/=a-1,r=!1;break}if(e%(a+1)===0){t[a+1]=(t[a+1]??0)+1,e/=a+1,r=!1;break}}}return t[e]!==void 0?t[e]+=1:t[e]=1,t}function qi(e,t){if(e>=Number.MAX_SAFE_INTEGER)return[1,e];if(e===0)return[0,0];let i=Ko(e),r=1,n=1;for(let a of Object.keys(i)){let s=parseInt(a);r=r*Math.pow(s,Math.floor(i[a]/t)),n=n*Math.pow(s,i[a]%t)}return[r,n]}function gr(e,t){if(e===0)return t;if(t===0||e===t)return e;if(!Number.isInteger(e)||!Number.isInteger(t))return NaN;for(;t!==0;)[e,t]=[t,e%t];return e<0?-e:e}function Yo(e,t){return e*t/gr(e,t)}function Xo(e){if(!Number.isInteger(e)||e<0)return NaN;let t=1;for(let i=2;i<=e;i++)t=t*i;return t}function Ef(e){if(!Number.isInteger(e)||e<0)return NaN;if(e<0)return NaN;if(e<=1)return 1;let t=e;for(;e>2;)e-=2,t*=e;return t}var Cs=7,Ps=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];function Za(e){if(e<0)return NaN;let t=Math.PI,i=e*e*e;return e*Math.log(e)-e-.5*Math.log(e)+.5*Math.log(2*t)+1/(12*e)-1/(360*i)+1/(1260*i*e*e)}function un(e){if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*un(1-e));if(e>100)return Math.exp(Za(e));e-=1;let t=Ps[0];for(let r=1;r<Cs+2;r++)t+=Ps[r]/(e+r);let i=e+Cs+.5;return Math.sqrt(2*Math.PI)*Math.pow(i,e+.5)*Math.exp(-i)*t}function N(e){if(e==null)return null;let t=e.numericValue;if(t===null)return null;if(typeof t=="number")return t;if(t instanceof T)return t.toNumber();if(Array.isArray(t)){let[i,r]=t;return typeof i=="number"&&typeof r=="number"?i/r:Number(i)/Number(r)}return!(t instanceof ci.Complex)||t.im,null}function Yt(e){if(e==null)return null;let t=e.numericValue;if(t===null)return null;if(t instanceof T)return t;if(typeof t=="number")return e.engine.bignum(t);if(Array.isArray(t)){let[i,r]=t;return typeof i=="number"&&typeof r=="number"?e.engine.bignum(i/r):e.engine.bignum(i).div(r.toString())}return!(t instanceof ci.Complex)||t.im,null}function W(e){if(e==null)return null;let t=e.numericValue;if(t===null)return null;if(typeof t=="number")return Number.isInteger(t)&&t>=-Ni&&t<=Ni?t:null;if(t instanceof T){if(t.isInteger()){let r=t.toNumber();if(r>=-Ni&&r<=Ni)return r}return null}if(e.isCanonical)return null;let i=t;if(Array.isArray(i)){let[r,n]=i,a;return typeof r=="number"&&typeof n=="number"?a=r/n:a=Number(r)/Number(n),Number.isInteger(a)&&a>=-Ni&&a<=Ni?a:null}return null}function Ki(e,t){return typeof e=="number"&&Math.abs(e)<=t||e instanceof T&&e.abs().lte(t)||e instanceof ci.Complex&&Math.abs(e.re)<=t&&Math.abs(e.im)<=t?0:e}function $s(e){let t=.254829592,i=-.284496736,r=1.421413741,n=-1.453152027,a=1.061405429,s=.3275911,o=e<0?-1:1;e=Math.abs(e);let l=1/(1+s*e),u=((((a*l+n)*l+r)*l+i)*l+t)*l;return o*(1-u*Math.exp(-e*e))}function Af(e){let t=Math.PI,i=t*t,r=i*t,n=e*e,a=e*n,s=a*n,o=s*n;return Math.sqrt(t)/2*(e+t/12*a+7*i/480*s+127*r/40320*o+4369*i*i/5806080*o*n+34807*r*i/182476800*o*n*n)}function Mf(e,t,i=.1){return(e(t-4*i)/280-4*e(t-3*i)/105+e(t-2*i)/5-4*e(t-i)/5+4*e(t+i)/5-e(t+2*i)/5+4*e(t+3*i)/105-e(t+4*i)/280)/i}function If(e,t,i,r=1e5){let n=0;if(t===-1/0&&i===1/0)for(let a=0;a<r;a++){let s=Math.random(),o=Math.tan(Math.PI*(s-.5)),l=Math.PI*(1+o*o);n+=e(o)/l}else if(t===-1/0)for(let a=0;a<r;a++){let s=Math.random(),o=i-Math.log(1-s),l=1/(1-s);n+=e(o)/l}else if(i===1/0)for(let a=0;a<r;a++){let s=Math.random(),o=t+Math.log(s),l=1/s;n+=e(o)/l}else for(let a=0;a<r;a++)n+=e(t+Math.random()*(i-t));return n/r*(i-t)}function cr(e,t,i=1){if(i===0){let a=cr(e,t,-1),s=cr(e,t,1);return a===void 0||s===void 0?NaN:Math.abs(a-s)>1e-5?NaN:(a+s)/2}let[r,n]=Jo(e,t,{step:i>0?1:-1});return r}function Of(e){if(e==="N")return[0,""];let t={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3},i=0,r=0;e=e.toUpperCase();for(let n=e.length-1;n>=0;n--){let a=t[e[n]];if(a===void 0)return[i,e.slice(n)];a<r?i-=a:i+=a,r=a}return[i,""]}function cn(e,t){if(e=e.trim(),e.length===0)return[NaN,""];if(e.startsWith("+"))return cn(e.slice(1),t);if(e.startsWith("-")){let[n,a]=cn(e.slice(1),t);return[-n,a]}let i=10;if(typeof t=="string"&&(t=t.toLowerCase()),e.startsWith("0x"))i=16,e=e.slice(2);else if(e.startsWith("0b"))i=2,e=e.slice(2);else{if(t==="roman")return Of(e);if(t==="base64"||t==="base-64")try{return[parseInt(btoa(e)),""]}catch{return[NaN,""]}else typeof t=="number"?i=t:typeof t=="string"&&(i=parseInt(t))}let r=0;for(let n=0;n<e.length;n++){let a={" ":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,"":-1,_:-1,",":-1,0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,g:16,h:17,i:18,j:19,k:20,l:21,m:22,n:23,o:24,p:25,q:26,r:27,s:28,t:29,u:30,v:31,w:32,x:33,y:34,z:35}[e[n]];if(a!==-1){if(a===void 0)return[r,e.substring(n)];if(a>=i)return[r,e.substring(n)];r=r*i+a}}return[r,""]}function Yi(e,t,i){if(e===t)return 0;let r=e.N(),n=t.N(),a=r.numericValue,s=n.numericValue;if(a===null||s===null){let u=r.sgn,f=n.sgn;return typeof u!="number"||typeof f!="number"?void 0:u===0&&f===0?0:u<0&&f>0?-1:u>0&&f<0?1:void 0}if(i??(i=e.engine.tolerance),a instanceof ci.Complex&&s instanceof ci.Complex)return Ki(a.re-s.re,i)===0&&Ki(a.im-s.im,i)===0?0:void 0;if(a instanceof ci.Complex||s instanceof ci.Complex)return;if(typeof a=="number"&&typeof s=="number")return Ki(s-a,i)===0?0:a<s?-1:1;let o=e.engine,l=o.bignum(s).sub(o.bignum(a));return Ki(l,i)===0?0:l.isPos()?1:-1}function Vs(e){if(typeof e=="number")return Number.isInteger(e)?BigInt(e):null;if(e==null||!wn(e))return null;let t=kn(e)?e.num:e;if(typeof t=="number")return Number.isInteger(t)?BigInt(t):null;if(typeof t!="string")return null;let i=t.toLowerCase().replace(/[0-9][nd]$/,"").replace(/[\u0009-\u000d\u0020\u00a0]/g,"");return i==="nan"||i==="infinity"||i==="+infinity"||i==="-infinity"||i.includes(".")?null:R(i)}function R(e){if(typeof e=="bigint")return e;if(e instanceof Bt)return R(e.toString());let t=e.toString().toLowerCase();if(t==="nan")return NaN;if(t==="infinity"||t==="+infinity")return 1/0;if(t==="-infinity")return-1/0;let i=t.match(/([^\.]+)(?:\.([0-9]+))?e(.+)$/);return i&&(t=i[1]+(i[2]??"")+"0".repeat(parseInt(i[3])-(i[2]?i[2].length:0))),BigInt(t)}function qf(e,t){for(;t!==BigInt(0);)[e,t]=[t,e%t];return e<0?-e:e}var Ff=[BigInt(4),BigInt(2),BigInt(4),BigInt(2),BigInt(4),BigInt(6),BigInt(2),BigInt(6)];function Df(e){if(e<Number.MAX_SAFE_INTEGER){let f=Ko(Number(e)),c=new Map;for(let h of Object.keys(f))c.set(R(h),f[h]);return c}let t=e,i=new Map,r=0,n=0,a=0,s=BigInt(10);for(;t%s===BigInt(0);)r+=1,a+=1,t=t/s;for(s=BigInt(5);t%s===BigInt(0);)a+=1,t=t/s;for(s=BigInt(3);t%s===BigInt(0);)n+=1,t=t/s;for(s=BigInt(2);t%s===BigInt(0);)r+=1,t=t/s;r>0&&i.set("2",r),n>0&&i.set("3",n),a>0&&i.set("5",a),s=BigInt(7);let o="",l=0;for(;s*s<t;)t%s===BigInt(0)?(o||(o=s.toString()),i.set(o,(i.get(o)??0)+1),t=t/s):(s=s+Ff[l],o="",l=l<7?l+1:0);t!==BigInt(1)&&i.set(t.toString(),(i.get(t.toString())??0)+1);let u=new Map;for(let[f,c]of i)u.set(R(f),c);return u}function fr(e,t){let i=Df(e),r=BigInt(1),n=BigInt(1),a=R(t);for(let[s,o]of i){let l=R(o);r=r*s**(l/a),n=n*s**(l%a)}return[r,n]}function Se(e){return e!==null&&Array.isArray(e)}function re(e){return e!==null&&Array.isArray(e)&&typeof e[0]=="number"}function _e(e){return e!==null&&Array.isArray(e)&&typeof e[0]=="bigint"}function Gt(e){return e[0]==0}function Ne(e){return e[0]===e[1]}function Cf(e){return e[1]===1||e[1]===BigInt(1)}function Ha(e){return e[0]===-e[1]}function mt(e){return Number(e[0])}function pi(e){return Number(e[1])}function zs(e){return e[0]<0}function at(e){return[-e[0],e[1]]}function Li(e){return e[0]<0?[-e[1],-e[0]]:[e[1],e[0]]}function X(e){let t=e.numericValue;if(Array.isArray(t))return t;if(t!==null){if(typeof t=="number"&&Number.isInteger(t))return t>1e9||t<-1e9?[R(t),BigInt(1)]:[t,1];if(t instanceof T&&t.isInteger())return[R(t),BigInt(1)]}}function Sa(e,t){if(Array.isArray(t)||t.numericValue!==null&&t.numericValue instanceof Na.Complex,typeof e[0]=="number"&&!Number.isFinite(e[0]))return e;let i=Array.isArray(t)?t:t.numericValue;if(i===null)return e;if(Array.isArray(i)){if(_e(i))return e=[BigInt(e[0]),BigInt(e[1])],[i[1]*e[0]+i[0]*e[1],i[1]*e[1]];if(!Number.isFinite(i[0]))return i;if(_e(e)){let r=[BigInt(i[0]),BigInt(i[1])];return[r[1]*e[0]+r[0]*e[1],r[1]*e[1]]}return[i[1]*e[0]+i[0]*e[1],i[1]*e[1]]}return i instanceof T?i.isNaN()?[Number.NaN,1]:i.isFinite()?(i.isInteger(),re(e)&&(e=[BigInt(e[0]),BigInt(e[1])]),[e[0]+e[1]*R(i.toString()),e[1]]):[i.isNegative()?-1/0:1/0,1]:i instanceof Na.Complex?[Number.NaN,1]:Number.isFinite(i)?re(e)?[e[0]+e[1]*i,e[1]]:[e[0]+e[1]*R(i),e[1]]:[i,1]}function ee(e,t){if(Array.isArray(t)||t.numericValue!==null&&t instanceof Na.Complex,Array.isArray(t))return re(e)&&re(t)?[e[0]*t[0],e[1]*t[1]]:(re(e)&&(e=[R(e[0]),R(e[1])]),re(t)&&(t=[R(t[0]),R(t[1])]),[e[0]*t[0],e[1]*t[1]]);let i=t.numericValue;return i!==null&&typeof i=="number"?re(e)?[e[0]*i,e[1]]:[e[0]*R(i),e[1]]:i instanceof T?(i.isInteger(),re(e)?[R(i.toString())*R(e[0]),R(e[1])]:[R(i.toString())*e[0],e[1]]):Array.isArray(i)?_e(i)?[i[0]*R(e[0]),i[1]*R(e[1])]:re(e)?[e[0]*i[0],e[1]*i[1]]:[e[0]*R(i[0]),e[1]*R(i[1])]:e}function Pf(e,t){return ee(e,Li(t))}function wa(e,t){if(t===0)return[1,1];if(t<0&&(e=Li(e),t=-t),t===1)return e;if(re(e))return[Math.pow(e[0],t),Math.pow(e[1],t)];let i=R(t);return[e[0]**i,e[1]**i]}function $f(e){let t=Math.sqrt(Number(e[0])),i=Math.sqrt(Number(e[1]));if(Number.isInteger(t)&&Number.isInteger(i))return[t,i]}function It(e){if(re(e)){if(e[0]===1||e[1]===1)return e;if(e[1]<0&&(e=[-e[0],-e[1]]),!Number.isFinite(e[1]))return[0,1];let i=gr(e[0],e[1]);return i<=1?e:[e[0]/i,e[1]/i]}if(e[0]===BigInt(1)||e[1]===BigInt(1))return e;e[1]<0&&(e=[-e[0],-e[1]]);let t=qf(e[0],e[1]);return t<=1?e:[e[0]/t,e[1]/t]}function Vf(e){if(!Number.isFinite(e)||e%1===0)return e;let t=1e-15,i=Math.floor(e),r=1,n=0,a=i,s=1;for(;e-i>t*s*s;){e=1/(e-i),i=Math.floor(e);let o=r;r=a;let l=n;n=s,a=o+i*r,s=l+i*n}return[a,s]}function zf(e){if(_e(e)){let[o,l]=e,[u,f]=fr(o,2),[c,h]=fr(l,2);return[It([u,c]),It([f,h])]}let[t,i]=e,[r,n]=qi(t,2),[a,s]=qi(i,2);return[It([r,a]),It([n,s])]}function Lf(e){if(typeof e=="number"&&!isNaN(e))return isFinite(e)?Number.isInteger(e)?e>0?"PositiveIntegers":e<0?"NegativeIntegers":"Integers":e>0?"PositiveNumbers":e<0?"NegativeNumbers":"RealNumbers":"ExtendedRealNumbers";if(e instanceof T)return e.isNaN()?"Numbers":e.isFinite()?e.isInteger()?e.isPositive()?"PositiveIntegers":e.isNegative()?"NegativeIntegers":"Integers":e.isPositive()?"PositiveNumbers":e.isNegative()?"NegativeNumbers":"RealNumbers":"ExtendedRealNumbers";if(e instanceof wf.Complex){let t=e;return t.im,t.re===0?"ImaginaryNumbers":"ComplexNumbers"}return Se(e)?"RationalNumbers":"Numbers"}function Wa(e){e.ctor;let t=e.engine,i=e.params,r=[],n=[],a,s=t.domain(i[i.length-1]);for(let o of i.slice(0,-1))if(x(o)==="OptArg"){if(n.length>0)throw Error(`Unexpected multiple OptArg in domain ${e}`);if(a)throw Error(`Unexpected OptArg after VarArg in domain ${e}`);if(ae(o)===0)throw Error(`Unexpected empty OptArg in domain ${e}`);for(let l of I(o)){if(x(l)==="OptArg")throw Error(`Unexpected OptArg of OptArg in domain ${e}`);if(x(l)==="VarArg")throw Error(`Unexpected superfluous OptArg of VarArg in domain ${e}`);n.push(t.domain(l))}}else if(x(o)==="VarArg"){let l=I(o);if(l.length!==1)throw Error(`Invalid VarArg in domain ${e}`);if(x(l[0])==="OptArg")throw Error(`Unexpectedf VarArg of OptArg in domain ${e}`);if(x(l[0])==="VarArg")throw Error(`Unexpected VarArg of VarArg in domain ${e}`);a=t.domain(l[0])}else{if(n.length>0)throw Error(`Unexpected required parameter after OptArg in domain ${e}`);if(a)throw Error(`Unexpected required parameter after VarArg in domain ${e}`);r.push(t.domain(o))}return[r,n,a,s]}function ka(e){let[t,i,r,n]=Wa(e);return{params:t.map(a=>a.json),optParams:i.map(a=>a.json),restParam:r==null?void 0:r.json,result:n.json}}function el(e,t){let i=[...t.params];return t.optParams.length>0&&i.push(["OptArg",...t.optParams]),t.restParam&&i.push(["VarArg",t.restParam]),typeof t.result=="function"?i.push(t.result(e,[])??e.symbol("Undefined")):i.push(t.result),e.domain(["FunctionOf",...i])}function Qa(e){var t,i,r,n,a;return e.string!==null||(((i=(t=e.symbolDefinition)==null?void 0:t.value)==null?void 0:i.string)??null)!==null?!0:((a=e.functionDefinition??((n=(r=e.symbolDefinition)==null?void 0:r.value)==null?void 0:n.functionDefinition))==null?void 0:a.iterator)!==void 0}function tl(e){var t,i,r,n,a;return e.string!==null||(((i=(t=e.symbolDefinition)==null?void 0:t.value)==null?void 0:i.string)??null)!==null?!0:((a=e.functionDefinition??((n=(r=e.symbolDefinition)==null?void 0:r.value)==null?void 0:n.functionDefinition))==null?void 0:a.at)!==void 0}function Ee(e){var i,r,n,a,s;if(e.string!==null||(((r=(i=e.symbolDefinition)==null?void 0:i.value)==null?void 0:r.string)??null)!==null)return!0;let t=e.functionDefinition??((a=(n=e.symbolDefinition)==null?void 0:n.value)==null?void 0:a.functionDefinition);return t?t.at!==void 0&&Number.isFinite(((s=t.size)==null?void 0:s.call(t,e))??1/0):!1}function*ce(e){let t=Rf(e);if(!t){yield e;return}let i=e.engine.iterationLimit,r=0;for(;;){let{done:n,value:a}=t.next();if(n)return;if(r++>i){yield e.engine.error("iteration-limit-exceeded");return}yield a}}function Rf(e){var r,n,a,s;let t=e.functionDefinition??((n=(r=e.symbolDefinition)==null?void 0:r.value)==null?void 0:n.functionDefinition);if(t!=null&&t.iterator)return t.iterator(e);let i=e.string??((s=(a=e.symbolDefinition)==null?void 0:a.value)==null?void 0:s.string)??null;if(i!==null){if(i.length===0)return{next:()=>({done:!0,value:void 0})};let o=0;return{next:()=>({value:e.engine.string(i.charAt(o++)),done:o>i.length})}}}function Bf(e,t){var n,a;let i=e.functionDefinition??((a=(n=e.symbolDefinition)==null?void 0:n.value)==null?void 0:a.functionDefinition);if(i!=null&&i.at)return i.at(e,t);let r=e.string;if(r)return t<1?e.engine.string(r.charAt(r.length+t)):e.engine.string(r.charAt(t-1))}function De(e,t){if(!t||e.every(r=>!r.ops||r.head!==t))return e;let i=[];for(let r of e)!r.ops||r.head!==t?i.push(r):i.push(...De(r.ops,t));return i.length,e.length,i.length===e.length?e:i}function Ae(e){if(e.every(i=>i.head!=="Sequence"&&i.head!=="Delimiter"))return e;let t=[];for(let i of e)if(!i.isValid)t.push(i);else if(i.head==="Delimiter")if(i.op1.head==="Sequence"){let r=i.op1.ops??[];r.length===0?t.push(i.engine.box(["Tupple"])):t.push(...Ae(r))}else t.push(i.op1);else i.head==="Sequence"?i.ops&&t.push(...i.ops):t.push(i);return t}function il(e,t){return t===void 0?e._fn("Tuple",[]):t.head==="Delimiter"?il(e,t.op1):t.head==="Sequence"?t:t.ops?e._fn("Tuple",t.ops):t}var fn=me(de(),1);function br(e){return typeof e=="object"&&e!==null&&"engine"in e}function K(e){return e.numericMode==="bignum"||e.numericMode==="auto"}function Fe(e){return e.numericMode==="auto"||e.numericMode==="complex"}function Jn(e){return typeof e=="string"?e.startsWith("$")&&e.endsWith("$"):!1}function Ja(e){return typeof e!="string"?null:e.startsWith("$$")&&e.endsWith("$$")?e.slice(2,-2):e.startsWith("$")&&e.endsWith("$")?e.slice(1,-1):null}function st(e){let t=0;for(let i=0;i<e.length;i++)t=Math.imul(31,t)+e.charCodeAt(i)|0;return Math.abs(t)}function Ta(e){let t=e.numericValue;return typeof t=="number"&&Number.isInteger(t)||t instanceof T&&t.isInteger()?R(t):null}function Ls(e){if(e.head==="Negate")return[-1,e.op1];let t=e.numericValue;if(t===null)return[1,e];let i=e.engine;return typeof t=="number"&&t<0?[-1,i.number(-t)]:t instanceof T&&t.isNegative()?[-1,i.number(t.neg())]:t instanceof fn.Complex&&t.re<0?[-1,i.number(i.complex(-t.re,-t.im))]:re(t)&&t[0]<0?[-1,i.number([-t[0],t[1]])]:_e(t)&&t[0]<0?[-1,i.number([-t[0],t[1]])]:[1,e]}function Uf(e,t,i,r){let n=e.numericValue,a=e.engine;return typeof n=="number"?K(a)&&i?a.chop(i(a.bignum(n))):a.chop(t(n)):n instanceof T?a.chop((i==null?void 0:i(n))??t(n.toNumber())):re(n)?!K(a)||!i?a.chop(t(n[0]/n[1])):a.chop(i(a.bignum(n[0]).div(n[1]))):_e(n)?i?a.chop(i(a.bignum(n[0]).div(a.bignum(n[1])))):a.chop(t(Number(n[0])/Number(n[1]))):n instanceof fn.Complex?!r||!Fe(a)?NaN:a.chop(r(n)):NaN}function L(e,t,i,r){if(((e==null?void 0:e.numericValue)??null)!==null)return e.engine.number(Uf(e,t,i,r))}function jf(e,t,i,r,n){e.numericValue!==null&&t.numericValue;let a=e.engine,s=e.numericValue;re(s)&&(s=s[0]/s[1]);let o=t.numericValue;if(re(o)&&(o=o[0]/o[1]),!K(a)&&typeof s=="number"&&typeof o=="number")return i(s,o);let l;s instanceof T?l=s:_e(s)?l=a.bignum(s[0]).div(a.bignum(s[1])):s!==null&&typeof s=="number"&&(l=a.bignum(s));let u;return o instanceof T?u=o:_e(o)?l=a.bignum(o[0]).div(a.bignum(o[1])):o!==null&&typeof o=="number"&&(u=a.bignum(o)),l&&u?(r==null?void 0:r(l,u))??i(l.toNumber(),u.toNumber()):s instanceof fn.Complex||o instanceof fn.Complex?!n||!Fe(a)?NaN:n(a.complex(s??(l==null?void 0:l.toNumber())??NaN),a.complex(o??(u==null?void 0:u.toNumber())??NaN)):NaN}function hn(e,t,i,r,n){if(!(e.numericValue===null||t.numericValue===null))return e.engine.number(jf(e,t,i,r,n))}function ui(e,t,i){return e==="all"?!0:e==="none"?!1:e==="first"?i===0:e==="rest"?i!==0:e==="last"?i===t:e==="most"?i!==t:!0}function Pe(e){return e.every(t=>t.isCanonical)?e:e.map(t=>t.canonical)}function et(e,t,i){if(t=Pe(t),t=Ae(t),!e.strict||t.length===i)return t;let r=[...t.slice(0,i)],n=Math.min(i,t.length);for(;n<i;)r.push(e.error("missing")),n+=1;for(;n<t.length;)r.push(e.error("unexpected-argument",t[n])),n+=1;return r}function rt(e,t,i){var o,l,u,f;let r=typeof i=="number"?i:i==null?void 0:i.count,n=typeof i=="number"||((i==null?void 0:i.flatten)??!0);if(t=Pe(t),n&&(t=Ae(t)),typeof n=="string"&&De(t,n),!e.strict){for(let c of t)Ee(c)||c.infer(e.Numbers);return t}let a=!0;r??(r=t.length);let s=[];for(let c=0;c<=Math.max(r-1,t.length-1);c++){let h=t[c];if(c>r-1)a=!1,s.push(e.error("unexpected-argument",h));else if(h===void 0)a=!1,s.push(e.error("missing"));else if(h.symbol&&!e.lookupSymbol(h.symbol)&&!e.lookupFunction(h.symbol))s.push(h);else if(h.isNumber||(o=h.domain)!=null&&o.isNumber)s.push(h);else if(!h.isValid)a=!1,s.push(h);else if(!h.domain)s.push(h);else if(Ee(h)){for(let p of ce(h))if(!p.isNumber&&!((l=p.domain)!=null&&l.isNumber)){a=!1;break}a?s.push(h):s.push(e.domainError("Numbers",h.domain,h))}else(u=h.symbolDefinition)!=null&&u.inferredDomain&&h.domain.isCompatible(e.Numbers,"contravariant")||(f=h.functionDefinition)!=null&&f.signature.inferredSignature&&h.domain.isCompatible(e.Numbers,"contravariant")?s.push(h):(a=!1,s.push(e.domainError("Numbers",h.domain,h)))}if(a)for(let c of s)if(Ee(c))for(let h of ce(c))h.infer(e.Numbers);else c.infer(e.Numbers);return s}function ht(e,t,i){return t==null?e.error("missing"):i===void 0?e.error("unexpected-argument",t):(t=t.canonical,t.head==="Sequence"&&(t=t.op1),!t.isValid||!t.domain||t.domain.isCompatible(i)?t:e.domainError(i,t.domain,t))}function Gf(e,t){return t==null?e.error("missing"):(t=t.canonical,!t.isValid||t.isPure?t:e.error("expected-pure-expression",t))}function rl(e,t,i){if(t.length===i.length&&t.every((n,a)=>!n.domain||n.domain.isCompatible(i[a])))return t;let r=[];for(let n=0;n<=i.length-1;n++)r.push(ht(e,t[n],i[n]));for(let n=i.length;n<=t.length-1;n++)r.push(e.error("unexpected-argument",t[n]));return r}function Zf(e,t,i,r,n,a,s){var f,c,h,p,m;if(!e.strict)return null;let o=[],l=!0,u=0;for(let d of n){let b=t[u++];if(!b){o.push(e.error("missing")),l=!1;continue}if(ui(i,n.length,u-1)){o.push(b);continue}if(!b.isValid){o.push(b),l=!1;continue}if(!b.domain){o.push(b);continue}if(r&&Ee(b)){o.push(b);continue}if((f=b.symbolDefinition)!=null&&f.inferredDomain&&b.domain.isCompatible(d,"contravariant")){o.push(b);continue}if((c=b.functionDefinition)!=null&&c.signature.inferredSignature&&b.domain.isCompatible(d,"contravariant")){o.push(b);continue}if(!b.domain.isCompatible(d)){o.push(e.domainError(d,b.domain,b)),l=!1;continue}o.push(b)}for(let d of a){let b=t[u];if(!b)break;if(ui(i,n.length,u)){o.push(b);continue}if(!b.isValid){o.push(b),l=!1,u+=1;continue}if(!b.domain){o.push(b),u+=1;continue}if(r&&Ee(b)){o.push(b);continue}if((h=b.symbolDefinition)!=null&&h.inferredDomain&&b.domain.isCompatible(d,"contravariant")){o.push(b);continue}if(!b.domain.isCompatible(d)){o.push(e.domainError(d,b.domain,b)),l=!1,u+=1;continue}o.push(b),u+=1}if(s)for(let d of t.slice(u)){if(u+=1,ui(i,n.length,u-1)){o.push(d);continue}if(!d.isValid){o.push(d),l=!1;continue}if(!d.domain){o.push(d);continue}if(r&&Ee(d)){o.push(d);continue}if((p=d.symbolDefinition)!=null&&p.inferredDomain&&d.domain.isCompatible(s,"contravariant")){o.push(d);continue}if(!d.domain.isCompatible(s)){o.push(e.domainError(s,d.domain,d)),l=!1;continue}o.push(d)}if(u<t.length)for(let d of t.slice(u))o.push(e.error("unexpected-argument",d)),l=!1;if(!l)return o;u=0;for(let d of n)ui(i,n.length,u)||(!r||!Ee(t[u]))&&t[u].infer(d),u+=1;for(let d of a)(!r||!Ee(t[u]))&&((m=t[u])==null||m.infer(d)),u+=1;if(s)for(let d of t.slice(u))ui(i,n.length,u)||(!r||!Ee(d))&&d.infer(s),u+=1;return null}var Hf={Congruent:{commutative:!1,complexity:11e3,numeric:!0,signature:{simplify:(e,t)=>{if(!(t.length<3))return e._fn("Equal",[e.box(["Mod",t[0],t[2]]).simplify(),e.box(["Mod",t[1],t[2]]).simplify()]).simplify()},evaluate:(e,t)=>{if(t.length<3)return;let[i,r,n]=t,a=i.value,s=r.value,o=n.value;if(typeof a=="number"&&typeof s=="number"&&typeof o=="number")return a%o===s%o?e.True:e.False}}},IsSame:{description:"Compare two expressions for structural equality",hold:"all",signature:{domain:"RelationalOperators",evaluate:(e,t)=>{if(t.length!==2)return;let[i,r]=t;return i.isSame(r)===!0?e.True:e.False}}},Equal:{commutative:!0,complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"Equal",t),evaluate:(e,t)=>{if(t.length<2)return e.True;let i;for(let r of t)if(!i)i=r;else if(i.isEqual(r)!==!0)return e.False;return e.True}}},NotEqual:{wikidata:"Q28113351",commutative:!0,complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"NotEqual",t),evaluate:(e,t)=>{if(t.length<2)return e.False;let i;for(let r of t)if(!i)i=r;else if(i.isEqual(r)===!0)return e.False;return e.True}}},Less:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"Less",t),evaluate:(e,t)=>{if(t.length<2)return e.True;let i;for(let r of t){if(!r.isNumber)return;if(!i)i=r;else{let n=e.box(["Subtract",r,i]).N().sgn;if(n==null)return;if(n<=0)return e.False;i=r}}return e.True}}},NotLess:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"Less",t)])}},Greater:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"Less",t.reverse()),evaluate:(e,t)=>{if(t.length<2)return e.True;let i;for(let r of t){if(!r.isNumber)return;if(!i)i=r;else{let n=e.box(["Subtract",r,i]).N().sgn;if(n==null)return;if(n>=0)return e.False;i=r}}return e.True}}},NotGreater:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[e._fn("Greater",t)])}},LessEqual:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"LessEqual",t),evaluate:(e,t)=>{if(t.length<2)return e.True;let i;for(let r of t){if(!r.isNumber)return;if(!i)i=r;else{let n=e.box(["Subtract",r,i]).N().sgn;if(n==null)return;if(n<0)return e.False;i=r}}return e.True}}},NotLessNotEqual:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"LessEqual",t)])}},GreaterEqual:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"LessEqual",t.reverse()),evaluate:(e,t)=>{if(t.length<2)return e.True;let i;for(let r of t){if(!r.isNumber)return;if(!i)i=r;else{let n=e.box(["Subtract",r,i]).N().sgn;if(n==null)return;if(n>0)return e.False;i=r}}return e.True}}},NotGreaterNotEqual:{complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"GreaterEqual",t)])}},TildeFullEqual:{description:"Indicate isomorphism, congruence and homotopic equivalence",signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"TildeFullEqual",t)}},NotTildeFullEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"TildeFullEqual",t)])}},TildeEqual:{description:"Approximately or asymptotically equal",complexity:11e3,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"TildeEqual",t)}},NotTildeEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"TildeEqual",t)])}},Approx:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"Approx",t)}},NotApprox:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"Approx",t)])}},ApproxEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"ApproxEqual",t)}},NotApproxEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"ApproxEqual",t)])}},ApproxNotEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"ApproxNotEqual",t)}},NotApproxNotEqual:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"ApproxNotEqual",t)])}},Precedes:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"Precedes",t)}},NotPrecedes:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"Precedes",t)])}},Succeeds:{signature:{domain:"RelationalOperators",canonical:(e,t)=>ie(e,"Succeeds",t)}},NotSucceeds:{complexity:11100,signature:{domain:"RelationalOperators",canonical:(e,t)=>e._fn("Not",[ie(e,"Succeeds",t)])}}};function ie(e,t,i){i=De(Ae(Pe(i)),t);let r=[],n=[];for(let a of i)dr(a)?(r.push(a),n.push(a.ops[a.ops.length-1])):n.push(a);return n=n.map(a=>Gf(e,a)),r.length===0?e._fn(t,n):e._fn("And",[e._fn(t,n),...r])}function Wf(e){let t=e.head;return typeof t!="string"?!1:["Equal","Less","LessEqual","Greater","GreaterEqual"].includes(t)}function Lr(e,t,i){let r=[];for(let n of t){let a=Ka(n,e,i);a!==null&&(r.some(s=>s.isEqual(a))||r.push(a))}return r}function An(e,t){let i=new Set;for(let{match:r,replace:n,condition:a,priority:s,id:o}of t){let l;if(typeof a=="string"){let u=Ja(a);if(u){let f=e.parse(u,{canonical:!1});l=(c,h)=>{var p;return((p=f.subs(c).evaluate())==null?void 0:p.symbol)==="True"}}}else l=a;i.add({match:e.box(r,{canonical:!1}),replace:typeof n=="function"?n:e.box(n,{canonical:!1}),priority:s??0,condition:l,id:o??e.box(r,{canonical:!1}).toString()+(typeof n=="function"?"  ->  function":"  ->  "+e.box(n,{canonical:!1}).toString())})}return i}function Ka(e,t,i,r){let{match:n,replace:a,condition:s,id:o}=e,l=!1;if(t.ops&&(r!=null&&r.recursive)){let f=t.engine,c=t.ops.map(h=>{let p=Ka(e,h,{},r);return p&&(l=!0),p??h});l&&(t=f.function(t.head,c,{canonical:!1}))}let u=t.match(n,{substitution:i,...r});return u===null?l?t:null:typeof s=="function"&&!s(u,t.engine)?null:typeof a=="function"?a(t,u):a.subs(u,{canonical:t.isCanonical})}function nl(e,t,i){let r=(i==null?void 0:i.iterationLimit)??1,n=0,a=(i==null?void 0:i.once)??!1;t instanceof Set||(t=e.engine.rules(Array.isArray(t)?t:[t]));let s=!1,o=!1;try{for(;!s&&n<r;){s=!0;for(let l of t){let u=Ka(l,e,{},i);if(u!==null&&u!==e){if(a)return u;s=!1,o=!0,e=u}}n+=1}}catch(l){console.error(l)}return o?e:null}var Qf=me(de(),1),Mn=["InvalidDomain","DictionaryOf","FunctionOf","ListOf","TupleOf","Intersection","Union","OptArg","VarArg"],Kn={Functions:["FunctionOf",["VarArg","Anything"],"Anything"],NumericFunctions:["FunctionOf","Numbers",["VarArg","Numbers"],"Numbers"],RealFunctions:["FunctionOf","ExtendedRealNumbers",["VarArg","ExtendedRealNumbers"],"ExtendedRealNumbers"],LogicOperators:["FunctionOf","Booleans",["VarArg","Booleans"],"Booleans"],Predicates:["FunctionOf","Anything",["VarArg","Anything"],"Booleans"],RelationalOperators:["FunctionOf","Anything","Anything","Booleans"]},Ut={Anything:[],Values:"Anything",Domains:"Anything",Void:"NothingDomain",NothingDomain:["Booleans","Strings","Symbols","Tuples","Lists","Dictionaries","ImaginaryNumbers","TranscendentalNumbers","PositiveIntegers","NegativeIntegers","NonPositiveIntegers","NonNegativeIntegers","PositiveNumbers","NegativeNumbers","NonPositiveNumbers","NonNegativeNumbers","LogicOperators","RelationalOperators"],Booleans:"Values",Strings:"Values",Symbols:"Values",Collections:"Values",Lists:"Collections",Dictionaries:"Collections",Sequences:"Collections",Tuples:"Collections",Sets:"Collections",Functions:"Anything",Predicates:"Functions",LogicOperators:"Predicates",RelationalOperators:"Predicates",NumericFunctions:"Functions",RealFunctions:"NumericFunctions",Numbers:"Values",ExtendedComplexNumbers:"Numbers",ComplexNumbers:"ExtendedComplexNumbers",ImaginaryNumbers:"ComplexNumbers",ExtendedRealNumbers:"ExtendedComplexNumbers",RealNumbers:["ComplexNumbers","ExtendedRealNumbers"],PositiveNumbers:"NonNegativeNumbers",NonNegativeNumbers:"RealNumbers",NonPositiveNumbers:"NegativeNumbers",NegativeNumbers:"RealNumbers",TranscendentalNumbers:"RealNumbers",AlgebraicNumbers:"RealNumbers",RationalNumbers:"AlgebraicNumbers",Integers:"RationalNumbers",PositiveIntegers:"NonNegativeIntegers",NonNegativeIntegers:"Integers",NonPositiveIntegers:"NegativeIntegers",NegativeIntegers:"Integers"},Gi;function In(e){return e?Ut[e]!==void 0:!1}function it(e){if(Gi||(Gi={},it("Void")),Gi[e])return Array.from(Gi[e]);let t=[];if(typeof e!="string"||!Ut[e]){if(!Array.isArray(e))throw Error(`Unknown domain literal ${e}`);if(!Mn.includes(e[0]))throw Error(`Unknown domain constructor ${e[0]}`);return e[0]==="FunctionOf"?it("Functions"):e[0]==="TupleOf"?it("Tuples"):e[0]==="ListOf"?it("Lists"):e[0]==="DictionaryOf"?it("Dictionaries"):e[0]==="OptArg"||e[0]==="VarArg"?it(e[1]):e[0]==="Literal"?["Anything"]:e[0]==="Union"?["Anything"]:e[0]==="Intersection"?["Anything"]:["Anything"]}if(typeof Ut[e]=="string")t=[Ut[e],...it(Ut[e])];else if(Array.isArray(Ut[e]))for(let i of Ut[e])t.push(i),t.push(...it(i));return Gi[e]=new Set(t),t}function Jf(){let e={};for(let t of Object.keys(Ut))e[t]={domain:"Domains",value:["Domain",t]};e.InvalidDomain={signature:{domain:["FunctionOf","Domains","Domains"],canonical:(t,i)=>t.domain(["InvalidDomain",i[0]])}};for(let t of["DictionaryOf","FunctionOf","ListOf","TupleOf"])e[t]={signature:{domain:["FunctionOf",["VarArg","Domains"],"Domains"],canonical:(i,r)=>i.domain([t,...r])}};for(let t of["OptArg","VarArg"])e[t]={signature:{domain:["FunctionOf","Domains","Domains"],canonical:(i,r)=>i.domain([t,r[0]])}};return e}var Kf=me(de(),1);function al(e){var o;if(!e)return;let t=e.engine,i=[],r=((o=e.ops)==null?void 0:o.length)==3,n=e.ops[0].ops[0].ops,a=(n==null?void 0:n.length)??0,s=null;if(!(r&&(s=e.ops[2].ops[0].ops,(n==null?void 0:n.length)!=(s==null?void 0:s.length)))){for(let l=0;l<a;l++){let u,f,c=null,h=null;f=n[l].canonical,n&&n[l].head==="Equal"&&(f=n[l].op1.canonical,c=n[l].op2.canonical),s&&(h=s[l].canonical),h&&c?u=Ei(t.tuple([f,c,h])):h?u=Ei(t.tuple([f,t.One,h])):c?u=Ei(t.tuple([f,c])):u=Ei(f),u&&i.push(u)}return i}}function Ei(e){var a,s;if(!e)return;let t=e.engine,i=null,r=null,n=null;return e.head!=="Tuple"&&e.head!=="Triple"&&e.head!=="Pair"&&e.head!=="Single"?i=e:(i=e.ops[0]??null,r=((a=e.ops[1])==null?void 0:a.canonical)??null,n=((s=e.ops[2])==null?void 0:s.canonical)??null),i.head==="Hold"&&(i=i.op1),i.symbol&&(t.declare(i.symbol,{domain:"Integers"}),i.bind()),r&&r.isFinite&&(r=ht(t,r,"Integers")),n&&n.isFinite&&(n=ht(t,n,"Integers")),r&&n?t.tuple([i,r,n]):n?t.tuple([i,t.One,n]):r?t.tuple([i,r]):i}function On(e){let t=1,i=t+Qn,r,n=!0;if(e&&(e.head==="Tuple"||e.head==="Triple"||e.head==="Pair"||e.head==="Single")){if(r=(e.op1.head==="Hold"?e.op1.op1.symbol:e.op1.symbol)??"Nothing",t=W(e.op2)??1,Number.isFinite(t)||(n=!1),e.op3.isNothing||e.op3.isInfinity)n=!1;else{let a=W(e.op3);a===null?n=!1:(i=a,Number.isFinite(i)||(n=!1))}!n&&Number.isFinite(t)&&(i=t+Qn)}else e&&(r=(e.head==="Hold"?e.op1.symbol:e.symbol)??"Nothing",t=1,i=t+Qn);return[r,t,i,n]}function pn(e,t){return e.flatMap(i=>t.map(r=>[i,r]))}function Ht(e,t){return Array.from({length:t-e+1},(i,r)=>e+r)}var Yf={Add:["+",11],Negate:["-",14],Subtract:["-",11],Multiply:["*",12],Divide:["/",13],Equal:["===",8],NotEqual:["!==",8],LessEqual:["<=",9],GreaterEqual:[">=",9],Less:["<",9],Greater:[">",9],And:["&&",4],Or:["||",3],Not:["!",14]},Xf={Abs:"Math.abs",Add:(e,t)=>e.length===1?t(e[0]):`(${e.map(i=>t(i)).join(" + ")})`,Arccos:"Math.acos",Arcosh:"Math.acosh",Arsin:"Math.asin",Arsinh:"Math.asinh",Arctan:"Math.atan",Artanh:"Math.atanh",Ceiling:"Math.ceil",Chop:"_SYS.chop",Cos:"Math.cos",Cosh:"Math.cosh",Exp:"Math.exp",Floor:"Math.floor",Gamma:"_SYS.gamma",GCD:"_SYS.gcd",LCM:"_SYS.lcm",Limit:(e,t)=>`_SYS.limit(${t(e[0])}, ${t(e[1])})`,Ln:"Math.log",List:(e,t)=>`[${e.map(i=>t(i)).join(", ")}]`,Log:(e,t)=>e.length===1?`Math.log(${t(e[0])})`:`(Math.log(${t(e[0])}) / Math.log(${t(e[1])}))`,LogGamma:"_SYS.lngamma",Lb:"Math.log2",Max:"Math.max",Min:"Math.min",Power:(e,t)=>{let i=e[0];if(i===null)throw new Error("Power: no argument");let r=N(e[1]);return r===.5?`Math.sqrt(${t(i)})`:r===1/3?`Math.cbrt(${t(i)})`:r===1?t(i):r===-1?`1 / (${t(i)})`:r===-.5?`1 / Math.sqrt(${t(i)})`:`Math.pow(${t(i)}, ${t(e[1])})`},Range:(e,t)=>{if(e.length===0)return"[]";if(e.length===1)return`Array.from({length: ${t(e[0])}}, (_, i) => i)`;let i=t(e[0]),r=t(e[1]),n=e[2]?t(e[2]):"1";if(i===null)throw new Error("Range: no start");if(r===null&&(r=i,i="1"),n==="0")throw new Error("Range: step cannot be zero");if(parseFloat(n)===1){let a=parseFloat(r),s=parseFloat(i);return a!==null&&s!==null?a-s<50?`[${Array.from({length:a-s+1},(o,l)=>s+l).join(", ")}]`:`Array.from({length: ${a-s+1} 
        }, (_, i) => ${i} + i)`:`Array.from({length: ${r} - ${i} + 1
      }, (_, i) => ${i} + i)`}return`Array.from({length: Math.floor((${r} - ${i}) / ${n}) + 1}, (_, i) => ${i} + i * ${n})`},Root:(e,t)=>{let i=e[0];if(i===null)throw new Error("Root: no argument");let r=e[1];return r===null?`Math.sqrt(${t(i)})`:`Math.pow(${t(i)}, 1 / (${t(r)}))`},Random:"Math.random",Round:"Math.round",Square:(e,t)=>{let i=e[0];if(i===null)throw new Error("Square: no argument");return`Math.pow(${t(i)}, 2)`},Sgn:"Math.sign",Sin:"Math.sin",Sinh:"Math.sinh",Sqrt:"Math.sqrt",Tan:"Math.tan",Tanh:"Math.tanh"},eh=class extends Function{constructor(e){return super("_SYS","_",`return ${e}`),this.sys={factorial:Xo,gamma:un,lngamma:Za,gcd:gr,lcm:Yo,chop:Ki,limit:cr},new Proxy(this,{apply:(t,i,r)=>super.apply(i,[this.sys,...r]),get:(t,i)=>i==="toString"?()=>e:t[i]})}};function th(e,t){let i=fe(e,t);return new eh(i)}function ih(e){let t=e.unknowns;return th(e,{operators:i=>Yf[i],functions:i=>Xf[i],var:i=>{let r={Pi:"Math.PI",ExponentialE:"Math.E",NaN:"Number.NaN",ImaginaryUnit:"Number.NaN",Half:"0.5",MachineEpsilon:"Number.EPSILON",GoldenRatio:"((1 + Math.sqrt(5)) / 2)",CatalanConstant:"0.91596559417721901",EulerGamma:"0.57721566490153286"}[i];if(r!==void 0)return r;if(t.includes(i))return`_.${i}`},string:i=>JSON.stringify(i),number:i=>i.toString(),indent:0,ws:i=>i??""})}function sl(e,t,i,r){var a,s;if(e==="Error")throw new Error("Error");if(e==="Sequence")return t.length===0?"":`(${t.map(o=>fe(o,r,i)).join(", ")})`;if(e==="Sum"||e==="Product")return rh(e,t,r);if(t.every(o=>!Qa(o))){let o=(a=r.operators)==null?void 0:a.call(r,e);if(dr(e)&&t.length>2&&o){let l=[];for(let u=0;u<t.length-1;u++)l.push(sl(e,[t[u],t[u+1]],o[1],r));return`(${l.join(") && (")})`}if(o!==void 0){if(t===null)return"";let l;return t.length===1?l=`${o[0]}${fe(t[0],r,o[1])}`:l=t.map(u=>fe(u,r,o[1])).join(` ${o[0]} `),o[1]<i?`(${l})`:l}}if(e==="Function"){let o=t.slice(1).map(l=>l.symbol);return`((${o.join(", ")}) => ${fe(t[0].canonical,{...r,var:l=>o.includes(l)?l:r.var(l)})})`}if(e==="Declare")return`let ${t[0].symbol}`;if(e==="Assign")return`${t[0].symbol} = ${fe(t[1],r)}`;if(e==="Return")return`return ${fe(t[0],r)}`;if(e==="If"){if(t.length!==3)throw new Error("If: wrong number of arguments");return`((${fe(t[0],r)}) ? (${fe(t[1],r)}) : (${fe(t[2],r)}))`}if(e==="Block"){let o=[];for(let u of t)u.head==="Declare"&&o.push(u.ops[0].symbol);if(t.length===1&&o.length===0)return fe(t[0],r);let l=t.map(u=>fe(u,{...r,var:f=>o.includes(f)?f:r.var(f)}));return l[l.length-1]=`return ${l[l.length-1]}`,`(() => {${r.ws(`
`)}${l.join(`;${r.ws(`
`)}`)}${r.ws(`
`)}})()`}let n=(s=r.functions)==null?void 0:s.call(r,e);if(!n)throw new Error(`Unknown function ${e}`);if(typeof n=="function"){if(t.length===1&&Ee(t[0])){let o=Ai();return`(${fe(t[0],r)}).map((${o}) => ${n(t[0].engine.box(o),l=>fe(l,r))})`}return n(t,o=>fe(o,r))}if(t===null)return`${n}()`;if(t.length===1&&Ee(t[0])){let o=Ai();return`(${fe(t[0],r)}).map((${o}) => ${n}(${fe(t[0].engine.box(o),r)}))`}return`${n}(${t.map(o=>fe(o,r)).join(", ")})`}function fe(e,t,i=0){var o;if(e===void 0)return"";if(!e.isValid)throw new Error("Invalid expression");let r=N(e);if(r!==null)return t.number(r);let n=e.symbol;if(n!==null)return((o=t.var)==null?void 0:o.call(t,n))??n;if(e.string!==null)return t.string(n);let a=e.keys;if(a!==null){let l=[];for(let u of a){let f=e.getKey(u);f&&l.push(`${u}: ${fe(f,t,0)}`)}return`{${l.join(", ")}}`}let s=e.head;return typeof s=="string"?sl(s,e.ops,i,t):""}function rh(e,t,i){if(t===null)throw new Error("Sum/Product: no arguments");if(!t[0])throw new Error("Sum/Product: no body");let[r,n,a,s]=On(t[1]),o=e==="Sum"?"+":"*";if(!r){let c=Ai(),h=Ai();return`${fe(t[0],i)}.reduce((${h}, ${c}) => ${h} ${o} ${c}, ${o==="+"?"0":"1"})`}let l=fe(t[0],{...i,var:c=>c===r?r:i.var(c)}),u=Ai(),f=Ai();return`(() => {
  let ${f} = ${o==="+"?"0":"1"};
  let ${r} = ${n};
  const _fn = () => ${l};
  while (${u} <= ${a}) {
    ${f} ${o}= _fn();
    ${u}++;
  }
  return ${f};
})()`}function Ai(){return`_${Math.random().toString(36).substring(2)}`}var ne=class{constructor(e,t){this.engine=e,(t==null?void 0:t.latex)!==void 0&&(this._latex=t.latex)}valueOf(){var e;return this.symbol==="True"?!0:this.symbol==="False"?!1:this.head&&typeof this.head=="string"&&["List","Set","Sequence","Tuple","Pair","Single","Triple"].includes(this.head)?(e=this.ops)==null?void 0:e.map(t=>t.valueOf()):N(this)??this.string??this.symbol??JSON.stringify(this.json)}toString(){var t,i;if(this.symbol)return this.symbol;if(this.string)return`"${this.string}"`;let e=this.numericValue;if(e!==null){if(typeof e=="number"||e instanceof T)return e.toString();if(re(e))return`(${e[0].toString()}/${e[1].toString()})`;if(_e(e))return`(${e[0].toString()}/${e[1].toString()})`;if(e instanceof Kf.Complex){let r=e.im===1?"":e.im===-1?"-":e.im.toString();return e.re===0?r+"i":e.im<0?`${e.re.toString()}${r}i`:`(${e.re.toString()}+${r}i)`}}return this.head&&typeof this.head=="string"?this.head==="List"?`[${((t=this.ops)==null?void 0:t.map(r=>r.toString()))??""}]`:this.head==="Domain"?JSON.stringify(this.json):`${this.head}(${((i=this.ops)==null?void 0:i.map(r=>r.toString()).join(", "))??""})`:JSON.stringify(this.json)}print(){let e=console.log;e==null||e(this.toString())}[Symbol.toPrimitive](e){if(e==="number"){let t=this.valueOf();return typeof t=="number"?t:null}return this.toString()}toJSON(){return this.json}get rawJson(){return this.json}get scope(){return null}is(e){return e==null?!1:this.isSame(this.engine.box(e))}get canonical(){return this}get latex(){return this._latex??this.engine.serialize(this)}set latex(e){this._latex=e}get symbol(){return null}get isNothing(){return!1}get string(){return null}getSubexpressions(e){return Ea(this,e)}get subexpressions(){return this.getSubexpressions("")}get symbols(){let e=new Set;return Br(this,e),Array.from(e)}get unknowns(){let e=new Set;return Ur(this,e),Array.from(e)}get freeVariables(){let e=new Set;return Rr(this,e),Array.from(e)}get errors(){return this.getSubexpressions("Error")}get ops(){return null}get nops(){return 0}get op1(){return this.engine.Nothing}get op2(){return this.engine.Nothing}get op3(){return this.engine.Nothing}get isValid(){return!0}get isPure(){return!1}get isExact(){return!1}get isConstant(){return!1}get isNaN(){}get isZero(){}get isNotZero(){}get isOne(){}get isNegativeOne(){}get isInfinity(){}get isFinite(){}get isEven(){}get isOdd(){}get isPrime(){}get isComposite(){}get numericValue(){return null}get sgn(){return null}get shape(){return[]}get rank(){return 0}subs(e,t){return t!=null&&t.canonical?this.canonical:this}solve(e){return null}replace(e){return null}has(e){return!1}isLess(e){}isLessEqual(e){}isGreater(e){}isGreaterEqual(e){}get isPositive(){}get isNonNegative(){}get isNegative(){}get isNonPositive(){}isCompatible(e,t){return!1}get description(){if(this.baseDefinition&&this.baseDefinition.description)return typeof this.baseDefinition.description=="string"?[this.baseDefinition.description]:this.baseDefinition.description}get url(){var e;return((e=this.baseDefinition)==null?void 0:e.url)??void 0}get wikidata(){var e;return((e=this.baseDefinition)==null?void 0:e.wikidata)??void 0}get complexity(){}get baseDefinition(){}get symbolDefinition(){}get functionDefinition(){}infer(e){return!1}bind(){}reset(){}get keys(){return null}get keysCount(){return 0}getKey(e){}hasKey(e){return!1}get value(){return this.N().valueOf()}set value(e){throw new Error(`Can't change the value of \\(${this.latex}\\)`)}get domain(){}set domain(e){throw new Error(`Can't change the domain of \\(${this.latex}\\)`)}get isNumber(){}get isInteger(){}get isRational(){}get isAlgebraic(){return!1}get isReal(){}get isExtendedReal(){}get isComplex(){}get isImaginary(){}get isExtendedComplex(){}simplify(e){return this}evaluate(e){return this.simplify()}N(e){return this.evaluate({numericMode:!0})}compile(e="javascript",t){if(e!=="javascript")return;t??(t={optimize:["simplify"]});let i=this;return t.optimize.includes("simplify")&&(i=i.simplify()),t.optimize.includes("evaluate")&&(i=i.evaluate()),ih(i)}};function Rr(e,t){if(e.head,e.symbol){let i=e.engine.lookupSymbol(e.symbol);if(i&&i.value!==void 0)return;let r=e.engine.lookupFunction(e.symbol);if(r&&(r.signature.evaluate||r.signature.N))return;t.add(e.symbol);return}if(e.head&&typeof e.head!="string"&&Rr(e.head,t),e.ops)for(let i of e.ops)Rr(i,t);if(e.keys)for(let i of e.keys)Rr(e.getKey(i),t)}function Br(e,t){if(e.symbol){t.add(e.symbol);return}if(e.head&&typeof e.head!="string"&&Br(e.head,t),e.ops)for(let i of e.ops)Br(i,t);if(e.keys)for(let i of e.keys)Br(e.getKey(i),t)}function Ur(e,t){if(e.symbol){let i=e.symbol;if(i==="Unknown"||i==="Undefined"||i==="Nothing")return;let r=e.engine.lookupSymbol(i);if(r&&r.value!==void 0)return;let n=e.engine.lookupFunction(i);if(n&&(n.signature.evaluate||n.signature.N))return;t.add(i);return}if(e.head&&typeof e.head!="string"&&Ur(e.head,t),e.ops)for(let i of e.ops)Ur(i,t);if(e.keys)for(let i of e.keys)Ur(e.getKey(i),t)}function Ea(e,t){let i=!t||e.head===t?[e]:[];if(e.ops)for(let r of e.ops)i.push(...Ea(r,t));else if(e.keys)for(let r of e.keys)i.push(...Ea(e.getKey(r),t));return i}function nh(e){let t=[],i=(r,n=[])=>{if(r.length===0)t.push(n);else for(let a=0;a<r.length;a++){let s=r.slice(),o=s.splice(a,1);i(s.slice(),n.concat(o))}};return i(e),t}var We=me(de(),1);function ol(e,t){for(e.isInteger()&&t.isInteger();!t.isZero();)[e,t]=[t,e.modulo(t)];return e.abs()}function ah(e,t){return e.mul(t).div(ol(e,t))}function ll(e,t){if(!t.isInteger()||t.isNegative())return e._BIGNUM_NAN;if(t.lessThan(10))return e.bignum([1,1,2,6,24,120,720,5040,40320,362880,3628800][t.toNumber()]);if(t.gt(Number.MAX_SAFE_INTEGER)){let a=e._BIGNUM_ONE,s=e._BIGNUM_TWO;for(;s.lessThan(t);)a=a.mul(s),s=s.add(1);return a}if(t.modulo(2).eq(1))return t.times(ll(e,t.minus(1)));let i=t.toNumber(),r=t,n=t;for(;i>2;)i-=2,r=r.add(i),n=n.mul(r);return n}function sh(e,t){if(!t.isInteger()||t.isNegative())return e._BIGNUM_NAN;if(t.lessThan(1))return e._BIGNUM_ONE;let i=t;for(;t.greaterThan(2);)t=t.minus(2),i=i.mul(t);return i}var Rs=7;function ul(e,t){if(t.isNegative())return e._BIGNUM_NAN;let i=e.cache("gamma-p-ln",()=>["0.99999999999999709182","57.156235665862923517","-59.597960355475491248","14.136097974741747174","-0.49191381609762019978","0.33994649984811888699e-4","0.46523628927048575665e-4","-0.98374475304879564677e-4","0.15808870322491248884e-3","-0.21026444172410488319e-3","0.2174396181152126432e-3","-0.16431810653676389022e-3","0.84418223983852743293e-4","-0.2619083840158140867e-4","0.36899182659531622704e-5"].map(s=>e.bignum(s))),r=i[0];for(let s=i.length-1;s>0;--s)r=r.add(i[s].div(t.add(s)));let n=e.cache("gamma-g-ln",()=>e.bignum(607).div(128)),a=t.add(n).add(e._BIGNUM_HALF);return e._BIGNUM_NEGATIVE_ONE.acos().mul(e._BIGNUM_TWO).log().mul(e._BIGNUM_HALF).add(a.log().mul(t.add(e._BIGNUM_HALF)).minus(a).add(r.log()).minus(t.log()))}function cl(e,t){if(t.lessThan(e._BIGNUM_HALF)){let a=e._BIGNUM_NEGATIVE_ONE.acos();return a.div(a.mul(t).sin().mul(cl(e,e._BIGNUM_ONE.sub(t))))}if(t.greaterThan(100))return ul(e,t).exp();t=t.sub(1);let i=e.cache("lanczos-7-c",()=>["0.99999999999980993227684700473478","676.520368121885098567009190444019","-1259.13921672240287047156078755283","771.3234287776530788486528258894","-176.61502916214059906584551354","12.507343278686904814458936853","-0.13857109526572011689554707","9.984369578019570859563e-6","1.50563273514931155834e-7"].map(a=>e.bignum(a))),r=i[0];for(let a=1;a<Rs+2;a++)r=r.add(i[a].div(t.add(a)));let n=t.add(Rs).add(e._BIGNUM_HALF);return e._BIGNUM_NEGATIVE_ONE.acos().times(e._BIGNUM_TWO).sqrt().mul(r.mul(n.neg().exp()).mul(n.pow(t.add(e._BIGNUM_HALF))))}function fl(e){return e.isFinite()?e.d.length>3||e.d.length===3&&e.d[0]>=90?!1:(e.precision()<=16,e.e<308&&e.e>-306):!0}var oh=0x3ffffffffffe5;function Mi(e){if(!Number.isInteger(e)||!Number.isFinite(e)||Number.isNaN(e)||e<=1)return!1;if(e<=Tf)return Ds.has(e);for(let t of Ds)if(e%t===0)return!1;return e>=oh?uh(e,30)?void 0:!1:e===lh(e)}function lh(e){if(e===1)return 1;if(e%2===0)return 2;if(e%3===0)return 3;if(e%5===0)return 5;let t=Math.floor(Math.sqrt(e)),i=7;for(;i<=t;){if(e%i===0)return i;if(e%(i+4)===0)return i+4;if(e%(i+6)===0)return i+6;if(e%(i+10)===0)return i+10;if(e%(i+12)===0)return i+12;if(e%(i+16)===0)return i+16;if(e%(i+22)===0)return i+22;if(e%(i+24)===0)return i+24;i+=30}return e}function uh(e,t){let i=0,r=e-1;for(;r%2===0;)r/=2,++i;e:do{let n=Math.pow(2+Math.floor(Math.random()*(e-3)),r)%e;if(!(n===1||n===e-1)){for(let a=i-1;a--;){if(n=n*n%e,n===1)return!1;if(n===e-1)continue e}return!1}}while(--t);return!0}var hl=me(de(),1),Bs=me(de(),1),Us=me(de(),1);function mn(e){if(e.head==="Power"&&e.op2.numericValue!==null){let t=W(e.op2);return t!==null&&t>0?t:1}if(e.head==="Multiply"){let t=1;for(let i of e.ops){let r=mn(i);r>1&&(t=t+r)}return t}return 1}function js(e){if(e.head==="Power"&&e.op2.numericValue!==null){let t=W(e.op2);return t!==null&&t>0?t:1}if(e.head==="Multiply"){let t=1;for(let i of e.ops)t=Math.max(t,mn(i));return t}return 1}function dn(e){return e.symbol?e.symbol:e.ops?(typeof e.head=="string"?e.head:dn(e.head))+'"'+e.ops.map(t=>dn(t)).filter(t=>t.length>0).join('"'):""}var jt=1e5;function pl(e){return e.sort((t,i)=>{let r=dn(t),n=dn(i);if(!r&&!n)return Xt(t,i);if(!r)return 1;if(!n||r<n)return-1;if(r>n)return 1;let a=mn(t),s=mn(i);if(a!==s)return s-a;let o=js(t),l=js(i);return o!==l?o-l:Xt(t,i)})}function Xt(e,t){var r,n;if(e===t||e.numericValue!==null&&e.numericValue===t.numericValue)return 0;let i=N(e);if(i!==null){let a=N(t);return a!==null?i-a:-1}if(e.numericValue instanceof Us.Complex)return t.numericValue instanceof Us.Complex?e.numericValue.re===t.numericValue.re?Math.abs(e.numericValue.im)===Math.abs(t.numericValue.im)?e.numericValue.im-t.numericValue.im:Math.abs(e.numericValue.im)-Math.abs(t.numericValue.im):e.numericValue.re-t.numericValue.re:t.numericValue!==null?1:-1;if(e.numericValue)return t.numericValue?1:-1;if(e.head==="Sqrt"&&e.op1.numericValue)return t.head==="Sqrt"&&t.op1.numericValue?Xt(e.op1,t.op1):-1;if(e.symbol)return t.symbol?e.symbol===t.symbol?0:e.symbol>t.symbol?1:-1:t.numericValue!==null?1:-1;if(e.ops){if(t.ops){let a=((r=e.functionDefinition)==null?void 0:r.complexity)??jt,s=((n=t.functionDefinition)==null?void 0:n.complexity)??jt;return a===s?typeof e.head=="string"&&typeof t.head=="string"?e.head===t.head?Ii(e)-Ii(t):e.head<t.head?1:-1:Ii(e)-Ii(t):a-s}return t.numericValue!==null||t.symbol?1:-1}if(e.string)return t.string?e.string.length!==t.string.length?t.string.length-e.string.length:t.string<e.string?-1:e.string>t.string?1:0:t.keys?-1:1;if(e.keys&&t.keys){if(e.keysCount!==t.keysCount)return t.keysCount-e.keysCount;let a=0,s=0;for(let o of t.keys)a+=t.getKey(o).complexity??jt;for(let o of e.keys)s+=e.getKey(o).complexity??jt;return s-a}return(e.complexity??jt)-(t.complexity??jt)}function ml(e,{recursive:t=!1}){var i;if(e.ops){let r=e.ops;t&&(r=r.map(a=>ml(a,{recursive:t})));let n=e.engine;return e.head==="Add"?r=pl(r):(e.head==="Multiply"||(((i=n.lookupFunction(e.head))==null?void 0:i.commutative)??!1))&&(r=r.sort(Xt)),e.engine._fn(e.head,r)}return e}function Ii(e){return e.keys!==null?1+e.keysCount:e.ops?(typeof e.head=="string"?1:Ii(e.head))+[...e.ops].reduce((t,i)=>t+Ii(i),0):1}var ir=me(de(),1);function At(e){e.isCanonical;let t=e.engine;if(e.head==="Multiply"){let n=[],a=[1,1];for(let s of e.ops){let o=X(s);o?a=ee(a,o):n.push(s)}return Ne(a)?[a,e]:[a,t.mul(...n)]}if(e.head==="Divide"){let[n,a]=At(e.op1),[s,o]=At(e.op2),l=ee(n,Li(s));return o.isOne?[l,a]:Ne(l)?[l,e]:[l,t.div(a,o)]}if(e.head==="Power"){if(e.op2.numericValue===null)return[[1,1],e];let[n,a]=At(e.op1);if(Ne(n))return[n,e];let s=N(e.op2);return typeof s=="number"&&Number.isInteger(s)?[wa(n,s),t.pow(a,e.op2)]:[[1,1],e]}if(e.head==="Sqrt"){let[n,a]=At(e.op1),s=$f(n);return s?[s,t.sqrt(a)]:[[1,1],e]}if(e.head,e.head==="Negate"){let[n,a]=At(e.op1);return[at(n),a]}let i=e.numericValue;if(i instanceof ir.default&&i.re<0)return[[-1,1],t.number(t.complex(-i.re,-i.im))];let r=X(e);return r?[r,t.One]:[[1,1],e]}function ch(e,t){if(Ne(t))return e;if(Gt(t))return 0;if(e===null)return null;if(Ha(t))return typeof e=="number"?-e:e instanceof Bt||e instanceof ir.default?e.neg():at(e);if(Se(e))return ee(e,t);if(_e(t)){let[i,r]=t;if(typeof e=="number")return Number.isInteger(e)?[BigInt(e)*i,BigInt(e)*r]:new Bt(e).mul(i.toString()).div(r.toString());if(e instanceof Bt){let[n,a]=[new Bt(i.toString()),new Bt(r.toString())];return e.isInteger()?r===BigInt(1)?e.mul(n):[BigInt(e.mul(n).toString()),r]:e.mul(n).div(a)}if(e instanceof ir.default)return e.mul(Number(i)).div(Number(r))}else{let[i,r]=t;if(typeof e=="number")return Number.isInteger(e)?[e*i,r]:e*i/r;if(e instanceof Bt)return e.isInteger()?[BigInt(e.mul(i).toString()),BigInt(r)]:e.mul(i).div(r);if(e instanceof ir.default)return e.mul(i).div(r)}return null}function Fi(e){let t=e.engine,i=e.head;if(dr(i))return t.function(i,[Fi(e.ops[0]),Fi(e.ops[1])]);if(i==="Divide")return t.div(e.ops[0],e.ops[1]);if(i==="Add"){let[r,n]=e.ops.reduce((a,s)=>(s.head==="Divide"?(a[0].push(s.ops[0]),a[1].push(s.ops[1])):a[0].push(s),a),[[],[]]);return t.div(t.add(...r),t.add(...n))}return i==="Negate"?t.neg(Fi(e.ops[0])):e}function Gs(e,t){let i=[],r=e.engine;for(let a of e.factors){let s=t.find(a.factor);if(s!==-1)if(a.exponent.isSame(t.factors[s].exponent))i.push(a);else{let o=N(a.exponent),l=N(t.factors[s].exponent);if(o!==null&&l!==null){if(o>0&&l>0){let u=Math.min(o,l);i.push({factor:a.factor,exponent:r.number(u)})}else if(o<0&&l<0){let u=Math.max(o,l);i.push({factor:a.factor,exponent:r.number(u)})}}}}let n=e.integerCoefficient();if(n!==null){let a=t.integerCoefficient();a!==null&&i.push({factor:r.number(gr(n,a)),exponent:r.One})}return i.length===0?r.One:r.mul(...i.map(a=>r.pow(a.factor,a.exponent)))}function fh(e){let t=e.head;if(dr(t)){let r=new _i(e.op1),n=new _i(e.op2);r.reduceExactNumbers(),n.reduceExactNumbers();let a=Gs(r,n);return a.isOne||(r.div(a),n.div(a)),e.engine.function(t,[r.asExpression(),n.asExpression()])}if(t==="Add"){let r=null;for(let n of e.ops)if(!r)r=new _i(n),r.reduceExactNumbers();else{let a=new _i(n);a.reduceExactNumbers(),r=new _i(Gs(r,a)),r.reduceExactNumbers()}return(r==null?void 0:r.asExpression())??e.engine.One}let i=new _i(Fi(e));return i.reduceExactNumbers(),i.asExpression()}var _i=class{constructor(e){this.factors=[],this.hasNaN=!1,this.hasZero=!1,this.hasInfinity=!1,this.sign=1,this.engine=e.engine,this.mul(Fi(e))}div(e){if(!e.isOne){if(e.isNegativeOne){this.sign*=-1;return}this.mul(e,this.engine.NegativeOne)}}mul(e,t){if(t??(t=e.engine.One),e.head==="Negate"&&(this.sign*=-1,e=e.ops[0]),e.head==="Divide"){this.mul(e.ops[0],t),this.mul(e.ops[1],this.engine.neg(t));return}if(e.head==="Multiply"){for(let r of e.ops)this.mul(r,t);return}if(e.head==="Power"){this.mul(e.ops[0],this.engine.mul(e.ops[1],t));return}if(e.head==="Sqrt"){this.mul(e.ops[0],this.engine.mul(this.engine.Half,t));return}if(e.isNegative&&(this.sign*=-1,e=this.engine.neg(e)),t.isZero||e.isOne)return;if(e.isNaN){this.hasNaN=!0;return}if(e.isZero){t.isNonNegative?this.hasZero=!0:this.hasNaN=!0;return}if(e.isInfinity&&t.isNonNegative){t.isNonNegative?this.hasInfinity=!0:this.hasNaN=!0;return}let i=this.find(e);i===-1?this.factors.push({factor:e,exponent:t}):this.factors[i].exponent=this.engine.add(this.factors[i].exponent,t)}find(e){return this.factors.findIndex(t=>t.factor.isSame(e))}has(e){return this.find(e)!==-1}reduceNumbers(){let e=this.factors;this.factors=[];let t=this.engine,i=t.One;for(let r of e){let n=r.factor.N();n.numericValue!==null?i=t.mul(i,t.pow(n,r.exponent)):this.factors.push(r)}i.isOne||this.factors.push({factor:i,exponent:t.One})}reduceExactNumbers(){let e=this.engine;for(let l of this.factors){let u=l.factor;if(u.numericValue!==null&&!u.isExact)return this.reduceNumbers()}let t=this.factors;this.factors=[];let i=[1,1],r=1,n=0,a=[1,1];for(let l of t){let u=N(l.exponent);if(u===null){this.factors.push(l);continue}if(Number.isInteger(2*u)){let h=X(l.factor);if(h){a=ee(a,wa(h,2*u));continue}}let f=X(l.factor);if(f){i=ee(i,wa(f,u));continue}let c=l.factor.numericValue;if(c!==null&&c instanceof ir.default&&Number.isInteger(c.re)&&Number.isInteger(c.im)&&Number.isInteger(u)){c=c.pow(u),i=ee(i,[c.re,1]),c.im!==0&&(r*=c.im,n+=u);continue}this.factors.push(l)}let[s,o]=zf(a);i=ee(i,s),n!==0&&(n%2===0?i=ee(i,[r,1]):Cf(i)?(this.factors.push({factor:e.number(e.complex(mt(i),r)),exponent:e.One}),i=[1,1]):this.factors.push({factor:e.number(e.complex(0,r)),exponent:e.One})),Ne(i)||this.factors.push({factor:e.number(i),exponent:e.One}),Ne(o)||this.factors.push({factor:e.sqrt(e.number(o)),exponent:e.One})}integerCoefficient(){let e=null;for(let t of this.factors){let i=N(t.factor);if(i!==null&&Number.isInteger(i)){let r=N(t.exponent);r!==null&&(e=(e??1)*Math.pow(i,r));continue}}return e}asExpression(){let e=this.engine;if(this.factors.length===0)return e.One;if(this.hasNaN)return e.NaN;if(this.hasInfinity)return this.sign>0?e.PositiveInfinity:e.NegativeInfinity;if(this.hasZero)return e.Zero;if(this.factors.length===1){let{factor:n,exponent:a}=this.factors[0];return e.pow(n,a)}let t=this.factors.filter(n=>n.exponent.isPositive&&!n.factor.isOne).map(n=>e.pow(n.factor,n.exponent)),i;t.length===0?i=this.sign>0?e.One:e.NegativeOne:t.length===1?this.sign<0?i=e.neg(t[0]):i=t[0]:(i=e._fn("Multiply",t),this.sign<0&&(i=e.neg(i)));let r=this.factors.filter(n=>n.exponent.isNegative&&!n.factor.isOne).map(n=>e.pow(n.factor,e.neg(n.exponent)));return r.length===0?i:r.length===1?e.div(i,r[0]):e.div(i,e._fn("Multiply",r))}},rr=me(de(),1);function Oi(e,t,i,r){if(i.symbol==="ComplexInfinity")return e.NaN;if(i.isZero)return e.One;if(i.isOne)return t;if(i.isNegativeOne)return e.inv(t);if(i.numericValue!==null&&t.numericValue!==null){if(t.isOne)return e.One;if(t.isZero){if(i.isPositive)return e.Zero;if(i.isNegative)return e.ComplexInfinity}if(i.isNegativeOne)return e.inv(t);let n=N(i);if(n===.5||n===-.5){if(X(t)){let a=e._fn("Sqrt",[t],r);return n>0?a:e._fn("Divide",[e.One,a],r)}return e._fn("Power",[t,i],r)}if(t.isInfinity){if(i.numericValue instanceof rr.Complex){let a=i.numericValue.re;if(a===0)return e.NaN;if(a<0)return e.Zero;if(a>0)return e.ComplexInfinity}if(t.isNegative){if(i.isInfinity)return e.NaN}else if(t.isPositive){if(i.isNegativeOne)return e.Zero;if(i.isInfinity)return i.isNegative?e.Zero:e.PositiveInfinity}}if(i.isInfinity&&(t.isOne||t.isNegativeOne))return e.NaN}if(t.head==="Power"&&t.op1.isReal){let n=W(i);if(n!==null){let a=W(t.op2);if(a!==null)return e.pow(t.op1,e.number(n*a))}if(t.op1.isNonNegative){let a=X(i);if(a){let s=X(t.op2);if(s)return e.pow(t.op1,e.number(ee(a,s)))}}}return e._fn("Power",[t,i],r)}function Zs(e,t,i){if(t.numericValue===null||i.numericValue===null)return;if(t.numericValue instanceof rr.Complex)return i.numericValue instanceof rr.Complex?e.number(t.numericValue.pow(i.numericValue)):e.number(t.numericValue.pow(N(i)??NaN));if(i.numericValue instanceof rr.Complex){let s=N(t)??null;return s!==null?e.number(e.complex(s).pow(i.numericValue)):void 0}let r=hh(i);if(K(e)||t.numericValue instanceof T||i.numericValue instanceof T){let s=Yt(t),o=Yt(i);if(!s||!o)return;if(r===2)return s.isNeg()?Fe(e)?e.number(e.complex(0,s.neg().sqrt().toNumber())):e.NaN:e.number(s.sqrt());if(!o.isInteger()&&s.isNeg()){if(!Fe(e))return e.NaN;let l=e.complex(s.toNumber()),u=e.complex(o.toNumber());return e.number(l.pow(u))}return e.number(s.pow(o))}let n=N(i)??NaN,a=N(t)??NaN;if(r===2)return a<0?Fe(e)?e.mul(e.I,e.number(Math.sqrt(-a))):e.NaN:e.number(Math.sqrt(a));if(!Number.isInteger(n)&&a<0){if(!Fe(e))return e.NaN;let s=e.complex(a),o=e.complex(n);return e.number(s.pow(o))}return e.number(Math.pow(a,n))}function Di(e,t,i,r){if(r!=="simplify"&&t.symbol==="ExponentialE"&&i instanceof rr.Complex){let n=i.im,a=i.re,s;if(a===0)s=this.number(this.complex(Math.cos(n),Math.sin(n)));else{if(n===0)return this.number(Math.exp(a));{let o=Math.exp(a);s=this.number(this.complex(o*Math.cos(n),o*Math.sin(n)))}}return r==="N"?s.N():s}if(t.head==="Multiply"){let n=K(e)?[BigInt(1),BigInt(1)]:[1,1],a=n,s=[];for(let o of t.ops){let l=X(o);if(l)n=ee(n,l);else{let u=dl(o);u?a=ee(a,u):s.push(o)}}if(!Ne(n)||!Ne(a)){let o=Di(e,e.number(n),i,r),l=Di(e,e.number(a),e.div(i,e.number(2)),r),u=e.mul(...s),f=Di(e,u,i,r)??e._fn("Power",[u,i]);if(o&&l&&f)return e.mul(o,l,f)}}if(t.head==="Power"){if(W(t.op2)===-1&&W(i)===-1)return t.op1;let n=X(t.op2),a=X(i);if(n&&a){let s=ee(n,a);return e.pow(t.op1,s)}if(r==="N"){let s=N(t.op2),o=N(i);if(s!==null&&o!==null){let l=s*o;return l===0?e.One:l===1?t.op1:e.pow(t.op1,l)}}}if(r!=="N"&&t.numericValue!==null&&t.isInteger){if(t.isOne)return e.One;if(W(i))return Zs(e,t,i);let n=X(i);if(n){let[a,s]=[mt(n),pi(n)];if((a===1||a===-1)&&(s===2||s===3)){if(K(e)||t.numericValue instanceof T){let o=Ta(t);if(s%2===0&&o<0&&!Fe(e))return e.NaN;let l=o<0?s%2===0?e.I:e.NegativeOne:e.One,[u,f]=fr(o>0?o:-o,s);if(f===BigInt(1)&&u===BigInt(1))return l;if(u!==BigInt(1))return f===BigInt(1)?e.mul(l,e.number(a>=0?u:[BigInt(1),u])):e.mul(l,e.number(u),e.pow(e.number(f),i))}else if(typeof t.numericValue=="number"){if(t.numericValue<0&&s%2===0&&!Fe(e))return e.NaN;let[o,l]=qi(Math.abs(t.numericValue),s),u=t.numericValue<0?s%2===0?e.I:e.NegativeOne:e.One;if(l===1&&o===1)return u;if(o!==1)return l===1?e.mul(u,e.number(a>=0?o:[1,o])):e.mul(u,e.number(o),e.pow(e.number(l),i))}}return t.isNegative?Fe?e.mul(e.I,e.box(["Sqrt",e.neg(t)])):e.NaN:void 0}}if(r!=="N"&&Se(t.numericValue)){let[n,a]=t.numericValue;return e.div(e.pow(e.number(n),i),e.pow(e.number(a),i))}if(r!=="simplify"&&t.numericValue!==null&&i.numericValue!==null)return Zs(e,t,i)}function jr(e,t,i){if(t.isOne)return e.One;if(t.isZero)return e.Zero;if(t.isNegativeOne)return Fe(e)?e.I:e.NaN;if(t.isNegative&&!Fe(e))return e.NaN;let r=X(t);if(i==="N"||i==="evaluate"&&!r)return L(t,a=>a<0?e.complex(a).sqrt():Math.sqrt(a),a=>a.isNeg()?e.complex(a.toNumber()).sqrt():a.sqrt(),a=>a.sqrt());let n=W(t);if(n!==null){let[a,s]=qi(Math.abs(n),2);return a===1?e._fn("Sqrt",[t]):n<0?s===1?e.number(e.complex(0,a)):e.mul(e.number(e.complex(0,a)),e.sqrt(e.number(s))):s===1?e.number(a):e.mul(e.number(a),e.sqrt(e.number(s)))}if(r){if(re(r)&&!K(e)){let[a,s]=r;if(Math.abs(a)<Number.MAX_SAFE_INTEGER&&s<Number.MAX_SAFE_INTEGER){let[o,l]=qi(Math.abs(a),2),[u,f]=qi(s,2);if(a<0)return e.mul(e.number([o,u]),e.sqrt(e.number([l,f])),e.I);let c=e.number([o,u]);return c.isOne?e._fn("Sqrt",[e.number([l,f])]):e.mul(c,e.sqrt(e.number([l,f])))}}if(_e(r)||K(e)){let a=R(r[0]),[s,o]=fr(a>0?a:-a,2),[l,u]=fr(R(r[1]),2);if(a<0)return e.mul(e.number([s,l]),e.sqrt(e.number([o,u])),e.I);let f=e.number([s,l]);return f.isOne?e._fn("Sqrt",[e.number([o,u])]):e.mul(f,e.sqrt(e.number([o,u])))}}}function hh(e){if(typeof e.numericValue=="number"){let r=1/e.numericValue;return Number.isInteger(r)?r:null}if(e.numericValue instanceof T){let r=e.engine._BIGNUM_ONE.div(e.numericValue);return r.isInt()?r.toNumber():null}if(!Se(e.numericValue))return null;let[t,i]=[mt(e.numericValue),pi(e.numericValue)];return t!==1&&t!==-1?null:t*i}function gn(e){return e.head==="Sqrt"||e.head==="Power"&&N(e.op2)===.5}function dl(e){return gn(e)?X(e.op1)??null:null}var qn=class{constructor(e,t,i){if(this.options=i,this._terms=[],this._hasInfinity=!1,this._hasZero=!1,this._isCanonical=!0,i=i?{...i}:{},"canonical"in i||(i.canonical=!0),this._isCanonical=i.canonical,this.engine=e,this._sign=1,this._rational=K(e)?[BigInt(1),BigInt(1)]:[1,1],this._rationalSqrt=this._rational,this._complex=Bs.Complex.ONE,this._bignum=e._BIGNUM_ONE,this._number=1,t)for(let r of t)this.addTerm(r)}get isEmpty(){return this._isCanonical?this._terms.length===0&&this._hasInfinity===!1&&this._hasZero===!1&&this._sign===1&&this._number===1&&this._complex.re===1&&this._complex.im===0&&this._bignum.eq(this.engine._BIGNUM_ONE)&&Ne(this._rational)&&Ne(this._rationalSqrt):this._terms.length===0}addTerm(e){if(e.isCanonical,e.head==="Multiply"){for(let n of e.ops)this.addTerm(n);return}if(this._isCanonical){if(e.isNothing)return;if(e.numericValue!==null){if(e.isOne)return;if(e.isZero){this._hasZero=!0;return}if(e.isNegativeOne){this._sign*=-1;return}if(e.isInfinity){this._hasInfinity=!0,e.isNegative&&(this._sign*=-1);return}let a=e.numericValue;if(typeof a=="number"){a<0&&(this._sign*=-1,a=-a),Number.isInteger(a)?this._rational=ee(this._rational,[a,1]):K(this.engine)?this._bignum=this._bignum.mul(a):this._number*=a;return}if(a instanceof T){a.isNegative()&&(this._sign*=-1,a=a.neg()),a.isInteger()?this._rational=ee(this._rational,[R(a),BigInt(1)]):K(this.engine)?this._bignum=this._bignum.mul(a):this._number*=a.toNumber();return}if(a instanceof Bs.Complex){this._complex=this._complex.mul(a);return}if(Se(a)){this._rational=ee(this._rational,a),zs(this._rational)&&(this._sign*=-1,this._rational=at(this._rational));return}}let n=dl(e);if(n){this._rationalSqrt=ee(this._rationalSqrt,n);return}}let t=e;if(this._isCanonical){let n;[n,t]=At(e),this._rational=ee(this._rational,n),zs(this._rational)&&(this._sign*=-1,this._rational=at(this._rational))}if(t.numericValue!==null&&t.isOne)return;let i=[1,1];if(t.head==="Power"){let n=X(t.op2);n&&(i=n,t=t.op1)}else t.head==="Divide"&&(this.addTerm(t.op1),i=[-1,1],t=t.op2);let r=!1;for(let n of this._terms)if(n.term.isSame(t)){n.exponent=Sa(n.exponent,i),r=!0;break}r||this._terms.push({term:t,exponent:i})}unitTerms(e){let t=this.engine;if(e==="numeric"){if(!Fe(t)&&this._complex.im!==0)return null;if(K(t)){let o=t._BIGNUM_ONE;if(Ne(this._rational)||(_e(this._rational)?o=t.bignum(this._rational[0].toString()).div(t.bignum(this._rational[1].toString())):o=t.bignum(this._rational[0]).div(this._rational[1])),o=o.mul(this._bignum).mul(this._sign*this._number),this._complex.im!==0){let l=this._complex.mul(o.toNumber());return l.equals(1)?[]:[{exponent:[1,1],terms:[t.number(l)]}]}return o=o.mul(this._complex.re),o.equals(1)?[]:[{exponent:[1,1],terms:[t.number(o)]}]}let s=1;if(Ne(this._rational)||(_e(this._rational)?s=Number(this._rational[0])/Number(this._rational[1]):s=this._rational[0]/this._rational[1]),s*=this._sign*this._number*this._bignum.toNumber(),this._complex.im!==0){let o=this._complex.mul(s);return o.equals(1)?[]:[{exponent:[1,1],terms:[t.number(o)]}]}return s*=this._complex.re,s===1?[]:[{exponent:[1,1],terms:[t.number(s)]}]}let i=[],r=[];if(this._hasInfinity&&r.push(t.PositiveInfinity),this._rationalSqrt=It(this._rationalSqrt),!Ne(this._rationalSqrt)){let[s,o]=this._rationalSqrt,l=t.sqrt(t.number(s)),u=t.sqrt(t.number(o));if(u.isOne){let f=X(l);f?this._rational=ee(this._rational,f):r.push(l)}else l.isInteger&&u.isInteger?(this._rational=ee(ee(this._rational,l),t.inv(u)),r.push(t._fn("Sqrt",[t.div(l.op1,u.op1)]))):gn(l)&&gn(u)?r.push(t._fn("Sqrt",[t.div(l.op1,u.op1)])):r.push(t._fn("Divide",[l,u]))}(this._complex.re!==1||this._complex.im!==0)&&(this._complex.im===0?this._number*=Math.abs(this._complex.re):r.push(t.number(this._complex)));let n=this._sign*this._number,a=this._bignum;return this._rational=It(this._rational),Ne(this._rational)||(e==="rational"?(mt(this._rational)!==1&&(_e(this._rational)?a=a.mul(t.bignum(this._rational[0])):n*=this._rational[0]),pi(this._rational)!==1&&i.push({exponent:[-1,1],terms:[t.number(this._rational[1])]})):n===-1?(r.push(t.number(at(this._rational))),n=1):r.push(t.number(this._rational))),a.equals(t._BIGNUM_ONE)?n!==1&&r.push(t.number(n)):r.push(t.number(a.mul(n))),r.length>0&&i.push({exponent:[1,1],terms:r}),i}groupedByDegrees(e){e??(e={}),"mode"in e||(e.mode="expression");let t=this.engine;if(e.mode==="numeric"){if(this._complex.im!==0&&!Fe(t))return null;if(this._hasInfinity)return[{exponent:[1,1],terms:[t.PositiveInfinity]}]}let i=this.unitTerms(e.mode??"expression");if(i===null)return null;for(let r of this._terms){let n=It(r.exponent);if(n[0]===0)continue;let a=!1;for(let s of i)if(n[0]===s.exponent[0]&&n[1]===s.exponent[1]){s.terms.push(r.term),a=!0;break}a||i.push({exponent:n,terms:[r.term]})}return i}asExpression(e="evaluate"){let t=this.engine;if(this._hasInfinity){if(this._hasZero)return t.NaN;if(this._terms.length===0)return mt(this._rational)>0?t.PositiveInfinity:t.NegativeInfinity}if(this._hasZero)return t.Zero;let i=this.groupedByDegrees({mode:e==="N"?"numeric":"expression"});if(i===null)return t.NaN;let r=Yn(t,i);return r.length===0?t.One:r.length===1?r[0]:this.engine._fn("Multiply",r)}asNumeratorDenominator(){if(this._hasZero)return[this.engine.Zero,this.engine.One];if(this._hasInfinity)return[this.engine.NaN,this.engine.NaN];let e=this.groupedByDegrees({mode:"rational"});if(e===null)return[this.engine.NaN,this.engine.NaN];let t=[],i=[];for(let l of e)l.exponent[0]>=0?t.push(l):i.push({exponent:at(l.exponent),terms:l.terms});let r=this.engine,n=Yn(r,t),a=r.One;n.length===1?a=n[0]:n.length>0&&(a=r._fn("Multiply",n));let s=Yn(r,i),o=r.One;return s.length===1?o=s[0]:s.length>0&&(o=r._fn("Multiply",s)),[a,o]}asRationalExpression(){let[e,t]=this.asNumeratorDenominator();if(t.numericValue!==null){if(t.isOne)return e;if(t.isNegativeOne)return this.engine.neg(e)}return this.engine._fn("Divide",[e,t])}};function Hs(e){if(Ne(e))return 0;let[t,i]=[mt(e),pi(e)];return t>0&&Number.isInteger(t/i)?1:t>0?2:Number.isInteger(t/i)?3:4}function ph(e,t){let i=Hs(e.exponent),r=Hs(t.exponent);if(i!==r)return i-r;let[n,a]=[mt(e.exponent),pi(e.exponent)],[s,o]=[mt(t.exponent),pi(t.exponent)];return n/a-s/o}function Yn(e,t){let i=t.sort(ph).map(r=>{let n=De(r.terms,"Multiply"),a=n.length<=1?n[0]:e._fn("Multiply",n.sort(Xt));return e.pow(a,r.exponent)});return De(i,"Multiply")??i}function Ws(e,t,i,r){if(t.numericValue!==null){if(Se(t.numericValue))return mt(t.numericValue)<0?V(e,"Subtract",[i,e.number(at(t.numericValue))],r):null;let n=W(t);if(n!==null&&n<0)return V(e,"Subtract",[i,e.number(-n)],r)}return t.head==="Negate"?V(e,"Subtract",[i,t.op1],r):null}function mh(e,t,i,r){var a,s,o,l;let n=e.jsonSerializationOptions.exclude;if(t==="Add"&&i.length===2&&!n.includes("Subtract")){let u=Ws(e,i[0],i[1],r)??Ws(e,i[1],i[0],r);if(u)return u}if(t==="Divide"&&i.length===2&&n.includes("Divide"))return V(e,"Multiply",[i[0],e._fn("Power",[i[1],e.NegativeOne])],r);if(t==="Multiply"&&!n.includes("Negate")&&N(i[0])===-1)return i.length===2?V(e,"Negate",[i[1]]):V(e,"Negate",[e._fn("Multiply",i.slice(1))],r);if(t==="Multiply"&&!n.includes("Divide")){let u=new qn(e,i,{canonical:!1}).asRationalExpression();if(u.head==="Divide")return V(e,u.head,u.ops,r)}if(t==="Power"){if(!n.includes("Exp")&&((a=i[0])==null?void 0:a.symbol)==="ExponentialE")return V(e,"Exp",[i[1]],r);if(((s=i[1])==null?void 0:s.numericValue)!==null){let u=W(i[1]);if(u===2&&!n.includes("Square"))return V(e,"Square",[i[0]],r);if(u!==null&&u<0&&!n.includes("Divide"))return V(e,"Divide",[e.One,u===-1?i[0]:e.pow(i[0],-u)],r);let f=i[1].numericValue;if(!n.includes("Sqrt")&&f===.5)return V(e,"Sqrt",[i[0]],r);if(!n.includes("Sqrt")&&f===-.5)return V(e,"Divide",[e.One,e._fn("Sqrt",[i[0]])],r);if(Se(f)){let c=mt(f),h=pi(f);if(c===1){if(!n.includes("Sqrt")&&h===2)return V(e,"Sqrt",[i[0]],r);if(!n.includes("Root"))return V(e,"Root",[i[0],e.number(f[1])],r)}if(c===-1){if(!n.includes("Sqrt")&&h===2)return V(e,"Divide",[e.One,e._fn("Sqrt",[i[0]])],r);if(!n.includes("Root"))return V(e,"Divide",[e.One,e._fn("Root",[i[0],e.number(f[1])])],r)}}}}if(t==="Add"&&i.length===2&&!n.includes("Subtract")){if(((o=i[1])==null?void 0:o.numericValue)!==null){let u=W(i[1]);if(u!==null&&u<0)return V(e,"Subtract",[i[0],e.number(-u)],r)}if(((l=i[1])==null?void 0:l.head)==="Negate")return V(e,"Subtract",[i[0],i[1].op1],r)}if(t==="Tuple"){if(i.length===1&&!n.includes("Single"))return V(e,"Single",i,r);if(i.length===2&&!n.includes("Pair"))return V(e,"Pair",i,r);if(i.length===3&&!n.includes("Triple"))return V(e,"Triple",i,r)}return V(e,t,i,r)}function V(e,t,i,r){var o,l;let n=e.jsonSerializationOptions.exclude;if(t==="Negate"&&i.length===1){let u=(o=i[0])==null?void 0:o.numericValue;if(u!==null){if(typeof u=="number")return nr(e,-u);if(u instanceof T||u instanceof hl.Complex)return nr(e,u.neg());if(Se(u))return nr(e,at(u))}}if(typeof t=="string"&&n.includes(t)){if(t==="Rational"&&i.length===2)return V(e,"Divide",i,r);if(t==="Complex"&&i.length===2)return V(e,"Add",[i[0],e._fn("Multiply",[i[1]??e.symbol("Undefined"),e.I])],r);if(t==="Sqrt"&&i.length===1)return V(e,"Power",[i[0],n.includes("Half")?e.number([1,2]):e.Half],r);if(t==="Root"&&i.length===2&&((l=i[1])==null?void 0:l.numericValue)!==null){let u=W(i[1]);if(u===2)return V(e,"Sqrt",[i[0]]);if(u!==null)return u<0?V(e,"Divide",[e.One,e._fn("Power",[i[0]??e.symbol("Undefined"),e.number([1,-u])])],r):V(e,"Power",[i[0],e.number([1,-u])],r)}if(t==="Square"&&i.length===1)return V(e,"Power",[i[0],e.number(2)],r);if(t==="Exp"&&i.length===1)return V(e,"Power",[e.E,i[0]],r);if(t==="Pair"||t=="Single"||t==="Triple")return V(e,"Tuple",i,r);if(t==="Subtract"&&i.length===2)return V(e,"Add",[i[0],e._fn("Negate",[i[1]??e.symbol("Undefined")])],r);if(t==="Subtract"&&i.length===1)return V(e,"Negate",i,r)}let a=[typeof t=="string"?t:t.json,...i.map(u=>(u==null?void 0:u.json)??"Undefined")],s={...r??{}};return e.jsonSerializationOptions.metadata.includes("latex")?s.latex=s.latex??e.serialize({fn:a}):s.latex="",e.jsonSerializationOptions.metadata.includes("wikidata")||(s.wikidata=""),!s.latex&&!s.wikidata&&e.jsonSerializationOptions.shorthands.includes("function")?a:s.latex&&s.wikidata?{fn:a,latex:s.latex,wikidata:s.wikidata}:s.latex?{fn:a,latex:s.latex}:s.wikidata?{fn:a,wikidata:s.wikidata}:{fn:a}}function dh(e,t){return t=t,e.jsonSerializationOptions.shorthands.includes("string")?`'${t}'`:{str:t}}function Aa(e,t,i){var r;if(t==="Half"&&e.jsonSerializationOptions.exclude.includes("Half"))return nr(e,[1,2],i);if(i={...i},e.jsonSerializationOptions.metadata.includes("latex")?(i.latex=i.latex??e.serialize({sym:t}),i.latex!==void 0&&(i.latex=i.latex)):i.latex=void 0,e.jsonSerializationOptions.metadata.includes("wikidata")){if(i.wikidata===void 0){let n=(r=e.lookupSymbol(t))==null?void 0:r.wikidata;n!==void 0&&(i.wikidata=n)}}else i.wikidata=void 0;return t=t,i.latex===void 0&&i.wikidata===void 0&&e.jsonSerializationOptions.shorthands.includes("symbol")?t:i.latex!==void 0&&i.wikidata!==void 0?{sym:t,latex:i.latex,wikidata:i.wikidata}:i.latex!==void 0?{sym:t,latex:i.latex}:i.wikidata!==void 0?{sym:t,wikidata:i.wikidata}:{sym:t}}function nr(e,t,i){i={...i},e.jsonSerializationOptions.metadata.includes("latex")||(i.latex=void 0);let r=i.latex===void 0&&i.wikidata===void 0&&!e.jsonSerializationOptions.metadata.includes("latex")&&e.jsonSerializationOptions.shorthands.includes("number"),n=e.jsonSerializationOptions.exclude,a="";if(t instanceof T){if(t.isNaN())a="NaN";else if(!t.isFinite())a=t.isPositive()?"+Infinity":"-Infinity";else{if(r&&fl(t))return t.toNumber();if(t.isInteger()&&t.e<t.precision()+4)a=t.toFixed(0);else{let s=e.jsonSerializationOptions.precision,o=s==="max"?t.toString():t.toPrecision(s==="auto"?e.precision:s);if(a=Qs(e,o),r){let l=t.toNumber();if(l.toString()===a)return l}}}return e.jsonSerializationOptions.metadata.includes("latex")&&(i.latex=i.latex??e.serialize({num:a})),i.latex!==void 0?{num:a,latex:i.latex}:r?a:{num:a}}if(t instanceof hl.Complex)return t.isInfinite()?Aa(e,"ComplexInfinity",i):t.isNaN()?(a="NaN",e.jsonSerializationOptions.metadata.includes("latex")&&(i.latex=i.latex??e.serialize({num:a})),i.latex!==void 0?{num:a,latex:i.latex}:{num:a}):V(e,"Complex",[e.number(t.re),e.number(t.im)],{...i,wikidata:"Q11567"});if(Se(t)){let s=!n.includes("Rational");return r&&e.jsonSerializationOptions.shorthands.includes("function")&&re(t)?t[0]===1&&t[1]===2&&!n.includes("Half")?Aa(e,"Half",i):[s?"Rational":"Divide",t[0],t[1]]:V(e,s?"Rational":"Divide",[e.number(t[0]),e.number(t[1])],{...i})}if(Number.isNaN(t))a="NaN";else if(!Number.isFinite(t))a=t>0?"+Infinity":"-Infinity";else{if(r)return t;a=Qs(e,t.toString())}return e.jsonSerializationOptions.metadata.includes("latex")&&(i.latex=i.latex??e.serialize({num:a})),i.latex!==void 0?{num:a,latex:i.latex}:{num:a}}function Qs(e,t){if(!e.jsonSerializationOptions.repeatingDecimals)return t;let[i,r,n,a]=t.match(/^(.*)\.([0-9]+)([e|E][-+]?[0-9]+)?$/)??[];if(!n)return t.toLowerCase();let s=n[n.length-1];n=n.slice(0,-1);let o=16,l="";for(let u=0;u<n.length-o;u++){l=n.substring(0,u);for(let f=0;f<=o;f++){let c=n.substring(u,u+f+1),h=Math.floor((n.length-l.length)/c.length);if(h<3)break;if((l+c.repeat(h+1)).startsWith(n))return c==="0"?s==="0"?r+"."+l+(a??""):t:r+"."+l+"("+c+")"+(a??"")}}for(n+=s;n.endsWith("0");)n=n.slice(0,-1);return a?`${r}.${n}${a.toLowerCase()}`:`${r}.${n}`}var Oe=class Ma extends ne{constructor(t,i,r){if(super(t,r==null?void 0:r.metadata),typeof i=="number"){this._value=i,this._isCanonical=!0;return}if(Se(i)){let[n,a]=i;!(typeof n=="bigint"&&typeof a=="bigint")||a!==n&&BigInt(1),(r==null?void 0:r.canonical)??!0?(this._value=Xn(t,i),this._isCanonical=!0):(this._value=i,this._isCanonical=!1)}else!(i instanceof We.Complex)||!Number.isNaN(i.re)&&!Number.isNaN(i.im)&&t.chop(i.im),this._value=Xn(t,i),this._isCanonical=!0}get hash(){if(this._hash!==void 0)return this._hash;let t=0;return typeof this._value=="number"?t=st(this._value.toString()):this._value instanceof We.Complex?t=st(this._value.re.toString()+" +i "+this._value.im.toString()):this._value instanceof T?t=st(this._value.toString()):t=st(this._value[0].toString()+" / "+this._value[1].toString()),this._hash=t,t}get head(){return"Number"}get isPure(){return!0}get isExact(){let t=this._value;return typeof t=="number"?Number.isInteger(t):t instanceof T?t.isInteger():t instanceof We.Complex?Number.isInteger(t.re)&&Number.isInteger(t.im):Se(t)}get isCanonical(){return this._isCanonical}set isCanonical(t){this._isCanonical=t}get complexity(){return 1}get numericValue(){return this._value}get domain(){return this._domain??(this._domain=this.engine.domain(Lf(this._value))),this._domain}get json(){return nr(this.engine,this._value,{latex:this._latex})}get sgn(){if(this._value===0)return 0;if(typeof this._value=="number")return this._value<0?-1:this._value>0?1:null;if(this._value instanceof T)return this._value.isZero()?0:this._value.isNegative()?-1:this._value.isPositive()?1:null;if(Array.isArray(this._value)){let[t,i]=this._value;return t===0&&i!==0?0:t<0?-1:t>0?1:null}return null}isSame(t){if(this===t)return!0;if(!(t instanceof Ma))return!1;if(typeof this._value=="number")return typeof t._value!="number"?!1:this._value===t._value;if(this._value instanceof T)return t._value instanceof T?this._value.eq(t._value):!1;if(Array.isArray(this._value)){if(!Array.isArray(t._value))return!1;let[i,r]=t._value;return this._value[0]===i&&this._value[1]===r}return this._value instanceof We.Complex&&t._value instanceof We.Complex?this._value.equals(t._value):!1}isEqual(t){return this===t||Yi(this,t)===0}match(t,i){return Ya(this,t,i)}isEqualWithTolerance(t,i){return t instanceof Ma&&Yi(this,t,i)===0}isLess(t){let i=Yi(this,t);if(i!==void 0)return i<0}isLessEqual(t){let i=Yi(this,t);if(i!==void 0)return i<=0}isGreater(t){return t.isLessEqual(this)}isGreaterEqual(t){return t.isLess(this)}get isPositive(){if(typeof this._value=="number")return this._value>0;let t=this.sgn;if(t!=null)return t>0}get isNonNegative(){if(typeof this._value=="number")return this._value>=0;let t=this.sgn;if(t!=null)return t>=0}get isNegative(){if(typeof this._value=="number")return this._value<0;let t=this.sgn;if(t!=null)return t<0}get isNonPositive(){if(typeof this._value=="number")return this._value<=0;let t=this.sgn;if(t!=null)return t<=0}get isZero(){return this._value===0?!0:this._value instanceof T?this._value.isZero():this._value instanceof We.Complex?this._value.isZero():!1}get isNotZero(){return this._value===0?!1:this._value instanceof T?!this._value.isZero():this._value instanceof We.Complex?!this._value.isZero():!0}get isOne(){return this._value===1?!0:typeof this._value=="number"?!1:this._value instanceof T?this._value.equals(this.engine._BIGNUM_ONE):this._value instanceof We.Complex?this._value.im===0&&this._value.re===1:Ne(this._value)}get isNegativeOne(){return this._value===-1?!0:typeof this._value=="number"?!1:this._value instanceof T?this._value.equals(this.engine._BIGNUM_NEGATIVE_ONE):this._value instanceof We.Complex?this._value.im===0&&this._value.re===-1:Ha(this._value)}get isOdd(){if(this.isOne||this.isNegativeOne)return!0;if(this.isZero||!this.isInteger)return!1;if(typeof this._value=="number")return this._value%2!==0;if(this._value instanceof T)return!this._value.mod(2).isZero()}get isEven(){if(this.isOne||this.isNegativeOne)return!1;if(this.isZero)return!0;if(!this.isInteger)return!1;if(typeof this._value=="number")return this._value%2===0;if(this._value instanceof T)return this._value.mod(2).isZero()}get isPrime(){if(!this.isInteger||!this.isFinite||this.isNonPositive||this.isOne||this.isZero)return!1;if(typeof this._value=="number")return Mi(this._value);if(this._value instanceof T)return Mi(this._value.toNumber())}get isComposite(){if(!this.isInteger||!this.isFinite||this.isNonPositive||this.isOne||this.isZero)return!1;if(typeof this._value=="number")return!Mi(this._value);if(this._value instanceof T)return!Mi(this._value.toNumber())}get isInfinity(){return typeof this._value=="number"?!Number.isFinite(this._value)&&!Number.isNaN(this._value):this._value instanceof T?!this._value.isFinite()&&!this._value.isNaN():this._value instanceof We.Complex?!this._value.isFinite()&&!this._value.isNaN():!1}get isNaN(){return typeof this._value=="number"?Number.isNaN(this._value):this._value instanceof T?this._value.isNaN():this._value instanceof We.Complex?this._value.isNaN():!1}get isFinite(){return!this.isInfinity&&!this.isNaN}get isNumber(){return!0}get isInteger(){return typeof this._value=="number"?Number.isInteger(this._value):this._value instanceof T?this._value.isInteger():!1}get isRational(){return Array.isArray(this._value)?!0:this.isInteger}get isAlgebraic(){if(this.isRational)return!0}get isReal(){return this.isFinite?this._value instanceof We.Complex?this.engine.chop(this._value.im)===0:!0:!1}get isExtendedReal(){return this.isInfinity||this.isReal}get isComplex(){return!this.isNaN}get isImaginary(){return this._value instanceof We.Complex?(this._value.im,!0):!1}get isExtendedComplex(){return this.isInfinity||!this.isNaN}get canonical(){return this._isCanonical?this:this.engine.number(Xn(this.engine,this._value))}simplify(t){return this.canonical}evaluate(t){return t!=null&&t.numericMode?this.N(t):this}N(t){if(!Array.isArray(this._value))return this;let i=this.engine,[r,n]=this._value;return typeof r=="number"&&typeof n=="number"&&!K(i)?i.number(r/n):i.number(i.bignum(r).div(i.bignum(n)))}};function Xn(e,t){if(t instanceof T&&fl(t))return t.toNumber();if(!Se(t))return t;if(t=It(t),_e(t)){let[n,a]=t;if(n>Number.MIN_SAFE_INTEGER&&n<Number.MAX_SAFE_INTEGER&&a>Number.MIN_SAFE_INTEGER&&a<Number.MAX_SAFE_INTEGER)t=[Number(n),Number(a)];else return a<0&&([n,a]=[-n,-a]),a===BigInt(1)?e.bignum(n):a===BigInt(0)?n===a?NaN:n<0?-1/0:1/0:[n,a]}let[i,r]=t;return Number.isNaN(i)||Number.isNaN(r)?NaN:(r<0&&([i,r]=[-i,-r]),r===1?i:r===0?i===0||!Number.isFinite(i)?NaN:i<0?-1/0:1/0:i===0?i:[i,r])}function mi(e){var t;return((t=e.symbol)==null?void 0:t.startsWith("_"))??(e.head==="Wildcard"||e.head==="WildcardSequence"||e.head==="WildcardOptionalSequence")}function di(e){var t;if((t=e.symbol)!=null&&t.startsWith("_"))return e.symbol;if(e.nops===1){let i=e.op1;if(e.head==="Wildcard")return`_${i}`;if(e.head==="WildcardSequence")return`__${i}`;if(e.head==="WildcardOptionalSequence")return`___${i}`}return e.head==="Wildcard"?"_":e.head==="WildcardSequence"?"__":e.head==="WildcardOptionalSequence"?"___":null}function Gr(e){if(typeof e=="string")return e.startsWith("_");if(mi(e))return!0;if(e.ops)return Gr(e.head)||e.ops.some(Gr);if(e.keys){for(let t of e.keys)if(Gr(e.getKey(t)))return!0}return!1}function bn(e,t,i){return e.startsWith("_"),e==="_"||e==="__"||e==="___"?i:e in i?t.isSame(i[e])?i:null:Gr(t)?null:{...i,[e]:t}}function be(e,t,i,r){var l;if(mi(t))return bn(di(t),e,i);let n=r.acceptVariants??!0;if(r={...r,acceptVariants:!0},t instanceof Oe){let u=(r==null?void 0:r.numericTolerance)??ln;return e instanceof Oe?u===0&&t.isSame(e)||t.isEqualWithTolerance(e,u)?i:n?ea(e,t,i,r):null:null}let a=t.string;if(a!==null)return e.string===a?i:null;let s=t.symbol;if(s!==null)return s===e.symbol?i:n?ea(e,t,i,r):null;let o=t.keys;if(o!==null){let u=e.keys;if(u===null)return null;for(let f of o){let c=be(u[f],o[f],i,r);if(c===null)return null;i=c}return i}if(t.ops){let u=r.exact??!1,f=e.engine,c=null,h=t.head;if(typeof h=="string"){if(h.startsWith("_"))c=bn(h,f.box(e.head),i),c!==null&&(c=Zr(e,t.ops,c,r));else if(h===e.head)c=(l=f.lookupFunction(h))!=null&&l.commutative?bh(e,t,i,r):Zr(e,t.ops,i,r);else if(typeof e.head=="string"&&!u){if(!n)return null;c=ea(e,t,i,r)}}else typeof e.head!="string"&&(c=be(f.box(e.head,{canonical:!1}),f.box(h,{canonical:!1}),i,r),c!==null&&(c=Zr(e,t.ops,c,r)));return c!==null&&(i=c),r.recursive&&e.ops&&(c=gh(e,t,i,{...r,acceptVariants:n})??c),c}return null}function gh(e,t,i,r){e.ops;let n=null;for(let a of e.ops){let s=be(a,t,i,r);s!==null&&(n=s,i=s)}return n}function ea(e,t,i,r){if(r.exact)return null;t.head;let n=t.head,a=e.engine,s=null,o={...r,acceptVariants:!1};if(n==="Add"){let l=be(a.box(["Add",0,e],{canonical:!1}),t,i,o);if(l!==null||(e.head==="Subtract"&&(l=be(a.box(["Add",e.op1,["Negate",e.op2]],{canonical:!1}),t,i,o)),l!==null))return l}if(n==="Subtract"){let l=be(a.box(["Subtract",e,0],{canonical:!1}),t,i,o);if(l!==null||(e.head==="Negate"&&(l=be(a.box(["Subtract",0,e.op1],{canonical:!1}),t,i,o)),l!==null))return l}if(n==="Multiply"){let l=be(a.box(["Multiply",1,e],{canonical:!1}),t,i,o);if(l!==null||e.head==="Negate"&&(l=be(a.box(["Multiply",-1,e.op1],{canonical:!1}),t,i,o),l!==null)||e.head==="Divide"&&(l=be(a.box(["Multiply",e.op1,["Divide",1,e.op2]],{canonical:!1}),t,i,o),l!==null))return l}if(n==="Divide"){let l=be(a.box(["Divide",e,1],{canonical:!1}),t,i,o);if(l!==null)return l}if(n==="Square"){let l=be(a.box(["Power",e,2],{canonical:!1}),t,i,o);if(l!==null)return l}if(n==="Exp"){let l=be(a.box(["Power",a.box("ExponentialE"),e],{canonical:!1}),t,i,o);if(l!==null)return l}if(n==="Power"){if(t.op2.numericValue===2){let l=be(a.box(["Square",e],{canonical:!1}),t,i,o);if(l!==null)return l}if(t.op2.symbol==="ExponentialE"){let l=be(a.box(["Exp",e],{canonical:!1}),t,i,o);if(l!==null)return l}}return s}function bh(e,t,i,r){let n=nh(t.ops);for(let a of n){let s=Zr(e,a,i,r);if(s!==null)return s}return null}function Zr(e,t,i,r){if(t.length===0)return e.ops&&e.ops.length===0?i:null;let n=t[0].engine,a={...i},s=[...e.ops],o=0;for(;o<t.length;){let l=t[o],u=di(l);if(u!==null)if(u.startsWith("__")){let f=0;if(t[o+1]===void 0)f=s.length+1;else{let h=!1;for(;!h&&f<s.length;)h=be(s[f],t[o+1],a,r)!==null,f+=1;if(!h&&u.startsWith("___"))return null}if(!u.startsWith("___")&&f<=1)return null;let c;if(f<=1)e.head==="Add"?c=n.Zero:e.head==="Multiply"?c=n.One:c=n.box(["Sequence"]);else if(f===2)c=s.shift();else{let h=n.lookupFunction(e.head),p=s.splice(0,f-1);h!=null&&h.associative?c=n.box([e.head,...p],{canonical:!1}):c=n.box(["Sequence",...p],{canonical:!1})}a=bn(u,c,a)}else u.startsWith("_")?a=bn(u,s.shift(),a):a=be(s.shift(),l,a,r);else{let f=s.shift();if(!f)return null;a=be(f,l,a,r)}if(a===null)return null;o+=1}return s.length>0?null:a}function Ya(e,t,i){if(br(t)||(t=e.engine.box(t,{canonical:!1})),mi(t))return{[di(t)]:e};let r={recursive:(i==null?void 0:i.recursive)??!1,exact:(i==null?void 0:i.exact)??!1,acceptVariants:!((i==null?void 0:i.exact)??!1),numericTolerance:(i==null?void 0:i.numericTolerance)??ln},n=(i==null?void 0:i.substitution)??{};return be(e,t,n,r)}var ki=class Hr extends ne{constructor(t,i,r){if(super(t,r),typeof i=="string"){if(!In(i))throw Error(`Unknown domain literal "${i}"`);this.base=i,this.ctor=null,this.params=[];return}if(!Array.isArray(i))throw Error("Expected a domain expression");if(!Mn.includes(i[0]))throw Error(`Unknown domain constructor "${i[0]}`);let n=i[0];if(this.ctor=n,n==="OptArg"||n==="VarArg")throw Error(`Unexpected domain constructor "${n}" outside of FunctionOf`);if(this.params=i.slice(1).map(a=>a instanceof ne?a.json:a),n==="FunctionOf"&&(this.base="Functions",t.strict&&Wa(this)),n==="DictionaryOf"&&(this.base="Dictionaries"),n==="ListOf"&&(this.base="Lists"),n==="TupleOf"&&(this.base="Tuples"),n==="Covariant"||n==="Contravariant"||n==="Bivariant"||n==="Invariant"){let a=t.domain(i[1]);if(this.ctor=n,this.base=a.base,this.params=[a.json],i.length!==2)throw Error(`Invalid "${n}" in domain "${i}"`)}if(n==="Union"||n==="Intersection"){let a;if(n==="Union")for(let s of this.params)a=vr(a,t.domain(s));else for(let s of this.params)a=Xa(a,t.domain(s));this.base=a.base}}get isCanonical(){return!0}get canonical(){return this}get isValid(){return!0}get json(){return this.ctor?[this.ctor,...this.params]:this.base}get hash(){return this._hash===void 0&&(this._hash=st(JSON.stringify(this.json))),this._hash}isCompatible(t,i="covariant"){let r=this.json,n=t instanceof Hr?t.json:t,a=Array.isArray(n)?n[0]:null;if(a){let s=n[1];if(a==="Covariant")return ve(r,s);if(a==="Contravariant")return ve(s,r);if(a==="Invariant")return!ve(s,r)&&!ve(r,s);if(a==="Bivariant")return ve(r,s)&&ve(s,r)}return i==="covariant"?ve(r,n):i==="contravariant"?ve(n,r):i==="bivariant"?ve(n,r)&&ve(r,n):!ve(n,r)&&!ve(r,n)}isEqual(t){return t instanceof Hr?this===t?!0:this.isCompatible(t,"invariant"):!1}isSame(t){return this.isEqual(t)}match(t,i){return br(t)||(t=this.engine.box(t,{canonical:!1})),mi(t)?{[di(t)]:this}:t instanceof Hr&&this.isCompatible(t,"invariant")?{}:null}get head(){return"Domain"}get domain(){return this.engine.domain("Domains")}get isFunction(){return this.base==="Functions"}get isNumeric(){return this.isCompatible(this.engine.domain("Numbers"))}};function Vi(e){if(e instanceof ki)return!0;if(e instanceof ne&&(e=e.json),typeof e=="string")return In(e);if(!Array.isArray(e)||e.length<=1)return!1;let t=e[0];return typeof t!="string"||!Mn.includes(t)?!1:t==="ListOf"||t==="OptArg"||t==="VarArg"?e.length===2&&Vi(e[1]):t==="FunctionOf"||t==="TupleOf"||t==="Intersection"||t==="Union"?e.slice(1).every(Vi):e.every(i=>i!==null)}function ve(e,t){let[i,r]=Wr([e],t);return!!(i&&r.length===0)}function Wr(e,t){let i=e.shift(),r=typeof t=="string"?t:null;if(r==="Anything")return[!0,e];let n=typeof i=="string"?i:null;if(n&&r)return n===r?[!0,e]:[it(n).includes(r),e];if(r){let s=i[0];return s==="FunctionOf"?[r==="Functions",e]:s==="DictionaryOf"?[r==="Dictionaries",e]:s==="ListOf"?[r==="Lists",e]:s==="TupleOf"?[r==="Tuples",e]:[!0,e]}let a=t[0];if(a==="FunctionOf"){if(n==="Functions")return[!0,e];if(n)return[!1,e];if(i[0]!=="FunctionOf")return[!1,e];if(i.length===1&&t.length===1)return[!0,e];if(!ve(i[i.length-1],t[t.length-1]))return[!1,e];let s=i.slice(1,-1),o=t.slice(1,-1);for(let l=0;l<=s.length-1;l++){if(o.length===0)return(Array.isArray(s[l])?s[l][0]:null)!=="OptArg"?[!1,e]:[!0,e];{let u=!1;if([u,o]=Wr(o,s[l]),!u)return[!1,e]}}return[o.length===0,e]}if(a==="Intersection")return[t.slice(1,-1).every(s=>ve(i,s)),e];if(a==="Union")return[t.slice(1,-1).some(s=>ve(i,s)),e];if(a==="OptArg")return n==="NothingDomain"?[!0,e]:Wr([i,...e],t[1]);if(a==="VarArg"){let s=t[1];if(!ve(i,s))return[!1,e];i=e.shift();let o=!0;for(;e.length>0&&o;)[o,e]=Wr(e,s),i=e.shift();return[!0,e]}if(a==="TupleOf"){if(!Array.isArray(i)||i[0]!=="TupleOf")return[!1,e];if(i.length>t.length)return[!1,e];for(let s=1;s<=t.length-1;s++)if(!i[s]||!ve(i[s],t[s]))return[!1,e];return[!0,e]}return console.error("Unexpected domain constructor "+a),[!1,e]}function vr(e,t){if(e==null)return t;if(t==null)return e;let i=[e.base,...it(e.base)],r=[t.base,...it(t.base)];for(;!r.includes(i[0]);)i.shift();return e.engine.domain(i[0])}function Xa(e,t){return e===void 0?t:t===void 0||ve(e.base,t.base)?e:ve(t.base,e.base)?t:e.engine.Void}var vh=me(de(),1),gl=class{constructor(e,t){this.terms=[],this.engine=e;for(let i of t)this.add(i)}sub(e){this.add(e,[-1,1])}add(e,t){t??(t=[1,1]);let[i,r]=At(e);if(i=ee(i,t),Gt(i))return;if(r.head==="Add"){for(let a of r.ops)this.add(a,i);return}if(r.head==="Negate"){this.add(r.op1,at(i));return}let n=this.find(r);if(n>=0){this.terms[n].coef=Sa(this.terms[n].coef,i);return}this.terms.push({coef:i,term:r})}find(e){return this.terms.findIndex(t=>t.term.isSame(e))}reduceNumbers({exact:e}={exact:!0}){let t=this.engine,i=this.terms;this.terms=[];let r=0,n=0,a=0,s=0,o=[0,1],l=t._BIGNUM_ZERO;for(let{coef:u,term:f}of i){if(f.isNaN){this.terms=[{term:t.NaN,coef:[1,1]}];return}if(f.isFinite===!1){f.isPositive?r++:n++;continue}if(f.numericValue!==null){let c=ch(f.numericValue,u);if(c!==null){Se(c)?o=Sa(o,c):c instanceof Bt?l=l.add(c):c instanceof vh.default?(K(t)?l=l.add(c.re):a+=c.re,s+=c.im):K(t)?l=l.add(c):a+=c;continue}}this.terms.push({coef:u,term:f})}if(r>0&&n>0){this.terms=[{term:t.NaN,coef:[1,1]}];return}if(r>0){this.terms=[{term:t.PositiveInfinity,coef:[1,1]}];return}if(n>0){this.terms=[{term:t.NegativeInfinity,coef:[1,1]}];return}if(!e||!Number.isInteger(a)||!l.isInteger()||!Number.isInteger(s)){if(!l.isZero()&&K(t)){l=l.add(a),l=l.add(t.bignum(o[0]).div(t.bignum(o[1]))),this.terms.push({term:t.number(l),coef:[1,1]}),s!==0&&this.terms.push({term:t.number(t.complex(0,s)),coef:[1,1]});return}let u=a+l.toNumber()+Number(o[0])/Number(o[1]);s!==0?this.terms.push({term:t.number(t.complex(u,s)),coef:[1,1]}):u!==0&&this.terms.push({term:t.number(u),coef:[1,1]});return}l.isZero()||(l=l.add(a),a=0,Gt(o)||(l=l.add(t.bignum(o[0]).div(t.bignum(o[1]))),o=[0,1]),this.terms.push({coef:[1,1],term:t.number(l)})),s!==0?(Gt(o)||(a+=Number(o[0])/Number(o[1])),this.terms.push({coef:[1,1],term:t.number(t.complex(a,s))})):a!==0&&this.terms.push({coef:[1,1],term:t.number(a)}),Gt(o)||this.terms.push({coef:[1,1],term:t.number(o)})}asExpression(){let e=this.engine,t=this.terms.filter(({coef:i,term:r})=>!Gt(i)&&!r.isZero);if(t.length===0)return e.Zero;if(t.length===1){let{coef:i,term:r}=t[0];return Ne(i)?r:Ha(i)?e.neg(r):e.mul(e.number(i),r)}return e.function("Add",t.map(({coef:i,term:r})=>e.mul(e.number(i),r)))}};function hr(e,t){if(t.every(i=>i.isCanonical),t=t.filter(i=>i.numericValue===null||!i.isZero),t.length===0)return e.Zero;if(t.length===1&&!tl(t[0]))return t[0];if(t.length===2){let i=0,r=N(t[0]);if(r!==null&&r!==0?i=vn(t[1]):(i=vn(t[0]),i!==0&&t[1].numericValue!==null&&(r=N(t[1]))),r!==null&&i!==null&&i!==0)return e.number(e.complex(r,i))}return t.length===1?t[0]:e._fn("Add",pl(t))}function xh(e,t){let i=null;for(let r of t){if(!(r!=null&&r.isNumeric))return null;i=vr(i,r)}return i}function bl(e,t){let i=new gl(e,[]);for(let r of t){if(r=r.simplify(),r.isImaginary&&r.isInfinity)return e.ComplexInfinity;if(r.isNaN||r.symbol==="Undefined")return e.NaN;i.add(r)}return i.reduceNumbers({exact:!0}),i.asExpression()}function yh(e){let t=0;for(let i of e){let r=i.numericValue;if(typeof r=="number")t+=r;else return null}return t}function Ia(e,t,i="evaluate"){if(i==="N"&&e.numericMode==="machine"){t=t.map(a=>a.N());let n=yh(t);if(n!==null)return e.number(n)}for(let n of t){if(n.isImaginary&&n.isInfinity)return e.ComplexInfinity;if(n.isNaN||n.symbol==="Undefined")return e.NaN;n.numericValue!==null&&!n.isExact&&(i="N")}i==="N"?t=t.map(n=>n.N()):t=t.map(n=>n.evaluate());let r=new gl(e,t);return i==="N"?r.reduceNumbers():r.reduceNumbers({exact:!0}),r.asExpression()}function Nh(e,t,i){var o;e.pushScope(),t??(t=e.error("missing"));var r=void 0;if(i&&i.ops&&((o=i.ops[0])==null?void 0:o.head)==="Delimiter"){var n=al(i);if(!n)return null;var a=[t.canonical];n.forEach(l=>{a.push(l)}),r=e._fn("Sum",a)}else{var s=Ei(i);r=s?e._fn("Sum",[t.canonical,s]):e._fn("Sum",[t.canonical])}return e.popScope(),r}function ta(e,t,i){let r=t[0],n=[];if(t){n=[];for(let p=1;p<t.length;p++)n.push(t[p])}let a=null;if((n==null?void 0:n.length)===0){let p=i==="simplify"?r.simplify():r.evaluate({numericMode:i==="N"});if(K(e)){let m=e.bignum(0);for(let d of ce(p)){let b=Yt(d);if(b===null){a=void 0;break}if(b.isFinite()===!1){m=b;break}m=m.add(b)}a===null&&(a=e.number(m))}else{let m=0;for(let d of ce(p)){let b=N(d);if(b===null){a=void 0;break}if(b===null||!Number.isFinite(b)){m=b;break}m+=b}a===null&&(a=e.number(m))}return a??void 0}var s=[];let o=[],l=[],u=[];n.forEach(p=>{let[m,d,b,y]=On(p.evaluate());m&&(s.push(m),o.push(d),l.push(b),u.push(y))});let f=r,c=e.swapScope(f.scope);e.pushScope(),f.bind();for(let p=0;p<s.length;p++){let m=s[p],d=o[p],b=l[p];if(d>=b||i==="simplify"&&b-d>=_a)return;if(i==="evaluate"&&b-d>=_a&&(i="N"),i==="simplify"){let y=[];for(let _=d;_<=b;_++)e.assign(m,_),y.push(f.simplify());a=e.add(...y).simplify()}}let h=[];if(s.length>1)for(let p=0;p<s.length-1;p++)h.length===0?h=pn(Ht(o[p],l[p]),Ht(o[p+1],l[p+1])):h=pn(h.map(m=>m[0]),Ht(o[p+1],l[p+1]));else h=Ht(o[0],l[0]).map(p=>[p]);if(i==="evaluate"){let p=[];for(let m of h)s.map((d,b)=>(e.assign(d,m[b]),d)),p.push(f.evaluate());a=e.add(...p).evaluate()}for(let p=0;p<s.length;p++)e.assign(s[p],void 0);if(i==="N")for(let p=0;p<s.length;p++){let m=s[p],d=o[p],b=l[p],y=u[p];if(a===null&&y)if(K(e)){let _=e.bignum(0);for(let S=d;S<=b;S++){e.assign(m,S);let k=Yt(f.N());if(k===null){a=void 0;break}if(k.isFinite()===!1){_=k;break}_=_.add(k)}a===null&&(a=e.number(_))}else{let _=e.numericMode,S=e.precision;e.numericMode="machine";let k=0;for(let C=d;C<=b;C++){e.assign(m,C);let P=N(f.N());if(P===null){a=void 0;break}if(!Number.isFinite(P)){k=P;break}k+=P}e.numericMode=_,e.precision=S,a===null&&(a=e.number(k))}else if(a===null){e.assign(m,1e3);let _=f.N();e.assign(m,999);let S=f.N(),k=N(e.div(_,S).N());if(k!==null&&Number.isFinite(k)&&Math.abs(k)>1)a=e.PositiveInfinity;else{let C=0,P=e.numericMode,se=e.precision;e.numericMode="machine";for(let we=d;we<=b;we++){e.assign(m,we);let Y=N(f.N());if(Y===null){a=void 0;break}if(Math.abs(Y)<Number.EPSILON||!Number.isFinite(Y))break;C+=Y}e.numericMode=P,e.precision=se,a===null&&(a=e.number(C))}}}return e.popScope(),e.swapScope(c),a??void 0}function vn(e){if(e.symbol==="ImaginaryUnit")return 1;let t=e.numericValue;if(t!==null&&t instanceof Qf.default&&t.re===0)return t.im;if(e.head==="Negate")return-vn(e.op1);if(e.head==="Multiply"&&e.nops===2){if(e.op1.symbol==="ImaginaryUnit")return N(e.op2)??0;if(e.op2.symbol==="ImaginaryUnit")return N(e.op1)??0}if(e.head==="Divide"){let i=vn(e.op1),r=N(e.op2);return r===null?0:i/r}return 0}var _h=me(de(),1);function vl(e){let t=e.numericValue;return t===null?null:(typeof t=="number"?t=-t:t instanceof T||t instanceof _h.Complex?t=t.neg():Array.isArray(t)&&(t=at(t)),e.engine.number(t))}function Qr(e){let t=-1;for(;e.head==="Negate";)e=e.op1,t=-t;if(t===1)return e;if(e.numericValue!==null)return vl(e);let i=e.engine;if(e.head==="Subtract")return i.add(e.op2,Qr(e.op1));if(e.head==="Add"){let r=e.ops.map(n=>Qr(n));return i.add(...r)}return e.head==="Multiply"?Sh(i,e.ops):e.head==="Divide"?i.div(Qr(e.op1),e.op2):i._fn("Negate",[e])}function Ze(e){let t=-1;for(;e.head==="Negate";)e=e.op1,t=-t;if(t===1)return e;let i=e.engine;if(e.head==="Add"){let r=e.ops.map(n=>Ze(n));return hr(i,De(Ae(r),"Add"))}return e.numericValue!==null?vl(e):i._fn("Negate",[e])}function Sh(e,t){let i=[],r=!1;for(let n of t)!r&&n.head==="Negate"?(r=!0,i.push(n.op1)):i.push(n);if(r)return e.mul(...i);i=[];for(let n of t)r||n.numericValue===null||!n.isInteger?i.push(n):(r=!0,i.push(Ze(n)));if(r)return e.mul(...i);i=[];for(let n of t)r||n.numericValue===null||!n.isNumber?i.push(n):(r=!0,i.push(Ze(n)));return r?e.mul(...i):e._fn("Negate",[e._fn("Multiply",t)])}function ia(e,t,i="simplify"){return Ze(t)}function ct(e,t){if(e.head==="Negate"&&t.head==="Negate")return ct(e.op1,t.op1);if(e.head==="Negate")return Ze(ct(e.op1,t));if(t.head==="Negate")return Ze(ct(e,t.op1));let i=e.engine;if(e.head==="Divide"&&t.head==="Divide"){let r=i.mul(e.op2,t.op2);return i.div(ct(e.op1,t.op1),r)}return e.head==="Divide"?i.div(ct(e.op1,t),e.op2):t.head==="Divide"?i.div(ct(e,t.op1),t.op2):e.head==="Add"?i.add(...e.ops.map(r=>ct(r,t))):t.head==="Add"?i.add(...t.ops.map(r=>ct(e,r))):i.mul(e,t)}function ar(e){return e.length===1?e[0]:e.length===2?ct(e[0],e[1]):ct(e[0],ar(e.slice(1)))}var Zi=[[1],[1,1],[1,2,1],[1,3,3,1],[1,4,6,4,1],[1,5,10,10,5,1],[1,6,15,20,15,6,1],[1,7,21,35,35,21,7,1],[1,8,28,56,70,56,28,8,1]];function wh(e,t){for(;e>=Zi.length;){let i=Zi.length,r=[1],n=Zi[i-1];for(let a=1;a<i;a++)r[a]=n[a-1]+n[a];r[i]=1,Zi.push(r)}return Zi[e][t]}function kh(e){let t=e.reduce((r,n)=>r+n,0),i=1;for(let r=0;r<e.length;r+=1)i*=wh(t,e[r]),t-=e[r];return i}function*xl(e,t){if(e===1){yield[t];return}for(let i=0;i<=t;i+=1)for(let r of xl(e-1,t-i))yield[i,...r]}function yl(e){if(e.head!=="Power")return null;let t=W(e.op2);if(t===null||t<0)return null;if(t===0)return e.engine.One;if(t===1)return ei(e.op1);let i=e.engine;if(e.op1.head==="Negate"){let s=t%2===0?1:-1,o=yl(i._fn("Power",[e.op1.op1,e.op2]));return o===null?null:s>0?o:i.neg(o)}if(e.op1.head,e.op1.head!=="Add")return null;let r=e.op1.ops,n=xl(r.length,t),a=[];for(let s of n){let o=[i.number(kh(s))];for(let l=0;l<s.length;l+=1)s[l]!==0&&(s[l]===1?o.push(r[l]):o.push(i.pow(r[l],s[l])));a.push(i.mul(...o))}return i.add(...a)}function Nl(e){if(e.head&&e.ops){let t=e.ops.map(r=>Nl(r)??r),i=e.engine.box([e.head,...t]);return ei(i)??i}return null}function Th(e){if(e.head!=="Divide")return null;let t=ei(e.op1);if(t===null)return null;let i=e.engine;return t.head==="Add"?i.add(...t.ops.map(r=>i.div(r,e.op2))):e.engine.div(t,e.op2)}function ei(e){if(!e)return null;let t=Th(e);if(t!==null||e.head==="Multiply"&&(t=ar(e.ops),t!==null))return t;if(e.head==="Add"){let i=e.ops.map(r=>ei(r)??r);return bl(e.engine,i)}return e.head==="Negate"&&(t=ei(e.op1),t!==null)?e.engine.neg(t):e.head==="Power"&&(t=yl(e),t!==null)?t:null}var Eh=[{match:["Multiply","_x","__a"],replace:0,id:"ax",condition:({__a:e})=>!e.has("_x")},{match:["Add",["Divide","_a","_x"],"__b"],replace:1/0,condition:({_a:e,__b:t})=>!e.has("_x")&&!t.has("_x")},{match:["Add",["Multiply","_x","__a"],"__b"],replace:["Divide",["Negate","__b"],"__a"],condition:({__a:e,__b:t})=>!e.has("_x")&&!t.has("_x")},{match:["Add",["Multiply","_a",["Power","_x","_n"]],"__b"],replace:["Divide",["Power",["Negate","__b"],["Divide",1,"_n"]],"_a"],condition:({_a:e,__b:t,_n:i})=>!e.has("_x")&&!t.has("_x")&&!i.isZero},{match:["Add",["Multiply","__a",["Power","_x",2]],["Multiply","__b","_x"],"__c"],replace:["Divide",["Add",["Negate","__b"],["Sqrt",["Subtract",["Square","__b"],["Multiply",4,"__a","__c"]]]],["Multiply",2,"__a"]],condition:({__a:e,__b:t,__c:i})=>!e.has("_x")&&!t.has("_x")&&!i.has("_x")},{match:["Add",["Multiply","__a",["Power","_x",2]],["Multiply","__b","_x"],"__c"],replace:["Divide",["Subtract",["Negate","__b"],["Sqrt",["Subtract",["Square","__b"],["Multiply",4,"__a","__c"]]]],["Multiply",2,"__a"]],condition:({__a:e,__b:t,__c:i})=>!e.has("_x")&&!t.has("_x")&&!i.has("_x")},{match:["Add",["Multiply","__a",["Exp",["Multiply","__b","_x"]]],"__c"],replace:["Divide",["Ln",["Negate",["Divide","__c","__a"]]],"__b"],condition:({__a:e,__c:t},i)=>((!e.isZero&&i.div(t,e).isNegative)??!1)&&!e.has("_x")&&!t.has("_x")},{match:["Add",["Multiply","__a",["Exp","_x"]],"__c"],replace:["Ln",["Negate",["Divide","__c","__a"]]],condition:({__a:e,__c:t},i)=>((!e.isZero&&i.div(t,e).isNegative)??!1)&&!e.has("_x")&&!t.has("_x")}];function _l(e,t){let i=e.engine;e.head==="Equal"&&(e=i.add(e.op1.canonical,i.neg(e.op2.canonical)).simplify());let r=i.cache("univariate-roots-rules",()=>An(i,Eh)),n=[e.subs({[t]:"_x"},{canonical:!1})],a=n.flatMap(s=>Lr(s,r,{_x:i.symbol("_x")}));return a.length===0&&(n=n.flatMap(s=>Js(s)),a=n.flatMap(s=>Lr(s,r,{_x:i.symbol(t)}))),a.length===0&&(n=n.flatMap(s=>ei(s.canonical)).filter(s=>s!==null),n=n.flatMap(s=>Js(s)),a=n.flatMap(s=>Lr(s,r,{_x:i.symbol(t)}))),a.map(s=>s.evaluate().simplify())}var Ah=[{match:["Add",["Abs",["Add",["Multiply","__a","_x"],"__b"]],"__c"],replace:["Add",["Multiply","__a","_x"],"__b","__c"]},{match:["Add",["Abs",["Add",["Multiply","__a","_x"],"__b"]],"__c"],replace:["Add",["Negate",["Multiply","__a","_x"]],["Negate","__b"],"__c"]},{match:["Multiply","__a",["Power","_b","_n"]],replace:"_b",condition:({__a:e,_b:t,_n:i})=>!e.has("_x")&&t.has("_x")&&!i.isZero&&!i.has("_x")},{match:["Multiply","__a",["Sqrt","_b"]],replace:["Multiply",["Square","_a"],"__b"],condition:({_b:e})=>e.has("_x")},{match:["Divide","_a","_b"],replace:"_a",condition:({_a:e,_b:t})=>e.has("_x")&&!t.isZero},{match:["Multiply","__a","_b"],replace:"_b",condition:({__a:e,_b:t})=>!e.has("_x")&&t.has("_x")},{match:["Add",["Ln","_a"],["Ln","_b"],"__c"],replace:["Add",["Ln",["Multiply","_a","_b"]],"__c"]},{match:["Multiply",["Exp","__a"],["Exp","__b"],"__c"],replace:["Multiply",["Exp",["Add","_a","_b"]],"__c"]},{match:["Ln","_a"],replace:["Subtract","_a",1],condition:({_a:e})=>e.has("_x")},{match:["Sin","_a"],replace:"_a",condition:({_a:e})=>e.has("_x")},{match:["Cos","_a"],replace:["Subtract","_a",["Divide","Pi",2]],condition:({_a:e})=>e.has("_x")},{match:["Tan","_a"],replace:"_a",condition:({_a:e})=>e.has("_x")},{match:["Add",["Sin","_a"],["Cos","_a"]],replace:1,condition:({_a:e})=>e.has("_x")},{match:["Subtract",["Square",["Sin","_a"]],["Square",["Cos","_a"]]],replace:["PlusMinus",["Sin","_a"],["Divide",["Sqrt",2],2]],condition:({_a:e})=>e.has("_x")}];function Js(e){let t=e.engine,i=t.cache("univariate-roots-rules",()=>An(t,Ah));return Lr(e,i,{_x:t.symbol("_x")})}function Mh(e){return e.head==="Element"?qh(e):e.head==="Equal"?Ih(e):Wf(e)?Oh(e):"not-a-predicate"}function Ih(e){var n;e.head;let t=e.unknowns;if(t.length===0){let a=e.evaluate();return a.symbol==="True"?"tautology":a.symbol==="False"?"contradiction":(e.canonical.evaluate(),"not-a-predicate")}let i=e.engine,r=e.op1.symbol;if(r&&!Dh(i,r)&&!e.op2.has(r)){let a=e.op2.evaluate();if(!a.isValid)return"not-a-predicate";let s=i.lookupSymbol(r);return s?s.domain&&!((n=a.domain)!=null&&n.isCompatible(s.domain))?"contradiction":(s.value=a,"ok"):(i.defineSymbol(r,{value:a,domain:a.domain}),"ok")}if(t.length===1){let a=t[0],s=_l(e,a);s.length===0&&i.assumptions.set(i.box(["Equal",i.add(e.op1.canonical,i.neg(e.op2.canonical)).simplify(),0]),!0);let o=s.length===1?s[0]:i.box(["List",...s]),l=i.lookupSymbol(a);return l?l.domain&&!s.every(u=>{var f;return!u.domain||((f=o.domain)==null?void 0:f.isCompatible(u.domain))})?"contradiction":(l.value=o,"ok"):(i.defineSymbol(a,{value:o,domain:o.domain}),"ok")}return i.assumptions.set(e,!0),"ok"}function Oh(e){let t=e.engine;if(e.op1.symbol&&!es(t,e.op1.symbol))return e.op2.evaluate().isZero?e.head==="Less"?t.defineSymbol(e.op1.symbol,{domain:t.domain("NegativeNumbers")}):e.head==="LessEqual"?t.defineSymbol(e.op1.symbol,{domain:t.domain("NonPositiveNumbers")}):e.head==="Greater"?t.defineSymbol(e.op1.symbol,{domain:t.domain("PositiveNumbers")}):e.head==="GreaterEqual"&&t.defineSymbol(e.op1.symbol,{domain:t.domain("NonNegativeNumbers")}):(t.defineSymbol(e.op1.symbol,{domain:t.domain("ExtendedRealNumbers")}),t.assumptions.set(e,!0)),"ok";let i="",r,n;if(e.head==="Less"?(r=e.op1,n=e.op2,i="<"):e.head==="LessEqual"?(r=e.op1,n=e.op2,i="<="):e.head==="Greater"?(r=e.op2,n=e.op1,i="<"):e.head==="GreaterEqual"&&(r=e.op2,n=e.op1,i="<="),!i)return"internal-error";let a=t.add(r.canonical,t.neg(n.canonical)).simplify(),s=t.box([i==="<"?"Less":"LessEqual",a,0]).evaluate();if(s.symbol==="True")return"tautology";if(s.symbol==="False")return"contradiction";let o=s.unknowns;return o.length===0?"not-a-predicate":(o.length===1&&(t.lookupSymbol(o[0])||t.defineSymbol(o[0],{domain:"ExtendedRealNumbers"})),s.head==="Less"||s.head,t.assumptions.set(s,!0),"ok")}function qh(e){var n,a;e.head;let t=e.engine,i=Fh(e.op1);if(i.length===1){let s=t.domain(e.op2.evaluate().json);return s.isValid?(t.declare(i[0],s),"ok"):"not-a-predicate"}if(e.op1.symbol&&es(t,e.op1.symbol)){let s=t.domain(e.op2.evaluate().json);if(!s.isValid)return"not-a-predicate";(a=(n=t.context)==null?void 0:n.ids)!=null&&a.has(e.op1.symbol)||t.declare(e.op1.symbol,s);let o=t.lookupSymbol(e.op1.symbol);if(o)return o.domain&&!s.isCompatible(o.domain)?"contradiction":(o.domain=s,"ok");let l=t.lookupFunction(e.op1.symbol);return l?s.isCompatible(el(t,l.signature))?"ok":"contradiction":"not-a-predicate"}if(i.length>0)return t.assumptions.set(e,!0),"ok";let r=e.evaluate();return r.symbol==="True"?"tautology":r.symbol==="False"?"contradiction":"not-a-predicate"}function es(e,t){return(e.lookupSymbol(t)??e.lookupFunction(t))!==void 0}function Fh(e){return e.symbols.filter(t=>!es(e.engine,t))}function Dh(e,t){var i;return e.lookupFunction(t)?!1:((i=e.lookupSymbol(t))==null?void 0:i.value)!==void 0}var ts=me(de(),1),is=class oi extends ne{constructor(t,i,r){r??(r={}),super(t,r.metadata),this._value=new Map;let n=r.canonical??!0;if(i instanceof Map)for(let[a,s]of i)this._value.set(a,t.box(s,{canonical:n}));else for(let a of Object.keys(i))this._value.set(a,t.box(i[a],{canonical:n}));t._register(this)}bind(){for(let[t,i]of this._value)i.bind()}reset(){for(let[t,i]of this._value)i.reset()}get hash(){let t=st("Dictionary");for(let[i,r]of this._value)t^=st(i)^r.hash;return t}get complexity(){return 97}get head(){return"Dictionary"}get isPure(){return!1}getKey(t){return this._value.get(t)}hasKey(t){return this._value.has(t)}get keys(){return this._value.keys()}get keysCount(){return this._value.size}has(t){for(let[i,r]of this._value)if(r.has(t))return!0;return!1}get domain(){return this.engine.domain("Dictionaries")}get json(){if(this.engine.jsonSerializationOptions.shorthands.includes("dictionary")){let i={};for(let r of this._value.keys())i[r]=this._value.get(r).json;return{dict:i}}let t=[];for(let i of this._value.keys())t.push(this.engine._fn("KeyValuePair",[this.engine.string(i),this._value.get(i)]));return V(this.engine,"Dictionary",t,{latex:this._latex})}isSame(t){if(this===t)return!0;if(!(t instanceof oi)||this._value.size!==t._value.size)return!1;for(let[i,r]of this._value){let n=t.getKey(i);if(!n||!r.isSame(n))return!1}return!0}match(t,i){if(br(t)||(t=this.engine.box(t,{canonical:!1})),mi(t))return{[di(t)]:this};if(!(t instanceof oi)||this._value.size!==t._value.size)return null;let r={};for(let[n,a]of this._value){let s=t.getKey(n);if(!s)return null;let o=a.match(s,i);if(o===null)return null;r={...r,...o}}return r}isEqual(t){if(this===t)return!0;if(!(t instanceof oi)||!t.keys||this._value.size!==t._value.size)return!1;for(let[i,r]of this._value){let n=t.getKey(i);if(!n||!r.isEqual(n))return!1}return!0}evaluate(t){return this}get isCanonical(){return this._isCanonical}set isCanonical(t){this._isCanonical=t}get canonical(){return this.isCanonical?this:new oi(this.engine,this._value,{canonical:!0})}simplify(t){return this}N(t){return this}replace(t,i){let r=0,n={};for(let a of this.keys){let s=this.getKey(a),o=s.replace(t,i);o!==null&&(r+=1),n[a]=o??s}return r===0?null:new oi(this.engine,n)}subs(t,i){let r={};for(let n of this.keys)r[n]=this.getKey(n).subs(t,i);return new oi(this.engine,r,i)}},Ch=me(de(),1),Ph=[];function Sl(e){if(e.head==="N"&&typeof e.op1.head=="string"){let n={Integrate:"NIntegrate",Limit:"NLimit"}[e.op1.head];n&&(e=e.engine._fn(n,e.op1.ops))}if(e.head==="Function")return e;let t=e.unknowns;t.includes("_")&&(e=e.subs({_:"_1"}),t=e.unknowns);let i=0;for(let n of t)if(n.startsWith("_")){let a=Number(n.slice(1));a>i&&(i=a)}let r=e.engine;return r._fn("Function",[e,...Array.from({length:i},(n,a)=>r.symbol(`_${a+1}`))])}function rs(e){let t=e.engine,i=e.symbol?t.lookupFunction(e.symbol):void 0;if(i){let o=i.signature.N??i.signature.evaluate;return o?l=>o(t,l)??t._fn(e,l):l=>t._fn(e,l)}let r=Sl(e);if(!r)return;r.head;let n=r.ops.slice(1).map(o=>o.symbol??"Nothing");t.pushScope();for(let o of n)t.declare(o,{inferred:!0,domain:void 0});let a=r.op1.canonical;a.bind(),t.popScope();let s=a.scope;return n.length===0?()=>{let o=t.swapScope(s);t.resetContext();let l=a.N()??a.evaluate();return t.swapScope(o),l}:o=>{if(t.strict&&(o=et(t,o,n.length),!o.every(c=>c.isValid)))return;o=o.map(c=>c.evaluate());let l=t.swapScope(s);t.resetContext();let u=0;for(let c of n)t.assign(c,o[u++]);let f=a.N()??a.evaluate();if(t.swapScope(l),!!f.isValid)return f}}function xn(e,t){var i;return((i=rs(e))==null?void 0:i(t))??e.engine._fn(e,t)}function yn(e){return rs(e)??(t=>e.engine._fn(e.N(),t).N())}function Ks(e){let t=e.engine,i=rs(e);return i?r=>{var n;return((n=i([t.number(r)]))==null?void 0:n.value)??NaN}:r=>t._fn(e.evaluate(),[t.number(r)]).value}function Ys(e){let t=e.match(/(.+)\((.*)\)/);if(!t)return[e,void 0];let i=t[1],r=t[2].split(",").map(n=>n.trim());return[i,r]}function wt(e,t,i){if(!t.isValid||!i.isValid)return e._fn("Divide",[t,i]);if(t.head==="Negate"&&i.head==="Negate"&&(t=t.op1,i=i.op1),t.numericValue!==null&&i.numericValue!==null){if(i.isOne)return t;if(i.isNegativeOne)return e.neg(t);if(t.isOne)return e.inv(i);if(t.isNegativeOne)return e.neg(e.inv(i));let p=X(t),m=X(i);if(p&&m&&!Gt(m))return e.number(ee(p,Li(m)))}if(t.head==="Divide"&&i.head==="Divide")return wt(e,e.mul(t.op1,i.op2),e.mul(t.op2,i.op1));if(t.head==="Divide")return wt(e,e.mul(t.op1,i),t.op2);if(i.head==="Divide")return wt(e,e.mul(t,i.op2),i.op1);let r=t.numericValue;if(r!==null){if(re(r)){let[p,m]=r;return wt(e,e.number(p),e.mul(e.number(m),i))}if(_e(r)){let[p,m]=r;return wt(e,e.number(p),e.mul(e.number(m),i))}}let n=i.numericValue;if(n!==null){if(re(n)){let[p,m]=n;return wt(e,e.mul(t,e.number(m)),e.number(p))}if(_e(n)){let[p,m]=n;return wt(e,e.mul(t,e.number(m)),e.number(p))}}let[a,s]=At(t),[o,l]=At(i);if(!Ne(a)||!Ne(o)){let[p,m]=Pf(a,o),[d,b]=[e.mul(e.number(p),s),e.mul(e.number(m),l)];return b.isNegative&&(b=e.neg(b),d=e.neg(d)),b.head==="Negate"&&(b=b.op1,d=e.neg(d)),d.isZero?e.Zero:b.isOne?d:e._fn("Divide",[d,b])}let[u,f]=Ls(t),[c,h]=Ls(i);return f=f.canonical,h=h.canonical,h.numericValue!==null&&h.isOne?u*c<0?Ze(f):f:u*c>0?e._fn("Divide",[f,h]):f.numericValue?e._fn("Divide",[Ze(f),h]):Ze(e._fn("Divide",[f,h]))}function Oa(e,t,i){if(t.numericValue!==null&&i.numericValue!==null){let r=X(t),n=X(i);if(r&&n&&!Gt(n))return e.number(ee(r,Li(n)))}return new qn(e,[t,e.inv(i)]).asRationalExpression()}function wl(e,t,i){let r=Oa(e,t,i);return(r==null?void 0:r.head)==="Divide"&&(!r.op1.isExact||!r.op2.isExact)&&(r=hn(t,i,(n,a)=>n/a,(n,a)=>n.div(a),(n,a)=>n.div(a))??r),r!==void 0?r:e._fn("Divide",[t,i])}function qa(e,t){if(t.every(s=>s.isCanonical),t.length===0)return e.One;if(t.length===1)return t[0];let i=[],r=1,n,a=0;for(let s of t)if(!s.isOne){if(s.isNegativeOne){r=-r;continue}if(s.head==="Negate"){r=-r,i.push(s.op1);continue}if(n===void 0&&typeof s.numericValue=="number"){n=s.numericValue,n<0&&(r=-r,n=-n);continue}if(s.numericValue!==null&&s.isNegative){r=-r,i.push(e.neg(s));continue}if(s.symbol==="ImaginaryUnit"){a++;continue}i.push(s)}return a>0&&(a%2===0?r=-r:(i.push(e.number(e.complex(0,r*(n??1)))),r=1,n=void 0)),typeof n=="number"&&(i.push(e.number(r*n)),r=1),r<0?i.length===0?e.NegativeOne:i.length===1?e.neg(i[0]):e.neg(e._fn("Multiply",i.sort(Xt))):i.length===0?e.One:i.length===1?i[0]:e._fn("Multiply",i.sort(Xt))}function $h(e,t){t.every(r=>r.head!=="Multiply");let i=new qn(e);for(let r of t){if(r=r.simplify(),r.isNaN||r.symbol==="Undefined")return e.NaN;i.addTerm(r)}return i.asExpression()}function Fa(e,t,i="evaluate"){if(t.length===1)return t[0];if(i==="N"&&(t=t.map(r=>r.N()),(e.numericMode==="machine"||e.numericMode==="auto")&&t.every(r=>typeof r.numericValue=="number"))){let r=1;for(let n of t)r*=n.numericValue;return e.number(r)}for(let r of t){if(r.isNaN||r.symbol==="Undefined")return e.NaN;r.numericValue!==null&&!r.isExact&&(i="N")}return t.every(r=>r.head!=="Multiply"),i==="N"?t=t.map(r=>r.N()):t=t.map(r=>r.evaluate()),new qn(e,t).asExpression(i)}function Vh(e,t,i){var o;e.pushScope(),t??(t=e.error("missing"));var r=void 0;if(i&&i.ops&&((o=i.ops[0])==null?void 0:o.head)==="Delimiter"){var n=al(i);if(!n)return null;var a=[t.canonical];n.forEach(l=>{a.push(l)}),r=e._fn("Product",a)}else{var s=Ei(i);r=s?e._fn("Product",[t.canonical,s]):e._fn("Product",[t.canonical])}return e.popScope(),r}function ra(e,t,i){let r=t[0],n=[];if(t){n=[];for(let p=1;p<t.length;p++)n.push(t[p])}let a=null;if((n==null?void 0:n.length)===0){let p=i==="simplify"?r.simplify():r.evaluate({numericMode:i==="N"});if(K(e)){let m=e.bignum(1);for(let d of ce(p)){let b=Yt(d);if(b===null){a=void 0;break}if(b.isFinite()===!1){m=b;break}m=m.mul(b)}a===null&&(a=e.number(m))}else{let m=1;for(let d of ce(p)){let b=N(d);if(b===null){a=void 0;break}if(b===null||!Number.isFinite(b)){m=b;break}m*=b}a===null&&(a=e.number(m))}return a??void 0}var s=[];let o=[],l=[],u=[];n.forEach(p=>{let[m,d,b,y]=On(p.evaluate());m&&(s.push(m),o.push(d),l.push(b),u.push(y))});let f=r,c=e.swapScope(f.scope);e.pushScope(),f.bind();for(let p=0;p<s.length;p++){let m=s[p],d=o[p],b=l[p];if(d>=b||i!=="N"&&(d>=b||b-d>=_a))return;if(i==="simplify"){let y=[];for(let _=d;_<=b;_++)e.assign({[m]:_}),y.push(f.simplify());a=e.mul(...y).simplify()}}let h=[];if(s.length>1)for(let p=0;p<s.length-1;p++)h.length===0?h=pn(Ht(o[p],l[p]),Ht(o[p+1],l[p+1])):h=pn(h.map(m=>m[0]),Ht(o[p+1],l[p+1]));else h=Ht(o[0],l[0]).map(p=>[p]);if(i==="evaluate"){let p=[];for(let m of h)s.map((d,b)=>(e.assign(d,m[b]),d)),p.push(f.evaluate());a=e.mul(...p).evaluate()}if(i==="N")for(let p=0;p<s.length;p++){let m=s[p],d=o[p],b=l[p],y=u[p];if(a===null&&y){if(K(e)){let C=e.bignum(1);for(let P=d;P<=b;P++){e.assign({[m]:P});let se=Yt(f.N());if(se===null||se.isFinite()===!1){a=se!==null?e.number(se):void 0;break}C=C.mul(se)}a===null&&(a=e.number(C))}let _=1,S=e.numericMode,k=e.precision;e.numericMode="machine";for(let C=d;C<=b;C++){e.assign({[m]:C});let P=N(f.N());if(P===null||!Number.isFinite(P)){a=P!==null?e.number(P):void 0;break}_*=P}e.numericMode=S,e.precision=k,a===null&&(a=e.number(_))}if(a===null){e.assign({[m]:1e3});let _=f.N();e.assign({[m]:999});let S=f.N(),k=N(e.div(_,S).N());if(k!==null&&Number.isFinite(k)&&Math.abs(k)>1)a=e.PositiveInfinity;else{let C=1,P=e.numericMode,se=e.precision;e.numericMode="machine";for(let we=d;we<=b;we++){e.assign({[m]:we});let Y=N(f.N());if(Y===null){a=void 0;break}if(Math.abs(1-Y)<Number.EPSILON||!Number.isFinite(Y))break;C*=Y}a===null&&(a=e.number(C)),e.numericMode=P,e.precision=se}}}for(let p=0;p<s.length;p++)e.assign(s[p],void 0);return e.popScope(),e.swapScope(c),a??void 0}var ze=class Da extends ne{constructor(t,i,r,n){n??(n={}),n.canonical??(n.canonical=!1),super(t,n.metadata),this._result=void 0,this._head=i,this._ops=r,n.canonical&&(this._canonical=this,this.bind()),t._register(this)}get hash(){if(this._hash!==void 0)return this._hash;let t=0;for(let i of this._ops)t=t<<1^i.hash|0;return typeof this._head=="string"?t=t^st(this._head)|0:t=t^this._head.hash|0,this._hash=t,t}infer(t){let i=this._def;return!i||!i.signature.inferredSignature?!1:(typeof i.signature.result!="function"&&(i.signature.result=Xa(i.signature.result,t)),!0)}bind(){this._def=void 0,this._scope=this.engine.context;let t=this._head;if(typeof t!="string"){t.bind();return}this._def=this.engine.lookupFunction(t);for(let i of this._ops)i.bind()}reset(){}get isExact(){return gn(this)&&this.op1.isExact}get isCanonical(){return this._canonical===this}set isCanonical(t){this._canonical=t?this:void 0}get isPure(){var i;if(this._isPure!==void 0)return this._isPure;if(!this.isCanonical)return this._isPure=!1,!1;let t=((i=this.functionDefinition)==null?void 0:i.pure)??!1;return t&&(t=this._ops.every(r=>r.isPure)),this._isPure=t,t}get json(){return this.isValid&&this._canonical===this?mh(this.engine,this._head,this._ops,{latex:this._latex,wikidata:this.wikidata}):V(this.engine,this._head,this._ops,{latex:this._latex,wikidata:this.wikidata})}get rawJson(){return[typeof this._head=="string"?this._head:this._head.rawJson,...this.ops.map(t=>t.rawJson)]}get scope(){return this._scope}get head(){return this._head}get ops(){return this._ops}get nops(){return this._ops.length}get op1(){return this._ops[0]??this.engine.Nothing}get op2(){return this._ops[1]??this.engine.Nothing}get op3(){return this._ops[2]??this.engine.Nothing}get isValid(){return this._head==="Error"||typeof this._head!="string"&&!this._head.isValid?!1:this._ops.every(t=>t==null?void 0:t.isValid)}get canonical(){return this._canonical??(this._canonical=this.isValid?Ca(this.engine,this._head,this._ops):this),this._canonical}*map(t){let i=0;for(;i<this._ops.length;)yield t(this._ops[i++])}subs(t,i){i=i?{...i}:{},"canonical"in i||(i.canonical=!0);let r=this._ops.map(n=>n.subs(t,i));return i.canonical&&r.every(n=>n.isValid)?Ca(this.engine,this._head,r):new Da(this.engine,this._head,r,{canonical:!1})}replace(t,i){return nl(this,t,i)}has(t){if(typeof this._head=="string"){if(typeof t=="string"){if(this._head===t)return!0}else if(t.includes(this._head))return!0}for(let i of this._ops)if(i.has(t))return!0;return!1}isSame(t){if(this===t)return!0;if(!(t instanceof Da)||this.nops!==t.nops)return!1;if(typeof this.head=="string"){if(this.head!==t.head)return!1}else if(typeof t.head=="string"||!t.head||!this.engine.box(this.head).isSame(this.engine.box(t.head)))return!1;let i=this._ops,r=t._ops;for(let n=0;n<i.length;n++)if(!i[n].isSame(r[n]))return!1;return!0}match(t,i){return Ya(this,t,i)}get complexity(){var t;if(this.isCanonical)return((t=this.functionDefinition)==null?void 0:t.complexity)??jt}get baseDefinition(){return this.functionDefinition}get functionDefinition(){return this._def}isEqual(t){if(this===t)return!0;let i=this.head;if(i==="Equal"||i==="NotEqual"||i==="Unequal")return t.head!==i?!1:!!(this.op1.isEqual(t.op1)&&this.op2.isEqual(t.op2)||this.op1.isEqual(t.op2)&&this.op2.isEqual(t.op1));if(i==="Less")return t.head==="Less"?!!(this.op1.isEqual(t.op1)&&this.op2.isEqual(t.op2)):t.head==="Greater"?!!(this.op1.isEqual(t.op2)&&this.op2.isEqual(t.op1)):!1;if(i==="Greater")return t.head==="Greater"?!!(this.op1.isEqual(t.op1)&&this.op2.isEqual(t.op2)):t.head==="Less"?!!(this.op1.isEqual(t.op2)&&this.op2.isEqual(t.op1)):!1;if(i==="LessEqual")return t.head==="LessEqual"?!!(this.op1.isEqual(t.op1)&&this.op2.isEqual(t.op2)):t.head==="GreaterEqual"?!!(this.op1.isEqual(t.op2)&&this.op2.isEqual(t.op1)):!1;if(i==="GreaterEqual")return t.head==="GreaterEqual"?!!(this.op1.isEqual(t.op1)&&this.op2.isEqual(t.op2)):t.head==="LessEqual"?!!(this.op1.isEqual(t.op2)&&this.op2.isEqual(t.op1)):!1;if(dr(i))return t.head!==this.head?!1:!!(this.op1.isEqual(t.op1)&&this.op2.isEqual(t.op2));let r=Yi(this,t);return r===0?!0:r!==void 0?!1:this.engine.add(this,this.engine.neg(t)).simplify().isZero?!0:this.isSame(t)}get isNumber(){var t;return(t=this.domain)==null?void 0:t.isCompatible("Numbers")}get isInteger(){var t;return(t=this.domain)==null?void 0:t.isCompatible("Integers")}get isRational(){var t;return(t=this.domain)==null?void 0:t.isCompatible("RationalNumbers")}get isAlgebraic(){var t;return(t=this.domain)==null?void 0:t.isCompatible("AlgebraicNumbers")}get isReal(){var t;return(t=this.domain)==null?void 0:t.isCompatible("RealNumbers")}get isExtendedReal(){var t;return(t=this.domain)==null?void 0:t.isCompatible("ExtendedRealNumbers")}get isComplex(){var t;return(t=this.domain)==null?void 0:t.isCompatible("ComplexNumbers")}get isImaginary(){var t;return(t=this.domain)==null?void 0:t.isCompatible("ImaginaryNumbers")}get domain(){if(this._result!==void 0)return this._result;if(!this.canonical)return;let t=this.engine,i;if(typeof this._head!="string")i=this._head.domain;else if(this._def){let r=this._def.signature;typeof r.result=="function"?i=r.result(t,this._ops):i=r.result}return i??(i=void 0),this._result=i,i}simplify(t){var u;if(!this.isValid)return this;if(!this.isCanonical){let f=this.canonical;return!f.isCanonical||!f.isValid?this:f.simplify(t)}let i=(t==null?void 0:t.recursive)??!0,r;if(i&&(r=ei(this),r!==null))return r=r.simplify({...t,recursive:!1}),Hi(this,r);let n=this.functionDefinition,a=i?Xs(this._ops,(n==null?void 0:n.hold)??"none",n!=null&&n.associative?n.name:"",f=>f.simplify(t)):this._ops;if(typeof this._head!="string"){let f=xn(this._head,a);return typeof f.head!="string"?f:f.simplify(t)}if(n)if(n.inert)r=((u=a[0])==null?void 0:u.canonical)??this;else{let f=n.signature;f!=null&&f.simplify&&(r=f.simplify(this.engine,a))}r?r=Hi(this.engine.box([this._head,...a]),r):r=this.engine.box([this._head,...a]),r=Hi(this,r);let s=(t==null?void 0:t.rules)??this.engine.cache("standard-simplification-rules",()=>An(this.engine,Ph),f=>{for(let[c,h,p,m]of f)c.reset(),h.reset();return f}),o=0,l=!1;do{let f=r.replace(s);f!==null?(r=Hi(r,f),r===f&&(l=!0)):l=!0,o+=1}while(!l&&o<this.engine.iterationLimit);return Hi(this,r)}evaluate(t){if(!this.isValid)return this;if(t!=null&&t.numericMode){let s=this.head;if(s==="Integrate"||s==="Limit")return this.engine.box(["N",this],{canonical:!0}).evaluate(t)}if(!this.isCanonical){this.engine.pushScope();let s=this.canonical;return this.engine.popScope(),!s.isCanonical||!s.isValid?this:s.evaluate(t)}let i=this.functionDefinition;if(i!=null&&i.threadable&&this.ops.some(s=>Ee(s))){let s=Math.max(...this._ops.map(l=>{var u,f;return((f=(u=l.functionDefinition)==null?void 0:u.size)==null?void 0:f.call(u,l))??0})),o=[];for(let l=0;l<=s-1;l++){let u=this._ops.map(f=>Ee(f)?Bf(f,l%s+1)??this.engine.Nothing:f);o.push(this.engine._fn(this.head,u).evaluate(t))}return o.length===0?this.engine.box(["Sequence"]):o.length===1?o[0]:this.engine._fn("List",o)}let r=Xs(this._ops,(i==null?void 0:i.hold)??"none",i!=null&&i.associative?i.name:"",s=>s.evaluate(t));if(i!=null&&i.inert)return r[0]??this;let n;typeof this._head!="string"&&(n=xn(this._head,r));let a=i==null?void 0:i.signature;if(!n&&a){let s=(t==null?void 0:t.numericMode)??!1,o=this.engine.swapScope(this.scope);s&&a.N&&(n=a.N(this.engine,r)),!n&&a.evaluate&&(n=a.evaluate(this.engine,r)),this.engine.swapScope(o)}if(n){let s=n.numericValue;s!==null&&(!Fe(this.engine)&&s instanceof Ch.Complex?n=this.engine.NaN:!K(this.engine)&&s instanceof T&&(n=this.engine.number(s.toNumber())))}return n??this.engine.box([this._head,...r])}N(t){return this.evaluate({...t,numericMode:!0})}solve(t){return t.length!==1?null:_l(this.simplify(),t[0])}};function zh(e,t,i,r){let n=[];if(t==="Add"||t==="Multiply")n=rt(e,e.canonical(i),{flatten:t});else if(t==="Negate"||t==="Square"||t==="Sqrt"||t==="Exp"||t==="Ln")n=rt(e,e.canonical(i),1);else if(t==="Divide"||t==="Power")n=rt(e,e.canonical(i),2);else return null;if(!n.every(a=>a.isValid))return e._fn(t,n,r);if(t==="Add")return hr(e,De(Ae(n),"Add"));if(t==="Negate")return Ze(n[0]);if(t==="Multiply")return qa(e,De(Ae(n),"Multiply"));if(t==="Divide")return wt(e,n[0].canonical,n[1].canonical);if(t==="Exp")return Oi(e,e.E,n[0].canonical);if(t==="Power")return Oi(e,n[0].canonical,n[1].canonical);if(t==="Square")return Oi(e,n[0].canonical,e.number(2));if(t==="Sqrt"){let a=n[0].canonical;return Se(a.numericValue)?e._fn("Sqrt",[a],r):Oi(e,a,e.Half)}return t==="Ln"?e._fn("Ln",n,r):null}function Ca(e,t,i,r){if(typeof t!="string"&&(e.pushScope(),t=t.evaluate().symbol??t,e.popScope()),typeof t=="string"){let l=zh(e,t,i,r);if(l)return l}else if(!t.isValid)return new ze(e,t,i.map(l=>e.box(l,{canonical:!1})),{metadata:r,canonical:!1});let n=e.lookupFunction(t);if(!n)return new ze(e,t,Ae(i.map(l=>e.box(l))),{metadata:r,canonical:!0});let a=[];for(let l=0;l<i.length;l++)if(!ui(n.hold,i.length-1,l))a.push(e.box(i[l]));else{let u=e.box(i[l],{canonical:!1});u.head==="ReleaseHold"?a.push(u.op1.canonical):a.push(u)}let s=n.signature;if(s.canonical){try{let l=s.canonical(e,a);if(l)return l}catch(l){console.error(l)}return new ze(e,t,a,{metadata:r,canonical:!1})}a=Ae(a),n.associative&&(a=De(a,t));let o=Zf(e,a,n.hold,n.threadable,s.params,s.optParams,s.restParam);if(o)return e._fn(t,o,r);if(a.length===1&&a[0].head===t){if(n.involution)return a[0].op1;n.idempotent&&(a=a[0].ops)}return a.length>1&&n.commutative===!0&&(a=a.sort(Xt)),e._fn(t,a,r)}function Xs(e,t,i,r){if(e.length===0)return[];if(e=De(e,i),t==="all")return e;if(t==="none"){let a=[];for(let s of e){let o=s.head;if(o==="Hold")a.push(s);else{let l=o==="ReleaseHold"?s.op1:s;if(l){let u=r(l);u!==null&&a.push(u)}}}return De(a,i)}let n=[];for(let a=0;a<e.length;a++)if(e[a].head==="Hold")n.push(e[a]);else{let s;if(e[a].head==="ReleaseHold"?s=e[a].op1:ui(t,e.length-1,a)?n.push(e[a]):s=e[a],s){let o=r(s);o!==null&&n.push(o)}}return De(n,i)}function Hi(e,t){if(t==null||e===t)return e;let i=e.engine,r=i.box(t);return i.costFunction(r)<=1.2*i.costFunction(e)?r:e}var zi=class kl extends ne{constructor(t,i,r){super(t,r),this._string=i.normalize(),t._register(this)}get hash(){return st("String"+this._string)}get json(){return dh(this.engine,this._string)}get head(){return"String"}get isPure(){return!0}get isCanonical(){return!0}set isCanonical(t){}get domain(){return this.engine.Strings}get complexity(){return 19}get string(){return this._string}isEqual(t){return t.string===this._string}isSame(t){return t.string===this._string}match(t,i){return br(t)||(t=this.engine.box(t,{canonical:!1})),mi(t)?{[di(t)]:this}:t instanceof kl&&this._string===t._string?{}:null}},Tl=me(de(),1);function El(e,t){switch(t){case"float64":case"float32":case"int32":case"uint8":return new Lh(e);case"complex128":case"complex64":return new Bh(e);case"bool":case"string":case"expression":return new Rh(e)}throw new Error(`Unknown dtype ${t}`)}var Lh=class{constructor(e){this.ce=e,this.one=1,this.zero=0,this.nan=NaN}cast(e,t){let i=this.ce;switch(t){case"float64":case"float32":case"int32":case"uint8":return e;case"complex128":case"complex64":return Array.isArray(e)?e.map(r=>i.complex(r)):this.ce.complex(e);case"bool":return Array.isArray(e)?e.map(r=>r!==0):e!==0;case"string":return Array.isArray(e)?e.map(r=>Number(r).toString()):Number(e).toString();case"expression":return Array.isArray(e)?e.map(r=>i.number(r)):i.number(e)}throw new Error(`Cannot cast ${e} to ${t}`)}expression(e){return this.ce.number(e)}isZero(e){return e===0}isOne(e){return e===1}equals(e,t){return e===t}add(e,t){return e+t}addn(...e){return e.reduce((t,i)=>t+i,0)}neg(e){return-e}sub(e,t){return e-t}mul(e,t){return e*t}muln(...e){return e.reduce((t,i)=>t*i,1)}div(e,t){return e/t}pow(e,t){return e**t}conjugate(e){return e}},Rh=class{constructor(e){this.one=e.One,this.zero=e.Zero,this.nan=e.NaN,this.ce=e}cast(e,t){if(Array.isArray(e))return e.map(r=>this.cast(r,t));let i=e.value;switch(t){case"float64":case"float32":return typeof i=="number"?i:void 0;case"int32":return typeof i=="number"?Math.round(i):void 0;case"uint8":if(typeof i!="number")return;let r=Math.round(i);return r>=0&&r<=255?r:void 0;case"complex128":case"complex64":if(typeof i=="number")return this.ce.complex(i);let n=e.numericValue;return n instanceof Tl.default?n:void 0;case"bool":return typeof i=="boolean"?i:void 0;case"string":return typeof i=="string"?i:void 0;case"expression":return e}throw new Error(`Cannot cast ${e} to ${t}`)}expression(e){return e}isZero(e){return e.isZero??!1}isOne(e){return e.isOne??!1}equals(e,t){return e.isEqual(t)}add(e,t){return this.ce.add(e,t)}addn(...e){return this.ce.add(...e)}neg(e){return this.ce.neg(e)}sub(e,t){return this.ce.add(e,this.ce.neg(t))}mul(e,t){return this.ce.mul(e,t)}muln(...e){return this.ce.mul(...e)}div(e,t){return this.ce.div(e,t)}pow(e,t){return this.ce.pow(e,t)}conjugate(e){return this.ce.box(["Conjugate",e])}},Bh=class{constructor(e){this.ce=e,this.one=e.complex(1),this.zero=e.complex(0),this.nan=e.complex(NaN)}cast(e,t){if(Array.isArray(e))return e.map(i=>this.cast(i,t));switch(t){case"float64":return e.im===0?e.re:void 0;case"float32":return e.im===0?e.re:void 0;case"int32":return e.im===0?Math.round(e.re):void 0;case"uint8":if(e.im!==0)return;let i=Math.round(e.re);return i>=0&&i<=255?i:void 0;case"complex128":return e;case"complex64":return e;case"bool":return!(e.im===0&&e.re===0);case"string":return e.toString();case"expression":return this.ce.number(e)}throw new Error(`Cannot cast ${e} to ${t}`)}expression(e){return this.ce.number(e)}isZero(e){return e.isZero()}isOne(e){return e.re===1&&e.im===0}equals(e,t){return e.equals(t)}add(e,t){return e.add(t)}addn(...e){return e.reduce((t,i)=>t.add(i),this.zero)}neg(e){return e.neg()}sub(e,t){return e.sub(t)}mul(e,t){return e.mul(t)}muln(...e){return e.reduce((t,i)=>t.mul(i),this.one)}div(e,t){return e.div(t)}pow(e,t){return e.pow(t)}conjugate(e){return e.conjugate()}};function Al(e,t){return e===t?e:e==="string"||t==="string"||e==="expression"||t==="expression"?"expression":e==="complex128"||t==="complex128"?"complex128":e==="complex64"||t==="complex64"?"complex64":e==="float64"||t==="float64"?"float64":e==="float32"||t==="float32"?"float32":e==="int32"||t==="int32"?"int32":e==="uint8"||t==="uint8"?"uint8":e==="bool"||t==="bool"?"bool":"expression"}function eo(e){let t=e.value;if(typeof t=="number")return Number.isInteger(t)?t>=0&&t<=255?"uint8":"int32":"float64";let i=e.numericValue;return i!==null&&i instanceof Tl.default?"complex128":e.string?"string":"expression"}var xr=class zt{constructor(t,i){this.ce=t,this.shape=i.shape,this.rank=this.shape.length,this._strides=Uh(this.shape),this.field=El(t,i.dtype)}static align(t,i){if(t.dtype===i.dtype)return[t,i];let r=Al(t.dtype,i.dtype);return t.dtype===r?[t,i.upcast(r)]:[t.upcast(r),i]}static broadcast(t,i,r){if(!(r instanceof zt))return i.map1(t,r);let[n,a]=zt.align(i,r),s=n.data.map((o,l)=>t(o,a.data[l]));return _t(n.ce,{dtype:n.dtype,shape:n.shape,data:s})}get expression(){let t=this.shape,i=this.rank,r=this.data,n=this._index.bind(this),a=this.field.expression.bind(this.field),s=o=>{if(o.length===i-1){let l=n(o),u=this.ce._fn("List",r.slice(l,l+t[i-1]).map(f=>a(f)));return u.isCanonical=u.ops.every(f=>f.isCanonical),u}else{let l=[];for(let f=0;f<=t[o.length]-1;f++)l.push(s([...o,f+1]));let u=this.ce._fn("List",l);return u.isCanonical=u.ops.every(f=>f.isCanonical),u}};return s([])}get array(){let t=this.shape,i=this.rank,r=this.data;if(i===1)return r;if(i===2){let[s,o]=t,l=new Array(s);for(let u=0;u<s;u++)l[u]=r.slice(u*o,(u+1)*o);return l}let n=this._index.bind(this),a=s=>{if(s.length===i-1){let o=n(s);return r.slice(o,o+t[i-1])}else{let o=[];for(let l=0;l<t[s.length];l++)o.push(a([...s,l+1]));return o}};return a([])}_index(t){let i=this._strides;return t.reduce((r,n,a)=>r+(n-1)*i[a],0)}get isSquare(){let t=this.shape;return t.length===2&&t[0]===t[1]}get isSymmetric(){if(!this.isSquare)return!1;let t=this.shape[0],i=this.data,r=this.field.equals.bind(this.field);for(let n=0;n<t;n++)for(let a=n+1;a<t;a++)if(!r(i[n*t+a],i[a*t+n]))return!1;return!0}get isSkewSymmetric(){if(!this.isSquare)return!1;let t=this.shape[0],i=this.data,r=this.field.equals.bind(this.field),n=this.field.neg.bind(this.field);for(let a=0;a<t;a++)for(let s=a+1;s<t;s++)if(!r(i[a*t+s],n(i[s*t+a])))return!1;return!0}get isUpperTriangular(){if(!this.isSquare)return!1;let t=this.shape[0],i=this.data,r=this.field.isZero.bind(this.field);for(let n=1;n<t;n++)for(let a=0;a<n;a++)if(r(i[n*t+a]))return!1;return!0}get isLowerTriangular(){if(!this.isSquare)return!1;let t=this.shape[0],i=this.data,r=this.field.isZero.bind(this.field);for(let n=0;n<t-1;n++)for(let a=n+1;a<t;a++)if(!r(i[n*t+a]))return!1;return!0}get isTriangular(){if(!this.isSquare)return!1;let t=this.shape[0],i=this.data,r=this.field.isZero.bind(this.field);for(let n=0;n<t;n++)for(let a=0;a<t;a++)if(n<a&&!r(i[n*t+a])||n>a&&!r(i[n*t+a]))return!1;return!0}get isDiagonal(){if(!this.isSquare)return!1;let t=this.shape[0],i=this.data,r=this.field.isZero.bind(this.field);for(let n=0;n<t;n++)for(let a=0;a<t;a++)if(n===a&&!r(i[n*t+a])||n!==a&&!r(i[n*t+a]))return!1;return!0}get isIdentity(){if(!this.isSquare)return!1;let[t,i]=this.shape,r=this.data,n=this.field.isOne.bind(this.field),a=this.field.isZero.bind(this.field);for(let s=0;s<i;s++)for(let o=0;o<i;o++)if(s===o&&!n(r[s*i+o])||s!==o&&!a(r[s*i+o]))return!1;return!0}get isZero(){let t=this.field.isZero.bind(this.field);return this.data.every(i=>t(i))}at(...t){let i=this.data.length;return this.data[this._index(t)%i]}diagonal(t,i){if(t??(t=1),i??(i=2),t===i||t<=0||t>this.shape.length||this.shape[t-1]!==this.shape[i-1])return;let r=new Array(this.shape[t-1]),n=this.data,a=this.shape[t-1];for(let s=0;s<a;s++)r[s]=n[s*a+s];return r}trace(t,i){if(this.rank!==2)return;let[r,n]=this.shape;if(r!==n)return;let a=this.data,s=new Array(r);for(let o=0;o<r;o++)s[o]=a[o*r+o];return this.field.addn(...s)}reshape(...t){return _t(this.ce,{dtype:this.dtype,shape:t,data:this.data})}flatten(){return this.data}upcast(t){let i=this.field.cast(this.data,t);if(i===void 0)throw Error(`Cannot cast tensor to ${t}`);return _t(this.ce,{dtype:t,shape:this.shape,data:i})}transpose(t,i,r){if(this.rank!==2)return;if(t??(t=1),i??(i=2),t===i)return this;if(t<=0||t>2||i<=0||i>2)return;let[n,a]=this.shape,s=this.data;r&&(s=s.map(f=>r(f)));let o=0,l=new Array(n*a),u=a;for(let f=0;f<a;f++)for(let c=0;c<n;c++)l[o++]=s[c*u+f];return _t(this.ce,{dtype:this.dtype,shape:[a,n],data:l})}conjugateTranspose(t,i){let r=this.field.conjugate.bind(this.field);return this.transpose(t,i,r)}determinant(){if(this.rank!==2)return;let[t,i]=this.shape;if(t!==i)return;if(t===1)return this.data[0];let r=this.field.add.bind(this.field),n=this.field.mul.bind(this.field),a=this.field.neg.bind(this.field);if(t===2){let[d,b,y,_]=this.data;return r(n(d,_),a(n(b,y)))}let s=this.field.addn.bind(this.field),o=this.field.muln.bind(this.field);if(t===3){let[d,b,y,_,S,k,C,P,se]=this.data;return s([o(d,S,se),o(b,k,C),o(y,_,P),a(o(y,S,C)),a(o(b,_,se)),a(o(d,k,P))])}let l=this.shape[0],u=!1,f=this.field.div.bind(this.field),c=this.field.sub.bind(this.field),h=new Array(l).fill(0).map((d,b)=>b),p=[...this.data];for(let d=0;d<l;d++){let b=h[d-1];if(this.at(b,d)===0){let S;for(S=d+1;S<l;S++)if(this.at(h[S],d)!==0){b=h[S],h[S-1]=h[d-1],h[d-1]=b,u=!u;break}if(S===l)return this.at(b,d)}let y=this.at(b,d),_=d===0?1:this.at(h[d-2],d-2);for(let S=d+1;S<l;S++){let k=h[S-1];for(let C=d+1;C<l;C++)p[k][C]=f(c(n(p[k][C],y),n(p[k][d],p[b][C])),_)}}let m=p[h[l-1]][l-1];return u?this.field.neg(m):m}inverse(){if(this.rank!==2)return;let[t,i]=this.shape;if(t!==i)return;if(t===2){let[h,p,m,d]=this.data,b=this.determinant();if(b===void 0||this.field.isZero(b))return;let y=this.field.div.bind(this.field),_=this.field.neg.bind(this.field),S=[y(d,b),_(y(p,b)),_(y(m,b)),y(h,b)];return _t(this.ce,{dtype:this.dtype,shape:[i,i],data:S})}let r=this.shape[0],n=this.field.div.bind(this.field),a=this.field.sub.bind(this.field),s=this.field.mul.bind(this.field),o=this.array,l=new Array(r).fill(0).map((h,p)=>{let m=new Array(r).fill(0);return m[p]=1,m}),u=o.map((h,p)=>[...h,...l[p]]),f=new Array(r).fill(0).map((h,p)=>p);for(let h=0;h<r;h++){let p=f[h-1];if(this.at(p,h)===0){let b;for(b=h+1;b<r;b++)if(this.at(f[b],h)!==0){p=f[b],f[b-1]=f[h-1],f[h-1]=p;break}if(b===r)return}let m=this.at(p,h),d=h===0?1:this.at(f[h-2],h-2);for(let b=h+1;b<r;b++){let y=f[b-1];for(let _=h+1;_<r*2;_++)u[y][_]=a(u[y][_],s(n(s(u[y][h],u[p][_]),m),d))}}for(let h=r-1;h>=0;h--){let p=u[f[h],h];for(let m=0;m<h;m++){let d=f[m];for(let b=r;b<r*2;b++)u[d][b]=a(u[d][b],s(n(s(u[d][h],u[h][b]),p),p))}for(let m=r;m<r*2;m++)u[h][m]=n(u[h][m],p)}let c=u.map(h=>h.slice(r));return _t(this.ce,{dtype:this.dtype,shape:[i,i],data:c})}pseudoInverse(){}adjugateMatrix(){}minor(t,i){}map1(t,i){return _t(this.ce,{dtype:this.dtype,shape:this.shape,data:this.data.map(r=>t(r,i))})}map2(t,i){let r=i.data;return _t(this.ce,{dtype:this.dtype,shape:this.shape,data:this.data.map((n,a)=>t(n,r[a]))})}add(t){return zt.broadcast(this.field.add.bind(this.field),this,t)}subtract(t){return zt.broadcast(this.field.sub.bind(this.field),this,t)}multiply(t){return zt.broadcast(this.field.mul.bind(this.field),this,t)}divide(t){return zt.broadcast(this.field.div.bind(this.field),this,t)}power(t){return zt.broadcast(this.field.pow.bind(this.field),this,t)}equals(t){if(this.rank!==t.rank||!this.shape.every((a,s)=>a===t.shape[s]))return!1;let i=this.field.equals.bind(this.field),r=this.field.cast.bind(this.field),n=this.dtype;return this.dtype!==t.dtype?!!this.data.every((a,s)=>i(a,r(t.data[s],n))):this.data.every((a,s)=>i(a,t.data[s]))}};function Uh(e){let t=new Array(e.length);for(let i=e.length-1,r=1;i>=0;i--)t[i]=r,r*=e[i];return t}var jh=class extends xr{constructor(e,t){super(e,t),this.dtype="float64",this.data=t.data}get isZero(){return this.data.every(e=>e===0)}},Gh=class extends xr{constructor(e,t){super(e,t),this.dtype="complex128",this.data=t.data}},Zh=class extends xr{constructor(e,t){super(e,t),this.dtype="bool",this.data=t.data}},Hh=class extends xr{constructor(e,t){super(e,t),this.dtype="expression",this.data=t.data}};function _t(e,t){let i=t.dtype;return i==="float64"||i==="float32"||i==="uint8"||i==="int32"?new jh(e,t):i==="bool"?new Zh(e,t):i==="complex64"||i==="complex128"?new Gh(e,t):new Hh(e,t)}var Ml=class Jr extends ne{constructor(t,i,r){r??(r={}),r.canonical??(r.canonical=!0),super(t,r.metadata),i instanceof xr?this._tensor=i:(this._head=i.head??"List",this._ops=r.canonical?t.canonical(i.ops):i.ops,this._expression=new ze(t,this._head,this._ops,{canonical:r.canonical})),t._register(this)}get expression(){return this._expression??(this._expression=this._tensor.expression),this._expression}get tensor(){if(this._tensor===void 0){this._head,this._ops;let t=Wh(this._head,this._ops);if(t===void 0)throw new Error("Invalid tensor");this._tensor=_t(this.engine,t)}return this._tensor}get baseDefinition(){return this.expression.baseDefinition}get functionDefinition(){return this.expression.functionDefinition}bind(){this.expression.bind()}reset(){}get hash(){return st("BoxedTensor")}get canonical(){return this.isCanonical?this:new Jr(this.engine,{head:this._head,ops:this._ops},{canonical:!0})}get isCanonical(){return this._tensor?!0:this._expression.isCanonical}set isCanonical(t){this._tensor||(this.expression.isCanonical=t)}get isPure(){return this._tensor?!0:this.expression.isPure}get isValid(){return this._tensor?!0:this.expression.isValid}get complexity(){return 97}get head(){return this._tensor?"List":this._head}get nops(){return this._tensor?this._tensor.shape[0]:this.expression.nops}get ops(){return this.expression.ops}get op1(){if(this._tensor){let t=this._tensor.data;return t.length===0?this.engine.Nothing:this.engine.box(t[0])}return this.expression.op1}get op2(){if(this._tensor){let t=this._tensor.data;return t.length<2?this.engine.Nothing:this.engine.box(t[1])}return this.expression.op2}get op3(){if(this._tensor){let t=this._tensor.data;return t.length<3?this.engine.Nothing:this.engine.box(t[2])}return this.expression.op3}get shape(){return this.tensor.shape}get rank(){return this.tensor.rank}get domain(){return this._tensor?this.engine.domain("Lists"):this.expression.domain}get json(){return this.expression.json}get rawJson(){return this.expression.rawJson}isSame(t){return this===t?!0:t instanceof Jr?this.tensor.equals(t.tensor):this.expression.isSame(t)}isEqual(t){return this===t?!0:t instanceof Jr?this.tensor.equals(t.tensor):this.expression.isEqual(t)}match(t,i){return br(t)||(t=this.engine.box(t,{canonical:!1})),mi(t)?{[di(t)]:this}:this.expression.match(t,i)}evaluate(t){return this._tensor?this:this.expression.evaluate(t)}simplify(t){return this._tensor?this:this.expression.simplify(t)}N(t){return this._tensor?this:this.expression.N(t)}};function Qe(e){return e instanceof Ml}function Il(e,t){let i,r=[],n=!0,a=(s,o=0)=>{if(s.length!==0){s.length>1&&r[o]!==void 0?n=n&&r[o]===s.length:r[o]=Math.max(r[o]??0,s.length);for(let l of s)if(l.head===e?a(l.ops,o+1):i===void 0?i=eo(l):i=Al(i,eo(l)),!n)return}};if(a(t),!!n)return{shape:r,dtype:i}}function Wh(e,t){let{shape:i,dtype:r}=Il(e,t)??{shape:[],dtype:void 0};if(r===void 0)return;let n=!0,a=[],s=El(t[0].engine,"expression"),o=s.cast.bind(s),l=u=>{for(let f of u)if(f.head===e)l(f.ops);else{let c=o(f,r);if(c===void 0){n=!1;return}a.push(c)}};if(l(t),!!n)return{shape:i,data:a,dtype:r}}function sr(e){return e[Math.floor(Math.random()*e.length)]}function to(e,t){if(e==="Add"||e==="Multiply"){let i=[],r=1+Math.floor(Math.random()*12);for(;r>0;)i.push(Tt(t+1)),r-=1;return[e,...i]}return e==="Divide"||e==="Power"?[e,Tt(t+1),Tt(t+1)]:e==="Root"?[e,Tt(t+1),Tt(10)]:e==="trig"?Qh():[e,Tt(t+1)]}function Qh(){return[sr(["Cos","Sin","Tan","Sinh","Arccos","Arsinh"]),sr(["Pi","-1","0","1",["Divide","Pi",-5],["Multiply",-2,["Divide","Pi",11]],["Multiply","Half","Pi"],["Multiply",5,"Pi"],["Multiply",12,"Pi"],["Divide","Pi",5],["Divide","Pi",9],["Multiply",5,["Divide","Pi",9]],["Multiply",2,["Divide","Pi",11]],["Multiply",2,["Divide","Pi",3]]])]}function Tt(e){if(e??(e=1),e===1){let t=sr([["Sqrt",["Multiply",6,["Sum",["Divide",1,["Power","n",2]],["Triple",["Hold","n"],1,{num:"+Infinity"}]]]],"Add","Add","Add","Add","Add","Multiply","Multiply","Multiply","Multiply","Divide","Divide","Divide","Root","Sqrt","Subtract","Negate","trig"]);return typeof t=="string"?to(t,1):t}if(e===2){let t=Math.random();if(t>.75)return Tt(1);if(t>.5)return Tt(3);let i=sr(["Multiply","Multiply","Add","Power","trig","Ln","Exp"]);return to(i,2)}return sr([-12345e-9,-2,-2,-2,-3,-5,-6,-12,-1654e-60,0,0,12345e-8,1654e-60,1,2,2,2,2,3,3,5,5,6,6,1234.5678,5678.1234,10,15,18,30,60,1234e54,"123456789.12345678912345e200","987654321.12345678912345",["Rational",-6,10],["Rational",-12,15],["Rational",-15,12],["Rational",3,5],["Rational",12,15],["Rational",15,12],"ExponentialE",["Sqrt",3],["Sqrt",5],["Sqrt",15],["Sqrt",25],["Complex",-1.1,1.1],["Complex",4,5],"x","x","x","x",["Add","x",1],["Divide","x",3],["Square","x"],["Power","x",3],["Power","x",4],["Subtract","x",1],["Add","x",1],"Pi"])}var Jh=[{Nothing:{domain:"NothingDomain"}},{InvisibleOperator:{complexity:9e3,hold:"all",signature:{restParam:"Anything",result:(e,t)=>t.length===0?e.domain("NothingDomain"):t.length===1?t[0].domain:e.Anything,canonical:Ol}},Sequence:{hold:"all",signature:{restParam:"Anything",result:(e,t)=>t.length===0?e.domain("NothingDomain"):t.length===1?t[0].domain:e.Anything,canonical:(e,t)=>{let i=Pe(Ae(t));return i.length===0?e._fn("Sequence",[]):i.length===1?i[0]:e._fn("Sequence",i)}}},Delimiter:{complexity:9e3,hold:"all",signature:{params:["Anything"],optParams:["Strings"],result:(e,t)=>t[0].domain,canonical:(e,t)=>{var r;if(t.length===0)return e._fn("Tuple",[]);let i=t[0];return i.head==="Sequence"?i=e._fn("Sequence",e.canonical(i.ops)):i=i.canonical,i.head==="Sequence"&&i.ops.length===1&&(i=i.ops[0]),t=[i,...t.slice(1)],t.length===1?e._fn("Delimiter",t):t.length>2?e._fn("Delimiter",et(e,t,2)):(((r=t[1].string)==null?void 0:r.length)??0)>3?e._fn("Delimiter",[t[0],e.error("invalid-delimiter",t[1])]):e._fn("Delimiter",[t[0],ht(e,t[1],"Strings")])},evaluate:(e,t)=>{if(t.length===0)return e.Nothing;let i=t[0];return(i.head==="Sequence"||i.head==="Delimiter")&&(t=Ae(t[0].ops)),t.length===1?t[0].evaluate():e._fn("Tuple",t.map(r=>r.evaluate()))},N:(e,t)=>{if(t.length===0)return e.Nothing;let i=t[0];return(i.head==="Sequence"||i.head==="Delimiter")&&(t=Ae(t[0].ops)),t.length===1?t[0].N():e._fn("Tuple",t.map(r=>r.N()))}}},Error:{hold:"all",complexity:500,signature:{domain:["FunctionOf","Anything",["OptArg","Anything"],"Void"],canonical:(e,t)=>e._fn("Error",t)}},ErrorCode:{complexity:500,hold:"all",signature:{domain:["FunctionOf","Strings",["VarArg","Anything"],"Anything"],canonical:(e,t)=>{let i=ht(e,t[0],e.Strings).string;return i==="incompatible-domain"?e._fn("ErrorCode",[e.string(i),t[1],t[2]]):e._fn("ErrorCode",t)}}},Hold:{hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],result:(e,t)=>{let i=t[0];return i.symbol?e.domain("Symbols"):i.string?e.domain("Strings"):i.head==="Numbers"?e.domain("Numbers"):i.domain},canonical:(e,t)=>t.length!==1?null:e.hold(t[0]),evaluate:(e,t)=>t[0]}},HorizontalSpacing:{signature:{domain:"Functions",canonical:(e,t)=>t.length===2?t[0].canonical:e.box(["Sequence"])}},Style:{complexity:9e3,inert:!0,signature:{domain:["FunctionOf","Anything",["OptArg","Dictionaries"],"Anything"]}}},{About:{signature:{domain:"Functions"}},Head:{hold:"all",signature:{domain:"Functions",canonical:(e,t)=>{if(t.length!==1)return null;let i=t[0];return i.head?e.box(i.head):e._fn("Head",Pe(t))},evaluate:(e,t)=>{let i=t[0];return typeof(i==null?void 0:i.head)=="string"?e.symbol(i.head):(i==null?void 0:i.head)??e.Nothing}}},Tail:{hold:"all",signature:{domain:"Functions",canonical:(e,t)=>{if(t.length!==1)return null;let i=t[0];return i.ops?e._fn("Sequence",i.ops):e._fn("Tail",Pe(t))},evaluate:(e,t)=>{let i=t[0];return i!=null&&i.ops?e.box(["Sequence",...i.ops]):e.box(["Sequence"])}}},Identity:{signature:{domain:["FunctionOf","Anything","Anything"],result:(e,t)=>t[0].domain,evaluate:(e,t)=>t[0]}}},{Apply:{signature:{domain:"Functions",canonical:(e,t)=>t[0].symbol?e.box([t[0].symbol,...t.slice(1)]):e._fn("Apply",t),evaluate:(e,t)=>xn(t[0],t.slice(1))}},Assign:{hold:"all",pure:!1,signature:{domain:["FunctionOf","Anything","Anything","Anything"],canonical:(e,t)=>{if(t.length!==2)return null;let i=t[0];if(!i.symbol)return null;let r=t[1];return e._fn("Assign",[i,r])},evaluate:(e,t)=>{let i=t[0],r=t[1];if(!i.symbol)return e.Nothing;let n=r.evaluate();return e.assign(i.symbol,n),n}}},Assume:{hold:"all",pure:!1,signature:{domain:["FunctionOf","Anything","Anything"],evaluate:(e,t)=>e.string(e.assume(t[0]))}},Declare:{hold:"all",pure:!1,signature:{domain:["FunctionOf","Symbols","Anything"],canonical:(e,t)=>{if(t.length!==2)return null;let i=t[0],r=t[1];return i.symbol?r.symbol?e._fn("Declare",t):e._fn("Declare",[i,e._fn("Hold",[r])]):null},evaluate:(e,t)=>{let i=t[0],r=t[1];if(!i.symbol)return e.Nothing;let n=r.evaluate();if(Vi(n))return e.declare(i.symbol,n),n}}},Domain:{signature:{domain:["FunctionOf","Anything","Domains"],evaluate:(e,t)=>t[0].domain}},Evaluate:{hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],result:(e,t)=>t[0].domain,canonical:(e,t)=>e._fn("Evaluate",et(e,t,1)),evaluate:(e,t)=>t[0].evaluate()}},Function:{complexity:9876,hold:"all",signature:{domain:["FunctionOf","Anything",["VarArg","Symbols"],"Functions"],canonical:(e,t)=>t.length===0?e.box(["Sequence"]):(t.length===1?Sl(t[0]):e._fn("Function",t))??null,evaluate:(e,t)=>{}}},Simplify:{hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],result:(e,t)=>t[0].domain,canonical:(e,t)=>e._fn("Simplify",et(e,t,1)),evaluate:(e,t)=>t[0].simplify()}},CanonicalForm:{complexity:8200,hold:"all",signature:{domain:["FunctionOf","Anything",["VarArg","Symbols"],"Anything"],canonical:(e,t)=>{if(t.length===1)return t[0].canonical;let i=t.slice(1).map(r=>r.symbol??r.string).filter(r=>r!=null);return Lt(t[0],i)}}},N:{hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],result:(e,t)=>t[0].domain,canonical:(e,t)=>{if(t.length!==1)return e._fn("N",et(e,t,1));let i=t[0].head;if(i==="N")return t[0].canonical;if(i==="Integrate"){let[r,n,a]=On(t[0].op2);if(!r||n===void 0||a===void 0)return null;let s=t[0].op1;return e._fn("NIntegrate",[e.box(["Function",s,r]),e.number(n),e.number(a)])}return i==="Limit"?e._fn("NLimit",t[0].ops):e._fn("N",t)},evaluate:(e,t)=>t[0].N()}},Signatures:{signature:{domain:["FunctionOf","Symbols",["ListOf","Domains"]],canonical:(e,t)=>(t=et(e,t,1),t[0].symbol?e._fn("Signatures",t):e._fn("Signatures",[e.domainError("Symbols",t[0].domain,t[0])])),evaluate:(e,t)=>{let i=t[0].symbol;if(!i)return e.Nothing;let r=e.lookupFunction(i);if(!r)return e.box(["List"]);let n=r.signature,a=[...n.params];return n.optParams.length>0&&a.push(e._fn("OptArg",n.optParams)),n.restParam&&a.push(e._fn("VarArg",[n.restParam])),typeof n.result=="function"?a.push(n.result(e,[])??e.symbol("Undefined")):a.push(n.result),e.box(["List",...a])}}},Subscript:{hold:"last",signature:{domain:["FunctionOf","Anything","Anything","Anything"],result:(e,t)=>{var n,a;let i=t[0],r=t[1];if(i.string&&W(r)!==null)return e.domain("Integers");if(i.symbol){let s=(n=i.evaluate())==null?void 0:n.head;if(s)return(a=e.lookupFunction(s))!=null&&a.at?void 0:e.domain("Symbols")}},canonical:(e,t)=>{var n,a,s;let i=t[0],r=t[1];if(i.string){let o=W(r);if(o!==null&&o>1&&o<=36){let[l,u]=cn(i.string,o);return u?e.error(["unexpected-digit",{str:u[0]}],["LatexString",e.string(i.string)]):e.number(l)}}if(i.symbol){let o=(n=i.evaluate())==null?void 0:n.head;if(o&&((a=e.lookupFunction(o))!=null&&a.at))return e._fn("At",[i.canonical,r.canonical]);let l=r.string??r.symbol??((s=W(r))==null?void 0:s.toString());if(l)return e.symbol(i.symbol+"_"+l)}return r.head==="Sequence"&&e._fn("Subscript",[i,e._fn("List",r.ops)]),e._fn("Subscript",t)}}},Symbol:{complexity:500,description:"Construct a new symbol with a name formed by concatenating the arguments",threadable:!0,hold:"all",signature:{domain:["FunctionOf",["VarArg","Anything"],"Anything"],canonical:(e,t)=>{if(t.length===0)return e.Nothing;let i=t.map(r=>{var n;return r.symbol??r.string??((n=W(r))==null?void 0:n.toString())??""}).join("");return i.length>0?e.symbol(i):e.Nothing}}},Timing:{description:"`Timing(expr)` evaluates `expr` and return a `Pair` of the number of second elapsed for the evaluation, and the value of the evaluation",signature:{domain:["FunctionOf","Values",["OptArg","Integers"],["TupleOf","Values","Numbers"]],evaluate:(e,t)=>{if(t[1].symbol==="Nothing"){let l=globalThis.performance.now(),u=t[0].evaluate(),f=1e3*(globalThis.performance.now()-l);return e.pair(e.number(f),u)}let i=Math.max(3,Math.round(W(t[1])??3)),r=[],n;for(;i>0;){let l=globalThis.performance.now();n=t[0].evaluate(),r.push(1e3*(globalThis.performance.now()-l)),i-=1}let a=Math.max(...r),s=Math.min(...r);r=r.filter(l=>l>s&&l<a);let o=r.reduce((l,u)=>l+u,0);return o===0?e.pair(e.number(a),n):e.pair(e.number(o/r.length),n)}}}},{Wildcard:{signature:{params:["Symbols"],result:"Symbols",canonical:(e,t)=>t.length!==1?e.symbol("_"):e.symbol("_"+t[0].symbol)}},WildcardSequence:{signature:{params:["Symbols"],result:"Symbols",canonical:(e,t)=>t.length!==1?e.symbol("__"):e.symbol("__"+t[0].symbol)}},WildcardOptionalSequence:{signature:{params:["Symbols"],result:"Symbols",canonical:(e,t)=>t.length!==1?e.symbol("___"):e.symbol("___"+t[0].symbol)}}},{LatexString:{inert:!0,signature:{domain:["FunctionOf","Strings","Strings"]}},Latex:{signature:{domain:["FunctionOf",["VarArg","Anything"],"Strings"],evaluate:(e,t)=>e.box(["LatexString",e.string(w(t.map(i=>i.latex)))])}},Parse:{description:"Parse a LaTeX string and evaluate to a corresponding expression",signature:{domain:["FunctionOf","Anything","Anything"],evaluate:(e,t)=>{if(t.length===0)return e.box(["Sequence"]);let i=t[0],r=i.string??i.head==="LatexString"?i.op1.string:"";return e.parse(r)??e.box(["Sequence"])}}}},{RandomExpression:{signature:{domain:"Functions",evaluate:(e,t)=>e.box(Tt())}}}];function Ol(e,t){if(t.length===0)return null;let i=t[0];if(t.length===1)return i.canonical;if(t.length===2){let r=N(i);if(r!==null&&Number.isInteger(r)){let a=t[1];if(a.head==="Divide"||a.head==="Rational"){let[s,o]=[N(a.op1),N(a.op2)];if(s!==null&&o!==null&&s>0&&s<=1e3&&o>1&&o<=1e3&&Number.isInteger(s)&&Number.isInteger(o))return e._fn("Add",[i.canonical,a.canonical])}}let n=t[1];if(i.symbol&&n.head==="Delimiter"&&!e.lookupSymbol(i.symbol))return e.lookupFunction(i.symbol)||e.declare(i.symbol,"Functions"),n.nops===0?e.box([i.symbol]):(n=n.op1,n.head==="Sequence"?e.box([i.symbol,...e.canonical(n.ops)]):e.box([i.symbol,n.canonical]))}return t=Pe(Ae(t)),t.every(r=>r.isValid&&(!r.domain||r.domain.isNumeric||tl(r)&&!r.string))?e._fn("Multiply",De(t,"Multiply")):e._fn("Tuple",t)}function Lt(e,t){if(t===!1)return e;if(t===!0)return e.canonical;typeof t=="string"&&(t=[t]);for(let i of t)switch(i){case"InvisibleOperator":e=Pa(e);break;case"Number":e=Fl(e);break;case"Multiply":e=Dl(e);break;case"Add":e=Cl(e);break;case"Power":e=Ci(e);break;case"Divide":e=Pl(e);break;case"Flatten":e=ql(e);break;case"Order":e=ml(e,{recursive:!0});break;default:throw Error("Invalid canonical form")}return e}function ql(e){var n;if(!e.ops)return e;let t=e.ops.map(ql);e.head==="Delimiter"&&(t=[il(e.engine,e.op1)]);let i=e.engine,r=e.head==="Add"||e.head==="Multiply";return r||(n=i.lookupFunction(e.head))!=null&&n.associative&&(r=!0),r&&typeof e.head=="string"&&(e=i._fn(e.head,De(t,e.head))),e}function Pa(e){return e.ops?e.head==="InvisibleOperator"?Ol(e.engine,e.ops.map(Pa))??e:e.engine._fn(e.head,e.ops.map(Pa)):e}function Fl(e){return e.numericValue?e.canonical:e.ops?e.engine._fn(e.head,e.ops.map(Fl)):e}function Dl(e){if(!e.ops)return e;let t=e.ops.map(Dl);return e.head==="Multiply"?qa(e.engine,t):e.head==="Negate"?qa(e.engine,[t[0],e.engine.NegativeOne]):e}function Cl(e){if(!e.ops)return e;let t=e.ops.map(Cl);return e.head==="Add"?hr(e.engine,t):e.head==="Subtract"?hr(e.engine,[t[0],e.engine.neg(t[1])]):e.engine._fn(e.head,t)}function Ci(e){return e.ops?e.head==="Power"?Oi(e.engine,Ci(e.op1),Ci(e.op2)):e.ops?e.engine._fn(e.head,e.ops.map(Ci)):e:e}function Pl(e){return e.head==="Divide"?wt(e.engine,Ci(e.op1),Ci(e.op2)):e.ops?e.engine._fn(e.head,e.ops.map(Pl)):e}function $a(e,t,i){if(typeof t=="number"||t instanceof T)return new Oe(e,t,i);if(i=i?{...i}:{},"canonical"in i||(i.canonical=!0),Array.isArray(t)&&t.length===2&&t[0]instanceof T&&t[1]instanceof T){if(!t[0].isInteger()||!t[1].isInteger())throw new Error("Array argument to `boxNumber()` should be two integers");t=[R(t[0].toString()),R(t[1].toString())]}if(Se(t)){if(t.length!==2)throw new Error("Array argument to `boxNumber()` should be two integers or two bignums");let[n,a]=t;if(typeof n=="bigint"&&typeof a=="bigint")return n===a?a===BigInt(0)?e.NaN:e.One:n===BigInt(0)?e.Zero:a===BigInt(1)?e.number(n,i):a===BigInt(-1)?e.number(-n,i):n===BigInt(1)&&a===BigInt(2)?e.Half:new Oe(e,[n,a],i);if(typeof n!="number"||typeof a!="number")throw new Error("Array argument to `boxNumber()` should be two integers or two bignums");if(!isFinite(n)||!isFinite(a))return e.div(e.number(n,i),e.number(a,i));if(!Number.isInteger(n)||!Number.isInteger(a))throw new Error("Array argument to `boxNumber()` should be two integers");return a===n?a===0?e.NaN:e.One:n===0?e.Zero:a===1?e.number(n,i):a===-1?e.number(-n,i):n===1&&a===2?e.Half:new Oe(e,[n,a],i)}if(t instanceof ts.Complex)return t.isNaN()?e.NaN:t.isZero()?e.Zero:t.isInfinite()?e.ComplexInfinity:e.chop(t.im)===0?e.number(t.re,i):new Oe(e,t,i);let r="";if(typeof t=="string")r=t;else if(typeof t=="object"&&"num"in t){if(typeof t.num=="number")return e.number(t.num,i);if(typeof t.num!="string")throw new Error("MathJSON `num` property should be a string of digits");r=t.num}if(r){if(r=r.toLowerCase(),/[0-9][nd]$/.test(r)&&(r=r.slice(0,-1)),r=r.replace(/[\u0009-\u000d\u0020\u00a0]/g,""),r==="nan")return e.NaN;if(r==="infinity"||r==="+infinity")return e.PositiveInfinity;if(r==="-infinity")return e.NegativeInfinity;if(r==="0")return e.Zero;if(r==="1")return e.One;if(r==="-1")return e.NegativeOne;if(/\([0-9]+\)/.test(r)){let[n,a,s,o]=r.match(/(.+)\(([0-9]+)\)(.+)?$/)??[];r=a+s.repeat(Math.ceil(e.precision/s.length))+(o??"")}return $a(e,e.bignum(r),i)}return null}function Va(e,t,i){if(t===null)return e.error("missing");if(typeof t=="object"&&t instanceof ne)return t;if(t=G(t),typeof t=="string")return Le(e,t,i);if(Array.isArray(t)){let r=t.map(n=>Va(e,n,i));return new ze(e,r[0],r.slice(1))}if(typeof t=="object"){if("dict"in t)return new is(e,t.dict);if("fn"in t)return Va(e,t.fn,i);if("str"in t)return new zi(e,t.str);if("sym"in t)return Le(e,t.sym,i);if("num"in t)return Le(e,t.num,i)}return Le(e,t,i)}function Kr(e,t,i,r){if(t==="Hold")return new ze(e,"Hold",[Va(e,i[0],r)],{...r,canonical:!0});if(t==="Error"||t==="ErrorCode")return e._fn(t,i.map(n=>e.box(n,{canonical:!1})),r.metadata);if(t==="Domain")return e.domain(i[0],r.metadata);if(t==="Number"&&i.length===1)return Le(e,i[0],r);if(t==="String")return i.length===0?new zi(e,"",r.metadata):new zi(e,i.map(n=>io(n)??"").join(""),r.metadata);if(t==="Symbol"&&i.length>0)return e.symbol(i.map(n=>io(n)??"").join(""),r);if(r.canonical&&(t==="Divide"||t==="Rational")&&i.length===2){if(i[0]instanceof ne&&i[1]instanceof ne){if(e.numericMode==="machine"){let[s,o]=[N(i[0]),N(i[1])];if(s!==null&&Number.isInteger(s)&&o!==null&&Number.isInteger(o))return e.number([s,o],r)}let[n,a]=[Ta(i[0]),Ta(i[1])];if(n!==null&&a!==null)return e.number([n,a],r)}else{let[n,a]=[Vs(i[0]),Vs(i[1])];if(n!==null&&a!==null)return e.number([n,a],r)}t="Divide"}if(r.canonical&&t==="Complex"){if(i.length===1){let n=Le(e,i[0],r),a=N(n);return a!==null&&a!==0?e.number(e.complex(0,a),r):e.mul(n,e.I)}if(i.length===2){let n=Le(e,i[0],r),a=Le(e,i[1],r),s=N(n),o=N(a);return o!==null&&s!==null?o===0&&s===0?e.Zero:o!==null&&o!==0?e.number(e.complex(s,o),r):n:e.add(n,e.mul(a,e.I))}}if(r.canonical&&t==="Negate"&&i.length===1){let n=i[0];if(typeof n=="number")return e.number(-n,r);if(n instanceof T)return e.number(n.neg(),r);let a=e.box(n,r).numericValue;if(a!==null){if(typeof a=="number")return e.number(-a,r);if(a instanceof T)return e.number(a.neg(),r);if(a instanceof ts.Complex)return e.number(a.neg());if(Se(a))return e.number(at(a))}}if(t==="Dictionary"){let n={};for(let a of i){let s=e.box(a,{canonical:r.canonical}),o=s.head;if(o==="KeyValuePair"||o==="Pair"||o==="Tuple"&&s.nops===2){let l=s.op1;if(l.isValid&&!l.isNothing){let u=s.op2,f=l.symbol??l.string;if(!f&&(l.numericValue!==null||l.string)){let c=typeof l.numericValue=="number"?l.numericValue:W(l);c&&Number.isFinite(c)&&Number.isInteger(c)&&(f=c.toString())}f&&(n[f]=u)}}}return new is(e,n,r)}if(t==="List"&&r.canonical){let n=i.map(o=>Le(e,o)),{shape:a,dtype:s}=Il("List",n)??{};return s&&a?new Ml(e,{head:t,ops:n}):e._fn(t,n)}return r.canonical?Ca(e,t,i,r.metadata):new ze(e,t,i.map(n=>Le(e,n,{canonical:!1})),r)}function Le(e,t,i){if(t==null)return e._fn("Sequence",[]);if(t instanceof ne)return Lt(t,(i==null?void 0:i.canonical)??!0);i=i?{...i}:{},"canonical"in i||(i.canonical=!0);let r=i.canonical===!0;if(Array.isArray(t)){if(re(t))return Number.isInteger(t[0])&&Number.isInteger(t[1])?e.number(t):Lt(Kr(e,"Divide",t,{canonical:r}),i.canonical);if(_e(t))return e.number(t);if(typeof t[0]=="string")return Lt(Kr(e,t[0],t.slice(1),{canonical:r}),i.canonical);Array.isArray(t[0]);let n=t.slice(1).map(s=>Le(e,s,i)),a=Le(e,t[0],{canonical:!1});return Lt(new ze(e,a,n),i.canonical)}if(typeof t=="number"||t instanceof ts.Complex||t instanceof T)return e.number(t);if(typeof t=="string")return t.startsWith("'")&&t.endsWith("'")?new zi(e,t.slice(1,-1)):/^[+-]?[0-9]/.test(t)?e.number(t):In(t)?e.domain(t):Ye(t)?e.symbol(t,{canonical:r}):e.error("invalid-identifier",{str:t});if(typeof t=="object"){let n={latex:t.latex,wikidata:t.wikidata};if("dict"in t)return Lt(new is(e,t.dict,{canonical:!0,metadata:n}),i.canonical);if("fn"in t)return typeof t.fn[0]=="string"?Lt(Kr(e,t.fn[0],t.fn.slice(1),{canonical:r}),i.canonical):Lt(new ze(e,Le(e,t.fn[0],i),t.fn.slice(1).map(a=>Le(e,a,i)),{metadata:n}),i.canonical);if("str"in t)return new zi(e,t.str,n);if("sym"in t)return e.symbol(t.sym,{canonical:r});if("num"in t)return e.number(t,{canonical:r})}return e.symbol("Undefined")}function io(e){if(typeof e=="string")return e;if(e instanceof ne)return e.string??e.symbol??e.toString();if(typeof e=="object"){if("str"in e)return e.str;if("fn"in e&&e.fn[0]==="String"&&typeof e.fn[1]=="string")return e.fn[1]}return Array.isArray(e)&&e[0]==="String"&&typeof e[1]=="string"?e[1]:null}var $l=me(de(),1),Kh=[{Abs:{wikidata:"Q3317982",threadable:!0,idempotent:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","NonNegativeNumbers"],simplify:(e,t)=>na(e,t[0],"simplify"),evaluate:(e,t)=>na(e,t[0],"evaluate"),N:(e,t)=>na(e,t[0],"N")}},Add:{wikidata:"Q32043",associative:!0,commutative:!0,threadable:!0,idempotent:!0,complexity:1300,hold:"all",signature:{domain:"NumericFunctions",result:(e,t)=>xh(e,t.map(i=>i.domain)),simplify:(e,t)=>bl(e,t.map(i=>i.simplify())),evaluate:(e,t)=>Ia(e,t.map(i=>i.evaluate())),N:(e,t)=>Ia(e,t.map(i=>i.N()),"N")}},Ceil:{description:"Rounds a number up to the next largest integer",complexity:1250,threadable:!0,signature:{domain:["FunctionOf","Numbers","Integers"],evaluate:(e,t)=>L(t[0],Math.ceil,i=>i.ceil(),i=>i.ceil(0))}},Chop:{associative:!0,threadable:!0,idempotent:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>L(t[0],i=>e.chop(i),i=>e.chop(i),i=>e.chop(i))}},Divide:{wikidata:"Q1226939",complexity:2500,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],canonical:(e,t)=>{if(t=rt(e,t,2),t.length!==2)return e._fn("Divide",t);let[i,r]=t;return e.div(i,r)},simplify:(e,t)=>Oa(e,t[0],t[1]),evaluate:(e,t)=>wl(e,t[0],t[1])}},Exp:{wikidata:"Q168698",threadable:!0,complexity:3500,signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(e,t)=>(t=rt(e,t,1),t.length!==1?e._fn("Power",[e.E,...t]):e.pow(e.E,t[0]))}},Factorial:{description:"Factorial Function",wikidata:"Q120976",threadable:!0,complexity:9e3,signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(e,t)=>{let i=t[0];return i instanceof Oe&&i.isNegative?e.neg(e._fn("Factorial",[e.neg(i)])):e._fn("Factorial",[i])},evaluate:(e,t)=>{let i=W(t[0]);if(i!==null&&i>=0)return K(e)?e.number(ll(e,e.bignum(i))):e.number(Xo(i));let r=t[0].numericValue;if(r!==null&&r instanceof $l.Complex)return e.number(r.add(1));let n=N(t[0]);if(n!==null)return e.number(un(1+n))}}},Factorial2:{description:"Double Factorial Function",complexity:9e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>{let i=W(t[0]);if(i!==null)return K(e)?e.number(sh(e,e.bignum(i))):e.number(Ef(i))}}},Floor:{wikidata:"Q56860783",complexity:1250,threadable:!0,signature:{domain:["FunctionOf","Numbers","ExtendedRealNumbers"],evaluate:(e,t)=>L(t[0],Math.floor,i=>i.floor(),i=>i.floor(0))}},Gamma:{wikidata:"Q190573",complexity:8e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],N:(e,t)=>L(t[0],i=>un(i),i=>cl(e,i),i=>i)}},GammaLn:{complexity:8e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],N:(e,t)=>L(t[0],i=>Za(i),i=>ul(e,i),i=>i)}},Ln:{description:"Natural Logarithm",wikidata:"Q204037",complexity:4e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],simplify:no,evaluate:no,N:(e,t)=>L(t[0],i=>i>=0?Math.log(i):e.complex(i).log(),i=>i.isNeg()?e.complex(i.toNumber()).log():i.ln(),i=>i.log())}},Log:{description:"Log(z, b = 10) = Logarithm of base b",wikidata:"Q11197",complexity:4100,threadable:!0,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers"],"Numbers"],canonical:(e,t)=>{if(t.length===1)return e._fn("Log",[ht(e,t[0],"Numbers")]);if(t=rt(e,t,2),t.length!==2)return e._fn("Log",t);let[i,r]=t;return r.numericValue===10?e._fn("Log",[i]):e._fn("Log",[i,r])},N:(e,t)=>t[1]===void 0?L(t[0],i=>i>=0?Math.log10(i):e.complex(i).log().div(Math.LN10),i=>i.isNeg()?e.complex(i.toNumber()).log().div(Math.LN10):T.log10(i),i=>i.log().div(Math.LN10)):hn(t[0],t[1],(i,r)=>Math.log(i)/Math.log(r),(i,r)=>i.log(r),(i,r)=>i.log().div(typeof r=="number"?Math.log(r):r.log()))}},Lb:{description:"Base-2 Logarithm",wikidata:"Q581168",complexity:4100,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],N:(e,t)=>L(t[0],i=>i>=0?Math.log2(i):e.complex(i).log().div(Math.LN2),i=>i.isNeg()?T.log10(i):e.complex(i.toNumber()).log().div(Math.LN2),i=>i.log().div(Math.LN2))}},Lg:{description:"Base-10 Logarithm",wikidata:"Q966582",complexity:4100,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],N:(e,t)=>L(t[0],i=>i>=0?Math.log10(i):e.complex(i).log().div(Math.LN10),i=>i.isNeg()?e.complex(i.toNumber()).log().div(Math.LN10):T.log10(i),i=>i.log().div(Math.LN10))}},Mod:{description:"Modulo",wikidata:"Q1799665",complexity:2500,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],evaluate:(e,t)=>{if(t.length!==2)return;let[i,r]=t,n=i.value,a=r.value;if(typeof n=="number"&&typeof a=="number")return e.number((n%a+a)%a)}}},Multiply:{wikidata:"Q40276",associative:!0,commutative:!0,idempotent:!0,complexity:2100,hold:"all",threadable:!0,signature:{domain:"NumericFunctions",simplify:(e,t)=>$h(e,t.map(i=>i.simplify())),evaluate:(e,t)=>Fa(e,t.map(i=>i.evaluate())),N:(e,t)=>Fa(e,t.map(i=>i.N()),"N")}},Negate:{description:"Additive Inverse",wikidata:"Q715358",complexity:2e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],result:(e,t)=>{let i=t[0].domain;if(!(i!=null&&i.base))return i;let r={PositiveNumbers:"NegativeNumbers",NonNegativeNumbers:"NonPositiveNumbers",NonPositiveNumbers:"NonNegativeNumbers",NegativeNumbers:"PositiveNumbers",PositiveIntegers:"NegativeIntegers",NonNegativeIntegers:"NonPositiveIntegers",NonPositiveIntegers:"NonNegativeIntegers",NegativeIntegers:"PositiveIntegers"}[i.base];return r?e.domain(r):i},canonical:(e,t)=>(t=rt(e,t),t.length!==1?e._fn("Negate",t):e.neg(t[0])),simplify:(e,t)=>ia(e,t[0],"simplify"),evaluate:(e,t)=>ia(e,t[0],"evaluate"),N:(e,t)=>ia(e,t[0],"N"),sgn:(e,t)=>{let i=t[0].sgn;if(i!=null){if(i===0)return 0;if(i>0)return-1;if(i<0)return 1}}}},PlusMinus:{description:"Plus or Minus",wikidata:"Q120812",complexity:1200,involution:!0,signature:{domain:["FunctionOf","Values","Tuples"],evaluate:(e,t)=>{if(t.length===1)return e.box(["Pair",t[0],e.neg(t[0])])}}},Power:{wikidata:"Q33456",commutative:!1,threadable:!0,complexity:3500,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],canonical:(e,t)=>{if(t=rt(e,t,2),t.length!==2)return e._fn("Power",t);let[i,r]=t;return i instanceof Oe&&i.isNegative?e.neg(e.pow(i,r)):e.pow(i,r)},simplify:(e,t)=>Di(e,t[0],t[1],"simplify"),evaluate:(e,t)=>Di(e,t[0],t[1],"evaluate"),N:(e,t)=>e.numericMode==="machine"&&typeof t[0].numericValue=="number"&&typeof t[1].numericValue=="number"?e.number(Math.pow(t[0].numericValue,t[1].numericValue)):Di(e,t[0],t[1],"N")}},Rational:{complexity:2400,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers"],"RationalNumbers"],canonical:(e,t)=>(t=Pe(Ae(t)),t.length===0?e._fn("Rational",[e.error("missing")]):t.length===1?e._fn("Rational",[ht(e,t[0],"ExtendedRealNumbers")]):(t=rl(e,t,["Integers","Integers"]),t.length!==2||!t[0].isValid||!t[1].isValid?e._fn("Rational",t):e.div(t[0],t[1]))),simplify:(e,t)=>{if(t.length===2)return Oa(e,t[0],t[1])},evaluate:(e,t)=>{if(t.length===2){let[r,n]=[W(t[0]),W(t[1])];return r!==null&&n!==null?e.number([r,n]):void 0}let i=N(t[0].N());if(i!==null)return e.number(Vf(i))},N:(e,t)=>t.length===1?t[0]:hn(t[0],t[1],(i,r)=>i/r,(i,r)=>i.div(r),(i,r)=>i.div(r))}},Root:{complexity:3200,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],canonical:(e,t)=>{t=rt(e,t,2);let[i,r]=t;return t.length!==2||!i.isValid||!r.isValid?e._fn("Root",t):e.pow(i,e.inv(r))}}},Round:{complexity:1250,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>L(t[0],Math.round,i=>i.round(),i=>i.round(0))}},Sign:{complexity:1200,threadable:!0,signature:{domain:["FunctionOf","Numbers","Integers"],simplify:(e,t)=>{let i=t[0].sgn;if(i===0)return e.Zero;if(i===1)return e.One;if(i===-1)return e.NegativeOne},evaluate:(e,t)=>{let i=t[0].sgn;if(i===0)return e.Zero;if(i===1)return e.One;if(i===-1)return e.NegativeOne},N:(e,t)=>{let i=t[0].sgn;if(i===0)return e.Zero;if(i===1)return e.One;if(i===-1)return e.NegativeOne}}},Sqrt:{description:"Square Root",wikidata:"Q134237",complexity:3e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(e,t)=>(t=Pe(Ae(t)),t.length!==1?e._fn("Sqrt",t):e.pow(t[0],e.Half)),simplify:(e,t)=>jr(e,t[0],"simplify"),evaluate:(e,t)=>jr(e,t[0],"evaluate"),N:(e,t)=>jr(e,t[0],"N")}},Square:{wikidata:"Q3075175",complexity:3100,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(e,t)=>(t=Pe(Ae(t)),t.length!==1?e._fn("Square",t):e._fn("Power",[t[0],e.number(2)]).canonical)}},Subtract:{wikidata:"Q40754",complexity:1350,threadable:!0,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers"],"Numbers"],canonical:(e,t)=>{if(t.length===1){let n=ht(e,t[0],"Numbers");if(n.isValid)return Ze(n)}t=rt(e,t,2);let[i,r]=t;return t.length!==2||!i.isValid||!r.isValid?e._fn("Subtract",t):hr(e,De([i,Ze(r)],"Add"))}}}},{e:{domain:"TranscendentalNumbers",constant:!0,holdUntil:"never",value:"ExponentialE"},i:{domain:"ImaginaryNumbers",constant:!0,holdUntil:"never",flags:{imaginary:!0},value:"ImaginaryUnit"},MachineEpsilon:{domain:"RealNumbers",holdUntil:"N",constant:!0,flags:{real:!0},value:{num:Number.EPSILON.toString()}},Half:{domain:"RationalNumbers",constant:!0,holdUntil:"evaluate",value:["Rational",1,2]},ImaginaryUnit:{domain:"ImaginaryNumbers",constant:!0,holdUntil:"evaluate",wikidata:"Q193796",flags:{imaginary:!0},value:["Complex",0,1]},ExponentialE:{domain:"TranscendentalNumbers",flags:{algebraic:!1,real:!0},wikidata:"Q82435",constant:!0,holdUntil:"N",value:e=>K(e)?e._BIGNUM_ONE.exp():Math.exp(1)},GoldenRatio:{domain:"AlgebraicNumbers",wikidata:"Q41690",constant:!0,flags:{algebraic:!0},holdUntil:"simplify",value:["Divide",["Add",1,["Sqrt",5]],2]},CatalanConstant:{domain:"RealNumbers",flags:{algebraic:void 0},wikidata:"Q855282",constant:!0,holdUntil:"N",value:{num:`0.91596559417721901505460351493238411077414937428167
                  21342664981196217630197762547694793565129261151062
                  48574422619196199579035898803325859059431594737481
                  15840699533202877331946051903872747816408786590902
                  47064841521630002287276409423882599577415088163974
                  70252482011560707644883807873370489900864775113225
                  99713434074854075532307685653357680958352602193823
                  23950800720680355761048235733942319149829836189977
                  06903640418086217941101917532743149978233976105512
                  24779530324875371878665828082360570225594194818097
                  53509711315712615804242723636439850017382875977976
                  53068370092980873887495610893659771940968726844441
                  66804621624339864838916280448281506273022742073884
                  31172218272190472255870531908685735423498539498309
                  91911596738846450861515249962423704374517773723517
                  75440708538464401321748392999947572446199754961975
                  87064007474870701490937678873045869979860644874974
                  64387206238513712392736304998503539223928787979063
                  36440323547845358519277777872709060830319943013323
                  16712476158709792455479119092126201854803963934243
                  `}},EulerGamma:{domain:"RealNumbers",flags:{algebraic:void 0},wikidata:"Q273023",holdUntil:"N",constant:!0,value:{num:`0.57721566490153286060651209008240243104215933593992359880576723488486772677766
          467093694706329174674951463144724980708248096050401448654283622417399764492353
          625350033374293733773767394279259525824709491600873520394816567085323315177661
          152862119950150798479374508570574002992135478614669402960432542151905877553526
          733139925401296742051375413954911168510280798423487758720503843109399736137255
          306088933126760017247953783675927135157722610273492913940798430103417771778088
          154957066107501016191663340152278935867965497252036212879226555953669628176388
          792726801324310104765059637039473949576389065729679296010090151251959509222435
          014093498712282479497471956469763185066761290638110518241974448678363808617494
          551698927923018773910729457815543160050021828440960537724342032854783670151773
          943987003023703395183286900015581939880427074115422278197165230110735658339673`}}},{PreIncrement:{signature:{domain:["FunctionOf","Numbers","Numbers"]}},PreDecrement:{signature:{domain:["FunctionOf","Numbers","Numbers"]}}},{GCD:{description:"Greatest Common Divisor",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Anything"],"Numbers"],evaluate:(e,t)=>ro(e,t,"GCD")}},LCM:{description:"Least Common Multiple",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Anything"],"Numbers"],evaluate:(e,t)=>ro(e,t,"LCM")}},Numerator:{description:"Numerator of an expression",complexity:1200,threadable:!0,hold:"all",signature:{domain:["FunctionOf","Anything","Numbers"],canonical:(e,t)=>{if(t.length===0)return e.box(["Sequence"]);let i=t[0];if(i.head==="Rational"||i.head==="Divide")return i.op1;let r=X(i);return r!==void 0?e.number(r[0]):e._fn("Numerator",Pe(t))},evaluate:(e,t)=>{if(t.length===0)return e.box(["Sequence"]);let i=t[0];if(i.head==="Rational"||i.head==="Divide")return i.op1.evaluate();let r=X(i.evaluate());return r!==void 0?e.number(r[0]):e._fn("Numerator",t.map(n=>n.evaluate()))}}},Denominator:{description:"Denominator of an expression",complexity:1200,threadable:!0,hold:"all",signature:{domain:["FunctionOf","Anything","Numbers"],canonical:(e,t)=>{if(t.length===0)return e.box(["Sequence"]);let i=t[0];if(i.head==="Rational"||i.head==="Divide")return i.op2;let r=X(i);return r!==void 0?e.number(r[1]):e._fn("Denominator",Pe(t))},evaluate:(e,t)=>{if(t.length===0)return e.box(["Sequence"]);let i=t[0];if(i.head==="Rational"||i.head==="Divide")return i.op2.evaluate();let r=X(i.evaluate());return r!==void 0?e.number(r[1]):e._fn("Denominator",t.map(n=>n.evaluate()))}}},NumeratorDenominator:{description:"Sequence of Numerator and Denominator of an expression",complexity:1200,threadable:!0,hold:"all",signature:{domain:["FunctionOf","Anything","Anything"],canonical:(e,t)=>{if(t.length===0)return e.box(["Sequence"]);let i=t[0];if(i.head==="Rational"||i.head==="Divide")return e._fn("Sequence",i.ops);let r=X(i.evaluate());return r!==void 0?e._fn("Sequence",[e.number(r[0]),e.number(r[1])]):e._fn("NumeratorDenominator",t.map(n=>n.evaluate()))},evaluate:(e,t)=>{if(t.length===0)return e.box(["Sequence"]);let i=t[0];if(i.head==="Rational"||i.head==="Divide")return e._fn("Sequence",i.ops);let r=X(i);return r!==void 0?e._fn("Sequence",[e.number(r[0]),e.number(r[1])]):e._fn("NumeratorDenominator",Pe(t))}}}},{Max:{description:"Maximum of two or more numbers",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Values"],"Numbers"],simplify:(e,t)=>t.length===0?e.NegativeInfinity:t.length===1?t[0]:e.box(["Max",...t]),evaluate:(e,t)=>Tr(e,t,"Max")}},Min:{description:"Minimum of two or more numbers",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Values"],"Numbers"],simplify:(e,t)=>t.length===0?e.PositiveInfinity:t.length===1?t[0]:e.box(["Min",...t]),evaluate:(e,t)=>Tr(e,t,"Min")}},Supremum:{description:"Like Max, but defined for open sets",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Values"],"Numbers"],simplify:(e,t)=>t.length===0?e.NegativeInfinity:t.length===1?t[0]:e.box(["Min",...t]),evaluate:(e,t)=>Tr(e,t,"Supremum")}},Infimum:{description:"Like Min, but defined for open sets",complexity:1200,threadable:!1,signature:{domain:["FunctionOf",["VarArg","Values"],"Numbers"],simplify:(e,t)=>t.length===0?e.PositiveInfinity:t.length===1?t[0]:e.box(["Min",...t]),evaluate:(e,t)=>Tr(e,t,"Infimum")}},Product:{wikidata:"Q901718",complexity:1e3,hold:"all",threadable:!1,signature:{domain:["FunctionOf","Anything",["OptArg","Tuples"],"Numbers"],canonical:(e,t)=>Vh(e,t[0],t[1]),simplify:(e,t)=>ra(e,t,"simplify"),evaluate:(e,t)=>ra(e,t,"evaluate"),N:(e,t)=>ra(e,t,"N")}},Sum:{wikidata:"Q218005",complexity:1e3,hold:"all",threadable:!1,signature:{domain:["FunctionOf",["Union","Collections","Functions"],["OptArg","Tuples"],"Numbers"],canonical:(e,t)=>Nh(e,t[0],t[1]),simplify:(e,t)=>ta(e,t,"simplify"),evaluate:(e,t)=>ta(e,t,"evaluate"),N:(e,t)=>ta(e,t,"N")}}},{BaseForm:{description:"`BaseForm(expr, base=10)`",complexity:9e3,inert:!0,signature:{domain:["FunctionOf","Values",["OptArg","Integers"],"Values"],result:(e,t)=>t[0].domain}},FromDigits:{description:"`FromDigits(s, base=10)`       return an integer representation of the string `s` in base `base`.",signature:{domain:["FunctionOf","Strings",["OptArg","Anything"],"Integers"],evaluate:(e,t)=>{var o,l;let i=(o=t[0])==null?void 0:o.string;if(!i)return e.domainError("Strings",(l=t[0])==null?void 0:l.domain,t[0]);if(i=i.trim(),i.startsWith("0x"))return e.number(parseInt(i.slice(2),16));if(i.startsWith("0b"))return e.number(parseInt(i.slice(2),2));let r=t[1]??e.Nothing;if(r.isNothing)return e.number(Number.parseInt(i,10));let n=N(r);if(n&&(!Number.isInteger(n)||n<2||n>36))return e.error(["unexpected-base",n],r);let[a,s]=cn(i,r.string??r.symbol??10);return s?e.error(["unexpected-digit",{str:s[0]}],{str:s}):e.number(a)}}},IntegerString:{description:"`IntegerString(n, base=10)`       return a string representation of the integer `n` in base `base`.",threadable:!0,signature:{domain:["FunctionOf","Integers",["OptArg","Integers"],"Strings"],evaluate:(e,t)=>{let i=t[0],r=N(i)??NaN;if(Number.isNaN(r)||!Number.isInteger(r))return e.domainError("Integers",i.domain,i);let n=t[1]??e.Nothing;if(n.isNothing){let s=i.numericValue;return typeof s=="number"?e.string(Math.abs(s).toString()):s instanceof T?e.string(s.abs().toString()):e.string(Math.abs(Math.round(N(i)??NaN)).toString())}if(W(n)===null)return e.domainError("Integers",n.domain,n);let a=W(n);return a<2||a>36?e.error(["out-of-range",2,36,a],n):e.string(Math.abs(r).toString(a))}}}}];function na(e,t,i){if(i!=="simplify"){let r=t.numericValue;if(r!==null){if(typeof r=="number")return e.number(Math.abs(r));if(r instanceof T||r instanceof $l.Complex)return e.number(r.abs());if(re(r))return e.number(i==="N"?Math.abs(r[0]/r[1]):[Math.abs(r[0]),r[1]]);if(_e(r)){let[n,a]=r;return e.number(i==="N"?e.bignum(n).div(e.bignum(a)).abs():[n>0?n:-n,a])}}}if(t.isNonNegative)return t;if(t.isNegative)return e.neg(t)}function Vl(e,t){let i=e.engine,r=t==="Max"||t==="Supremum";if(e.head==="Interval"){let n=r?e.op2:e.op1;return!n.isNumber||n.numericValue===void 0?[void 0,[e]]:[n,[]]}if(e.head==="Range"){if(e.nops===1)e=r?e.op1:i.One;else if(!r)e=e.op1;else{let n=e.nops===2?1:N(e.op3);if(n===null||!isFinite(n))return[void 0,[e]];let[a,s]=[N(e.op1),N(e.op2)];if(a===null||s===null)return[void 0,[e]];let o=Math.floor((s-a)/n);e=i.number(a+n*o)}return[e,[]]}if(e.head==="Linspace")return e.nops===1?e=r?e.op1:i.One:r?e=e.op2:e=e.op1,[e,[]];if(Qa(e)){let n,a=[];for(let s of ce(e)){let[o,l]=Vl(s,t);o&&(n?(r&&o.isGreater(n)||!r&&o.isLess(n))&&(n=o):n=o),a.push(...l)}return[n,a]}return!e.isNumber||e.numericValue===void 0?[void 0,[e]]:[e,[]]}function Tr(e,t,i){let r=i==="Max"||i==="Supremum";if(t.length===0)return r?e.NegativeInfinity:e.PositiveInfinity;let n,a=[];for(let s of t){let[o,l]=Vl(s,i);o&&(n?(r&&o.isGreater(n)||!r&&o.isLess(n))&&(n=o):n=o),a.push(...l)}return a.length>0?e.box(n?[i,n,...a]:[i,...a]):n??(r?e.NegativeInfinity:e.PositiveInfinity)}function ro(e,t,i){let r=i==="LCM"?Yo:gr,n=i==="LCM"?ah:ol,a=[];if(K(e)){let o=null;for(let l of t)if(o===null)o=Yt(l),(o===null||!o.isInteger())&&a.push(l);else{let u=Yt(l);u&&u.isInteger()?o=n(o,u):a.push(l)}return a.length===0?o===null?e.One:e.number(o):o===null?e._fn(i,a):e._fn(i,[e.number(o),...a])}let s=null;for(let o of t)if(s===null)s=N(o),(s===null||!Number.isInteger(s))&&a.push(o);else{let l=N(o);l&&Number.isInteger(l)?s=r(s,l):a.push(o)}return a.length===0?s===null?e.One:e.number(s):s===null?e._fn(i,a):e._fn(i,[e.number(s),...a])}function no(e,t){let i=t[0];if(i.isZero)return e.NaN;if(i.isOne)return e.Zero;if(i.isNegativeOne&&Fe(e))return e.mul(e.Pi,e.I);if(i.symbol==="ExponentialE")return e.One;if(i.head==="Power"&&i.op1.symbol==="ExporentialE")return i.op2;if(i.head==="Power"){let[r,n]=i.ops;return e.mul(n,e.box(["Ln",r]).simplify())}if(i.head==="Multiply"){let[r,n]=i.ops;return e.add(e.box(["Ln",r]).simplify(),e.box(["Ln",n]).simplify())}if(i.head==="Divide"){let[r,n]=i.ops;return e.add(e.box(["Ln",r]).simplify(),e.neg(e.box(["Ln",n]).simplify()))}}var Yh={Sin:["Cos","_"],Cos:["Negate",["Sin","_"]],Tan:["Power",["Sec","_"],2],Sec:["Multiply",["Tan","_"],["Sec","_"]],Csc:["Multiply",["Negate",["Cot","_"]],["Csc","_"]],Cot:["Negate",["Power",["Csc","_"],2]],Arcsin:["Power",["Subtract",1,["Power","_",2]],["Negate","Half"]],Arccos:["Negate",["Power",["Subtract",1,["Power","_",2]],["Negate","Half"]]],Arctan:["Power",["Add",1,["Power","_",2]],-1],Arcsec:["Multiply",["Power",["Subtract",1,["Power","_",2]],["Negate","Half"]],["Negate",["Power","_",2]]],Arccsc:["Multiply",["Power",["Subtract",1,["Power","_",2]],["Negate","Half"]],["Negate",["Power","_",2]]],Arccot:["Negate",["Power",["Add",1,["Power","_",2]],-1]],Sinh:["Cosh","_"],Cosh:["Sinh","_"],Tanh:["Power",["Sech","_"],2],Sech:["Multiply",["Tanh","_"],"Sech"],Csch:["Multiply",["Coth","_"],"Csch"],Coth:["Negate",["Power",["Csch","_"],2]],Arcsinh:["Power",["Add",["Power","_",2],1],["Negate","Half"]],Arccosh:["Power",["Subtract",["Power","_",2],1],["Negate","Half"]],Arctanh:["Power",["Subtract",1,["Power","_",2]],-1],Arcsech:["Negate",["Power",["Multiply","2","Subtract",["Power","_",2]],["Negate","Half"]]],Arccsch:["Negate",["Power",["Multiply","2","Add",["Power","_",2]],["Negate","Half"]]],Arccoth:["Negate",["Power",["Subtract",1,["Power","_",2]],-1]],Ln:["Divide",1,"_"],Log:["Power",["Multiply","_",["Ln","10"]],-1],Sqrt:["Multiply",["Power","_",["Negate","Half"]],"Half"],Abs:["Piecewise",["Tuple",["Multiply","_",["Power","_",-1]],["Greater","_",0]]],Erf:["Multiply",["Divide","2",["Sqrt","Pi"]],["Exp",["Negate",["Square","_"]]]],Gamma:["Multiply",["Gamma","_"],["Digamma","_"]],Digamma:["Add",["Multiply",["Digamma","_"],["Gamma","_"]],["Multiply",["Power","_",-1],["Gamma","_"]]],Zeta:["Multiply",["Multiply",-1,["Zeta","_"]],["Digamma","_"]],PolyGamma:["Add",["Multiply",["PolyGamma","_"],["Gamma","_"]],["Multiply",["Power","_",-1],["Gamma","_"]]],Beta:["Multiply",["Add",["Multiply",["Beta","_"],["Digamma","_"]],["Multiply",["Power","_",-1],["Beta","_"]]],["Beta","_"]],Erfc:["Multiply",["Negate",["Erfc","_"]],["Exp",["Negate",["Power","_",2]]],["Power","_",-1]],LambertW:["Multiply",["Power","_",-1],["Multiply",["Add","_",["LambertW","_"]],["Add",["LambertW","_"],1]]],AiryAi:["Multiply",["AiryAi","_"],["AiryBi","_"]],AiryBi:["Multiply",["AiryAi","_"],["AiryBi","_"]],BesselJ:["Multiply",["BesselJ","_"],["BesselY","_"]],BesselY:["Multiply",["BesselJ","_"],["BesselY","_"]],BesselI:["Multiply",["BesselI","_"],["BesselK","_"]],BesselK:["Multiply",["BesselI","_"],["BesselK","_"]],FresnelS:["Multiply",["FresnelS","_"],["FresnelC","_"]],FresnelC:["Multiply",["FresnelS","_"],["FresnelC","_"]],Erfi:["Multiply",["Erfi","_"],["Erf","_"]]};function Ke(e,t){let i=e.engine;if(!(e.string||e.keys)){if(e.numericValue!==null)return e.engine.Zero;if(e.symbol===t)return e.engine.One;if(e.symbol)return e.engine.Zero;if(e.head&&typeof e.head=="string"){if(e.head==="Negate"){let s=Ke(e.op1,t);return s?i.neg(s):i.neg(i._fn("D",[e.op1,i.symbol(t)]))}if(e.head==="Add"){let s=e.ops.map(o=>Ke(o,t));return s.some(o=>o===void 0)?void 0:i.add(...s)}if(e.head==="Multiply"){let s=e.ops.map((o,l)=>{let u=e.ops.slice();u.splice(l,1);let f=i.mul(...u),c=Ke(o,t)??i._fn("D",[o,i.symbol(t)]);return i.mul(c,f)});return s.some(o=>o===void 0)?void 0:i.add(...s)}if(e.head==="Power"){let[s,o]=e.ops;if(s.symbol===t)return i.mul(o,i.pow(s,i.add(o,i.NegativeOne)));let l=s,u=o,f=Ke(l,t)??i._fn("D",[l,i.symbol(t)]),c=Ke(u,t)??i._fn("D",[u,i.symbol(t)]),h=i.box(["Ln",l]).evaluate(),p=i.mul(c,h),m=i.mul(u,f),d=i.div(m,l);return i.mul(e,i.add(p,d))}if(e.head==="Divide"){let[s,o]=e.ops,l=Ke(s,t)??i._fn("D",[s,i.symbol(t)]),u=Ke(o,t)??i._fn("D",[o,i.symbol(t)]);return i.div(i.add(i.mul(l,o),i.neg(i.mul(u,s))),i.pow(o,2))}let r=Yh[e.head];if(!r){if(e.nops>1)return;let s=i._fn("Derivative",[i.symbol(e.head),i.One]);if(!s.isValid)return;let o=e.ops[0],l=Ke(o,t)??i._fn("D",[o,i.symbol(t)]);return l.isValid?i.mul(i._fn("Apply",[s,o]),l):void 0}if(e.nops>1)return i._fn("D",[e,i.symbol(t)]);let n=e.ops[0],a=Ke(n,t)??i._fn("D",[n,i.symbol(t)]);return i.mul(xn(i.box(r),[n]),a)}}}var Xh=[{Derivative:{hold:"all",threadable:!1,signature:{domain:["FunctionOf","Functions",["OptArg","Numbers"],"Functions"],canonical:(e,t)=>{var i;return t[0].functionDefinition?((i=Ke(e._fn(t[0].canonical,[e.symbol("_")]),"_"))==null?void 0:i.canonical)??e._fn("Derivative",t):e._fn("Derivative",t)},simplify:(e,t)=>{let i=t[0].simplify();return t[1]?e._fn("Derivative",[i,t[1]]):e._fn("Derivative",[i])},evaluate:(e,t)=>{var n;let i=t[0].evaluate();if(i.functionDefinition)return((n=Ke(e._fn(i,[e.symbol("_")]),"_"))==null?void 0:n.canonical)??void 0;let r=Ke(i,"_");if(r)return r.canonical}}},D:{hold:"all",threadable:!1,signature:{domain:["FunctionOf","Anything","Symbols",["VarArg","Symbols"],"Anything"],canonical:(e,t)=>{let i=t[0];if(!i)return null;e.pushScope();let r=t.slice(1);i.bind(),i=i.canonical;let n=e._fn("D",[i,...r]);return e.popScope(),n},evaluate:(e,t)=>{let i=t[0].canonical,r=e.swapScope(i.scope);i=i.evaluate();let n=t.slice(1);n.length===0&&(i=void 0);for(let a of n){if(!a.symbol){i=void 0;break}if(i=Ke(i,a.symbol),i===void 0)break}return e.swapScope(r),i=i==null?void 0:i.canonical,(i==null?void 0:i.head)==="D"?i:i==null?void 0:i.evaluate()}}},ND:{hold:"first",threadable:!1,signature:{domain:["FunctionOf","Anything","Numbers","Functions"],N:(e,t)=>{var n;let i=(n=t[1])==null?void 0:n.value;if(typeof i!="number")return;let r=Ks(e.box(t[0]));return e.number(Mf(r,i))}}},Integrate:{wikidata:"Q80091",hold:"all",threadable:!1,signature:{domain:["FunctionOf","Functions",["OptArg",["Union","Tuples","Symbols"]],"Numbers"],canonical:(e,t)=>{var o,l,u,f,c;let i=t[1],r=null,n=null,a=null;i&&i.head!=="Tuple"&&i.head!=="Triple"&&i.head!=="Pair"&&i.head!=="Single"?r=i:i&&(r=((o=i.ops)==null?void 0:o[0])??null,n=((u=(l=i.ops)==null?void 0:l[1])==null?void 0:u.canonical)??null,a=((c=(f=i.ops)==null?void 0:f[2])==null?void 0:c.canonical)??null),r&&r.head==="Hold"&&(r=r.op1),r&&r.head==="ReleaseHold"&&(r=r.op1.evaluate()),r??(r=e.Nothing),r.symbol||(r=e.domainError("Symbols",r.domain,r)),n&&(n=ht(e,n,e.Numbers)),a&&(a=ht(e,a,e.Numbers)),n&&a?i=e.tuple([r,n,a]):a?i=e.tuple([r,e.NegativeInfinity,a]):n?i=e.tuple([r,n]):i=r;let s=t[0]??e.error("missing");return s=s.canonical,s.head==="Delimiter"&&s.op1.head==="Sequence"&&(s=s.op1.op1),e._fn("Integrate",[s,i])}}},NIntegrate:{hold:"first",threadable:!1,signature:{domain:["FunctionOf","Functions","Numbers","Numbers","Numbers"],evaluate:(e,t)=>{let i=e.numericMode,r=e.precision;e.numericMode="machine";let n=Ks(t[0]),[a,s]=t.slice(1).map(l=>l.value),o;return typeof a=="number"&&typeof s=="number"&&(o=e.number(If(n,a,s))),e.numericMode=i,e.precision=r,o}}}},{Limit:{description:"Limit of a function",complexity:5e3,hold:"all",threadable:!1,signature:{domain:["FunctionOf","Anything","Numbers",["OptArg","Numbers"],"Numbers"],N:(e,t)=>{let[i,r,n]=t,a=N(r.N());if(a===null)return;let s=yn(i);return e.number(cr(o=>{var u;let l=(u=s([e.number(o)]))==null?void 0:u.value;return typeof l=="number"?l:Number.NaN},a,n?N(n)??1:1))}}},NLimit:{description:"Numerical approximation of the limit of a function",complexity:5e3,hold:"all",threadable:!1,signature:{domain:["FunctionOf","Anything","Numbers",["OptArg","Numbers"],"Numbers"],evaluate:(e,t)=>{let[i,r,n]=t,a=N(r.N());if(a===null)return;let s=yn(i);return e.number(cr(o=>{var u;let l=(u=s([e.number(o)]))==null?void 0:u.value;return typeof l=="number"?l:Number.NaN},a,n?N(n)??1:1))}}}}],Er=50,ep={List:{complexity:8200,hold:"all",signature:{domain:["FunctionOf",["VarArg","Anything"],"Lists"],canonical:ip},size:e=>e.nops,iterator:(e,t,i)=>{let r=t??1;return i=Math.min(i??e.nops,e.nops),i<=0?{next:()=>({value:void 0,done:!0})}:{next:()=>i>0?(i--,{value:e.ops[r++-1],done:!1}):{value:void 0,done:!0}}},at:(e,t)=>{if(typeof t=="number"&&!(t<1||t>e.nops))return e.ops[t-1]},indexOf:(e,t,i)=>{if(i??(i=1),i<0){if(i<-e.nops)return;i=e.nops+i+1;let n=i;for(let a=n;a>=1;a--)if(e.ops[a-1].isEqual(t))return a;return}let r=i;for(let n=r;n<=e.nops;n++)if(e.ops[n-1].isEqual(t))return n}},Range:{complexity:8200,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers","Numbers"],"Values"]},size:e=>{let[t,i,r]=Yr(e);return!isFinite(t)||!isFinite(i)?1/0:1+Math.max(0,Math.floor((i-t)/r))},at:(e,t)=>{if(typeof t!="number")return;let[i,r,n]=Yr(e);if(!(t<1||t>1+(r-i)/n))return e.engine.number(i+n*(t-1))},iterator:(e,t,i)=>{let[r,n,a]=Yr(e),s=t??1;return i=Math.min(i??n,n),i<=0?{next:()=>({value:void 0,done:!0})}:{next:()=>i>0?(i--,{value:e.engine.number(r+a*(s++-1)),done:!1}):{value:void 0,done:!0}}}},Linspace:{complexity:8200,signature:{domain:["FunctionOf","Numbers",["OptArg","Numbers","Numbers"],"Values"]},size:e=>{let t=N(e.op3)??Er;return Math.max(0,Math.floor(t))},at:(e,t)=>{if(typeof t!="number")return;let i=N(e.op1),r=N(e.op2),n=N(e.op3)??Er;if(!(i===void 0||r===void 0)&&!(t<1||t>n))return e.engine.number(i+(r-i)*(t-1)/n)},iterator:(e,t,i)=>{let r=N(e.op1),n=N(e.op2),a;n===void 0?(n=r,r=1,a=Er):a=Math.max(0,N(e.op3)??Er);let s=t??1;return i=Math.min(i??a,a),i<=0?{next:()=>({value:void 0,done:!0})}:{next:()=>i>0?(i--,{value:e.engine.number(r+(n-r)*(s++-1)/a),done:!1}):{value:void 0,done:!0}}}},KeyValuePair:{description:"A key/value pair",complexity:8200,signature:{domain:["FunctionOf","Strings","Anything","Tuples"],canonical:(e,t)=>{let[i,r]=rl(e,t,[e.Strings,"Values"]);return!i.isValid||!r.isValid?e._fn("KeyValuePair",[i,r]):e.tuple([i,r])}},size:e=>1},Single:{description:"A tuple with a single element",complexity:8200,signature:{domain:["FunctionOf","Anything","Tuples"],canonical:(e,t)=>e.tuple(et(e,t,1))},size:e=>e.nops,at:(e,t)=>{if(!(typeof t!="number"||t!==1))return e.ops[0]}},Pair:{description:"A tuple of two elements",complexity:8200,signature:{domain:["FunctionOf","Anything","Anything","Tuples"],canonical:(e,t)=>e.tuple(et(e,t,2))},size:e=>e.nops,at:(e,t)=>typeof t=="number"?e.ops[t-1]:void 0},Triple:{description:"A tuple of three elements",complexity:8200,signature:{domain:["FunctionOf","Anything","Anything","Anything","Tuples"],canonical:(e,t)=>e.tuple(et(e,t,3))},size:e=>e.nops,at:(e,t)=>typeof t=="number"?e.ops[t-1]:void 0},Tuple:{description:"A fixed number of heterogeneous elements",complexity:8200,signature:{domain:["FunctionOf","Anything",["VarArg","Anything"],"Tuples"],canonical:(e,t)=>e.tuple(Pe(t))},size:e=>e.nops,at:(e,t)=>typeof t=="number"?e.ops[t-1]:void 0},String:{threadable:!0,signature:{domain:["FunctionOf",["OptArg","Anything"],"Strings"],evaluate:(e,t)=>t.length===0?e.string(""):e.string(t.map(i=>i.string??i.toString()).join(""))}},Length:{complexity:8200,signature:{domain:["FunctionOf","Values","Numbers"],evaluate:(e,t)=>{let i=t[0].functionDefinition;if(i!=null&&i.size)return e.number(i.size(t[0]));let r=t[0].string;return r!==null?e.number(r.length):e.Zero}}},IsEmpty:{complexity:8200,signature:{domain:["FunctionOf","Values","Numbers"],evaluate:(e,t)=>{let i=t[0].functionDefinition,r;if(i!=null&&i.size)r=i.size(t[0]);else{let n=t[0].string;n!==null&&(r=n.length)}if(r!==void 0)return r===0?e.True:e.False}}},Take:{complexity:8200,signature:{domain:["FunctionOf","Values",["VarArg","Values"],"Values"],evaluate:(e,t)=>{var n,a;if(t.length<2)return;let i=t[0].string;if(i!==null){let s=t.slice(1).map(o=>Ar(o,i.length));return e.string(tp(i,s))}let r=(a=(n=t[0].functionDefinition)==null?void 0:n.size)==null?void 0:a.call(n,t[0]);return Mr(t[0],t.slice(1).map(s=>Ar(s,r)))}}},Drop:{complexity:8200,signature:{domain:["FunctionOf","Values",["VarArg","Values"],"Values"],evaluate:(e,t)=>{var o;if(t.length<2)return;let i=t[0].string;if(i!==null){let l=ao(t.slice(1).map(u=>Ar(u,i.length)));return e.string(i.split("").filter((u,f)=>!l.includes(f+1)).join(""))}let r=t[0].functionDefinition,n=(o=r==null?void 0:r.size)==null?void 0:o.call(r,t[0]);if(!n||!(r!=null&&r.at))return e.Nothing;let a=ao(t.slice(1).map(l=>Ar(l,n))),s=[];for(let l=1;l<=n;l++)if(!a.includes(l)){let u=r.at(t[0],l);u&&s.push(u)}return e.box(["List",...s])}}},At:{complexity:8200,signature:{domain:["FunctionOf","Values","Values","Values"],evaluate:(e,t)=>{let i=t[0],r=i.functionDefinition;if(!(r!=null&&r.at))return;if(t[1].string!==null)return r.at(i,1)??e.Nothing;let n=N(t[1]);if(!(n===null||!Number.isInteger(n)))return r.at(i,n)??e.Nothing}}},First:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{let i=t[0],r=i.functionDefinition;return r!=null&&r.at?r.at(i,1)??e.Nothing:e.Nothing}}},Second:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{let i=t[0],r=i.functionDefinition;return r!=null&&r.at?r.at(i,2)??e.Nothing:e.Nothing}}},Last:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{let i=t[0],r=i.functionDefinition;return r!=null&&r.at?r.at(i,-1)??e.Nothing:e.Nothing}}},Rest:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>Mr(t[0],[[2,-1,1]])}},Most:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>Mr(t[0],[[1,-2,1]])}},Reverse:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>Mr(t[0],[[-1,2,1]])}},Ordering:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Functions"],"Values"],evaluate:(e,t)=>{}}},Sort:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Functions"],"Values"],evaluate:(e,t)=>{}}},Shuffle:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{}}},Map:{complexity:8200,signature:{domain:["FunctionOf","Collections","Functions","Collections"],evaluate:(e,t)=>{}}},Filter:{complexity:8200,signature:{domain:["FunctionOf","Values","Functions","Values"],evaluate:(e,t)=>{}}},Reduce:{complexity:8200,signature:{domain:["FunctionOf","Values","Functions",["OptArg","Values"],"Values"],evaluate:(e,t)=>{}}},Tabulate:{complexity:8200,signature:{domain:["FunctionOf","Functions","Integers",["VarArg","Integers"],"Values"],evaluate:(e,t)=>{}}},Tally:{complexity:8200,signature:{domain:["FunctionOf","Values","Tuples"],evaluate:(e,t)=>{}}},Unique:{complexity:8200,signature:{domain:["FunctionOf","Values","Tuples"],evaluate:(e,t)=>{}}},Zip:{complexity:8200,signature:{domain:["FunctionOf","Values",["VarArg","Values"],"Values"],evaluate:(e,t)=>{}}},RotateLeft:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Integers"],"Values"],evaluate:(e,t)=>{}}},RotateRight:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Integers"],"Values"],evaluate:(e,t)=>{}}},Join:{complexity:8200,signature:{domain:["FunctionOf",["VarArg","Values"],"Values"],evaluate:(e,t)=>{}}},Iterate:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Values"],"Values"],evaluate:(e,t)=>{}}},Repeat:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{}}},Cycle:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{}}},Fill:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{}}}};function Yr(e){let t=N(e.op1)??1,i=N(e.op2);if(i===void 0)return[1,t,1];let r=N(e.op3)??1;return[t,i,r]}function Ar(e,t){if(!e)return[0,0,0];let i=N(e);if(i!==null){if(i=Math.round(i),i<0){if(t===void 0)return[0,0,0];i=t+i+1}return[i,i,1]}let r=e.head;if(!r||typeof r!="string"||!/^(Single|Pair|Triple|Tuple|)$/.test(r))return[0,0,0];let[n,a,s]=Yr(e);return(n<0||a<0)&&t===void 0?[0,0,0]:(n<0&&(n=t+n+1),a<0&&(a=t+a+1),s=Math.abs(Math.round(s)),s===0?[0,0,0]:(n>a&&(s=-s),[n,a,s]))}function Mr(e,t){let i=e.engine,r=e.functionDefinition;if(!(r!=null&&r.at))return i.Nothing;let n=[];for(let a of t){let[s,o,l]=a;if(l!==0)if(l<0)for(let u=s;u>=o;u+=l){let f=r.at(e,u);f&&n.push(f)}else for(let u=s;u<=o;u+=l){let f=r.at(e,u);f&&n.push(f)}}return i.box(["List",...n])}function tp(e,t){let i="";for(let r of t){let[n,a,s]=r;if(s===1)i+=e.slice(n-1,a);else if(s<0)for(let o=n;o>=a;o+=s)i+=e[o-1];else for(let o=n;o<=a;o+=s)i+=e[o-1]}return i}function ao(e){let t=[];for(let i of e){let[r,n,a]=i;if(a!==0)if(a<0)for(let s=r;s>=n;s+=a)t.push(s);else for(let s=r;s<=n;s+=a)t.push(s)}return t}function ip(e,t){let i=t[0];if(t.length===1&&i.head==="Matrix"){let[r,n,a]=i.ops;if(!n||n.string==="..")return a?e._fn("Matrix",[r,e.string("[]"),a]):e._fn("Matrix",[r,n])}return t=t.map(r=>{var n;return r.head==="Delimiter"?r.op1.head==="Sequence"?e.box(["List",...Pe(r.op1.ops)]):e.box(["List",((n=r.op1)==null?void 0:n.canonical)??e.Nothing]):r.canonical}),e.box(["List",...t])}var rp=[{Block:{hold:"all",signature:{domain:"Functions",canonical:op,evaluate:sp}},If:{hold:"rest",signature:{domain:"Functions",result:(e,t)=>vr(t[0],t[1]),evaluate:(e,t)=>{let i=t[0];return i&&i.symbol==="True"?t[1]?t[1].evaluate():e.Nothing:t[2]?t[2].evaluate():e.Nothing}}},Loop:{hold:"all",signature:{domain:"Functions",evaluate:(e,t)=>{let i=t[0]??e.Nothing;if(i.isNothing)return i;let r=t[1];if(r&&Qa(r)){let a,s=yn(i),o=0;for(let l of ce(r)){if(a=s([l])??e.Nothing,a.head==="Break")return a.op1;if(a.head==="Return")return a;if(o++>e.iterationLimit)return e.error("iteration-limit-exceeded")}}let n=0;for(;;){let a=i.evaluate();if(a.head==="Break")return a.op1;if(a.head==="Return")return a;if(n++>e.iterationLimit)return e.error("iteration-limit-exceeded")}}}},Which:{hold:"all",signature:{domain:"Functions",result:(e,t)=>np(e,t),evaluate:(e,t)=>ap(e,t,"evaluate")}},FixedPoint:{hold:"all",signature:{domain:"Functions"}}}];function np(e,t){let i=null;for(let r=1;r<=t.length-1;r+=2)i=vr(i,t[r].domain);return i??e.domain("NothingDomain")}function ap(e,t,i){let r=0;for(;r<t.length-1;){if(t[r].evaluate().symbol==="True")return t[r+1]?i==="N"?t[r+1].N():t[r+1].evaluate():e.symbol("Undefined");r+=2}return e.symbol("Undefined")}function sp(e,t){if(t.length===0)return e.Nothing;e.resetContext();let i;for(let r of t){let n=r.head;if(n==="Return"){i=r.op1.evaluate();break}if(n==="Break"||n==="Continue"){i=e.box([n,r.op1.evaluate()]);break}i=r.evaluate()}return i??e.Nothing}function op(e,t){if(t.length===0)return null;e.pushScope();let i=[],r=[];for(let a of t)a.head==="Declare"?i.push(a):r.push(zl(a));let n=e._fn("Block",[...i,...r]);return e.popScope(),n}function zl(e){return e.head==="Declare"&&e.engine.error("unexpected-declare"),e.ops?e.engine._fn(e.head,e.ops.map(zl)):e}var lp=[{Real:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>{let i=t[0].numericValue;if(i!==null)return e.isComplex(i)?e.number(i.re):t[0]}}},Imaginary:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>{let i=t[0].numericValue;if(i!==null)return e.isComplex(i)?e.number(i.im):e.Zero}}},Argument:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>{let i=t[0].numericValue;if(i===null)return;if(e.isComplex(i))return e.number(i.arg());let r=N(t[0]);if(r!==null)return r>=0?e.Zero:e.Pi}}},AbsArg:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Tuples"],evaluate:(e,t)=>{let i=t[0].numericValue;if(i===null)return;if(e.isComplex(i))return e.tuple([e.number(i.abs()),e.number(i.arg())]);let r=N(t[0]);if(r!==null)return e.tuple([e.number(Math.abs(r)),e.number(r>=0?0:Math.PI)])}}},Conjugate:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>{let i=t[0].numericValue;if(!(i===null||!e.isComplex(i)))return e.number(i.conjugate())}}},ComplexRoots:{threadable:!0,complexity:1200,signature:{domain:["FunctionOf","Numbers","Numbers","Lists"],evaluate:(e,t)=>{let i=N(t[0]),r=N(t[1]);if(i===null||r===null||!Number.isInteger(r)||r<=0)return;let n=[],[a,s]=e.isComplex(i)?[i.re,i.im]:[i,0],o=Math.atan2(s,a),l=Math.sqrt(a*a+s*s);for(let u=0;u<r;u++){let f=(o+2*Math.PI*u)/r,c=Math.pow(l,1/r);n.push([c*Math.cos(f),c*Math.sin(f)])}return e.box(["List",...n.map(u=>e.number(u[1]!==0?e.complex(u[0],u[1]):u[0]))])}}}}],up=[{Matrix:{complexity:9e3,hold:"all",signature:{params:["Lists"],optParams:["Strings","Strings"],result:"Lists",canonical:cp,evaluate:(e,t)=>t[0].evaluate(),N:(e,t)=>t[0].N()}},Vector:{complexity:9e3,hold:"all",signature:{restParam:"Anything",result:"Lists",canonical:(e,t)=>e._fn("Matrix",[e.box(["List",...e.canonical(t).map(i=>e.box(["List",i]))])])}}},{Shape:{complexity:8200,signature:{domain:["FunctionOf","Values","Tuples"],evaluate:(e,t)=>{let i=t[0];return Qe(i)?e.tuple(i.tensor.shape):e.tuple([])}}},Rank:{complexity:8200,signature:{domain:["FunctionOf","Values","Numbers"],evaluate:(e,t)=>{let i=t[0];return Qe(i)?e.number(i.tensor.rank):e.Zero}}},Reshape:{complexity:8200,signature:{domain:["FunctionOf","Values","Tuples","Values"],evaluate:(e,t)=>{var n;let i=t[0],r=((n=t[1].ops)==null?void 0:n.map(a=>a.value))??[];if(!Qe(i)&&Ee(i)&&(i=e.box(["List",...ce(i)])),Qe(i))return i.tensor.reshape(...r).expression}}},Flatten:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{let i=t[0];if(Qe(i))return e.box(["List",...i.tensor.flatten().map(r=>e.box(r))]);if(Ee(i))return e.box(["List",...ce(i)])}}},Transpose:{complexity:8200,signature:{domain:["FunctionOf","Values",["OptArg","Numbers","Numbers"],"Values"],evaluate:(e,t)=>{var a,s;let i=t[0],r=1,n=2;if(t.length===3&&(r=t[1].value,n=t[2].value,r>0&&n>0),r!==n&&(!Qe(i)&&Ee(i)&&(i=e.box(["List",...ce(i)])),Qe(i)))return r===1&&n===2?(a=i.tensor.transpose())==null?void 0:a.expression:(s=i.tensor.transpose(r,n))==null?void 0:s.expression}}},ConjugateTranspose:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{var a;let i=t[0],r=1,n=2;if(t.length===3&&(r=t[1].value,n=t[2].value,r>0&&n>0),r!==n&&Qe(i))return(a=i.tensor.conjugateTranspose(r,n))==null?void 0:a.expression}}},Determinant:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{let i=t[0];if(Qe(i))return i.tensor.determinant()}}},Inverse:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{var r;let i=t[0];if(Qe(i))return(r=i.tensor.inverse())==null?void 0:r.expression}}},PseudoInverse:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{var r;let i=t[0];if(Qe(i))return(r=i.tensor.pseudoInverse())==null?void 0:r.expression}}},AdjugateMatrix:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{var r;let i=t[0];if(Qe(i))return(r=i.tensor.adjugateMatrix())==null?void 0:r.expression}}},Trace:{complexity:8200,signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{let i=t[0];if(Qe(i))return i.tensor.trace()}}}}];function cp(e,t,i="Matrix"){var s,o;if(t.length===0)return e._fn(i,[]);let r=t[0].head==="Vector"?t[0].canonical.ops[0]:t[0].canonical,n=(s=t[1])==null?void 0:s.canonical,a=(o=t[2])==null?void 0:o.canonical;return t.length>3?e._fn(i,et(e,t,3)):a?e._fn(i,[r,n,a]):n?e._fn(i,[r,n]):e._fn(i,[r])}var fp={True:{wikidata:"Q16751793",domain:"Booleans",constant:!0},False:{wikidata:"Q5432619",domain:"Booleans",constant:!0},And:{wikidata:"Q191081",threadable:!0,associative:!0,commutative:!0,idempotent:!0,complexity:1e4,signature:{domain:"LogicOperators",simplify:so,evaluate:so}},Or:{wikidata:"Q1651704",threadable:!0,associative:!0,commutative:!0,idempotent:!0,complexity:1e4,signature:{domain:"LogicOperators",simplify:oo,evaluate:oo}},Not:{wikidata:"Q190558",threadable:!0,involution:!0,complexity:10100,signature:{domain:"LogicOperators",simplify:lo,evaluate:lo}},Equivalent:{wikidata:"Q220433",threadable:!0,complexity:10200,signature:{domain:"LogicOperators",canonical:(e,t)=>{let i=t[0].symbol,r=t[1].symbol;return i==="True"&&r==="True"||i==="False"&&r==="False"?e.True:i==="True"&&r==="False"||i==="False"&&r==="True"?e.False:e._fn("Equivalent",t)},simplify:uo,evaluate:uo}},Implies:{wikidata:"Q7881229",threadable:!0,complexity:10200,signature:{domain:"LogicOperators",simplify:co,evaluate:co}},Exists:{signature:{domain:"Functions"},hold:"all"},ExistsUnique:{signature:{domain:"Functions"},hold:"all"},ForAll:{signature:{domain:"Functions"},hold:"all"},ForAllUnique:{signature:{domain:"Functions"},hold:"all"}};function so(e,t){if(t.length===0)return e.True;let i=[];for(let r of t){if(r.symbol==="False")return e.False;if(r.symbol!=="True"){let n=!1;for(let a of i)if(a.isSame(r))n=!0;else if(r.head==="Not"&&r.op1.isSame(a)||a.head==="Not"&&a.op1.isSame(r))return e.False;n||i.push(r)}}return i.length===0?e.True:i.length===1?i[0]:e._fn("And",i)}function oo(e,t){if(t.length===0)return e.True;let i=[];for(let r of t){if(r.symbol==="True")return e.True;if(r.symbol!=="False"){let n=!1;for(let a of i)if(a.isSame(r))n=!0;else if(r.head==="Not"&&r.op1.isSame(a)||a.head==="Not"&&a.op1.isSame(r))return e.True;n||i.push(r)}}return i.length===0?e.True:i.length===1?i[0]:e._fn("Or",i)}function lo(e,t){var r;let i=(r=t[0])==null?void 0:r.symbol;if(i==="True")return e.False;if(i==="False")return e.True}function uo(e,t){let i=t[0].symbol,r=t[1].symbol;if(i==="True"&&r==="True"||i==="False"&&r==="False")return e.True;if(i==="True"&&r==="False"||i==="False"&&r==="True")return e.False}function co(e,t){let i=t[0].symbol,r=t[1].symbol;if(i==="True"&&r==="True"||i==="False"&&r==="False"||i==="False"&&r==="True")return e.True;if(i==="True"&&r==="False")return e.False}var hp=[{Expand:{description:"Expand out products and positive integer powers",signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>ei(t[0])??t[0]}},ExpandAll:{description:"Recursively expand out products and positive integer powers",signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>Nl(t[0])??t[0]}},Factor:{description:"Factors an algebraic expression into a product of irreducible factors",signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>fh(t[0])}},Together:{description:"Combine rational expressions into a single fraction",signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>Fi(t[0])}},Distribute:{description:"Distribute multiplication over addition",signature:{domain:["FunctionOf","Values","Values"],evaluate:(e,t)=>{let i=t[0].head;if(i==="Multiply")return ar(t[0].ops)??t[0];if(i==="Negate")return ar([e.NegativeOne,...t[0].ops])??t[0];if(i==="Divide"&&t[0].ops[0].head==="Multiply"){let r=ar(t[0].ops),n=t[0].ops[1];if(r)return r.head==="Add"?e.add(...r.ops.map(a=>e.div(a,n))).evaluate():e.div(r,n).evaluate()}return t[0]}}}}],pp={EmptySet:{domain:"Sets",constant:!0,wikidata:"Q226183"},Element:{complexity:11200,hold:"all",signature:{domain:"Predicates",canonical:(e,t)=>(t=et(e,t,2),t.length===2&&t[0].isValid&&Vi(t[1])?e._fn("Element",[t[0],e.domain(t[1])]):e._fn("Element",t)),evaluate:(e,t)=>bp(e,t)}},NotElement:{complexity:11200,hold:"all",signature:{domain:"Predicates",canonical:(e,t)=>e.box(["Not",["Element",...t]])}},Subset:{complexity:11200,signature:{domain:"Predicates"}},NotSubset:{complexity:11200,signature:{domain:"Predicates",canonical:(e,t)=>e.box(["Not",["Subset",...t]])}},Superset:{complexity:11200,signature:{domain:"Predicates"}},SupersetEqual:{complexity:11200,signature:{domain:"Predicates"}},NotSuperset:{complexity:11200,signature:{domain:"Predicates",canonical:(e,t)=>e.box(["Not",["Superset",...t]])}},NotSupersetEqual:{complexity:11200,signature:{domain:"Predicates",canonical:(e,t)=>e.box(["Not",["SupersetEqual",...t]])}},SubsetEqual:{complexity:11200,signature:{domain:"Predicates"}},NotSubsetNotEqual:{complexity:11200,signature:{domain:"Predicates",canonical:(e,t)=>e.box(["Not",["SubsetEqual",...t]])}},CartesianProduct:{wikidata:"Q173740",signature:{domain:["FunctionOf","Sets",["VarArg","Sets"],"Sets"]}},Complement:{wikidata:"Q242767",signature:{domain:["FunctionOf","Sets","Sets"]}},Intersection:{wikidata:"Q185837",associative:!0,commutative:!0,involution:!0,signature:{domain:["FunctionOf","Collections",["VarArg","Collections"],"Sets"],canonical:(e,t)=>t.length===0||t.length===1?e.symbol("EmptySet"):e._fn("Intersection",t),evaluate:dp}},Union:{wikidata:"Q185359",associative:!0,commutative:!0,involution:!0,signature:{domain:["FunctionOf","Collections",["VarArg","Collections"],"Sets"],canonical:(e,t)=>t.length===0?e.symbol("EmptySet"):e._fn("Union",t),evaluate:mp}},SetMinus:{wikidata:"Q18192442",signature:{domain:["FunctionOf","Sets","Values","Sets"],evaluate:gp}},SymmetricDifference:{wikidata:"Q1147242",signature:{domain:["FunctionOf","Sets",["VarArg","Sets"],"Sets"]}}};function mp(e,t){let i=[];for(let r of t)if(Ee(r))for(let n of ce(r))i.every(a=>!a.isEqual(n))&&i.push(n);else i.every(n=>!n.isEqual(r))&&i.push(r);return i.length===0?e.symbol("EmptySet"):e._fn("Set",i)}function dp(e,t){let i=t[0].ops??[];for(let r of t.slice(1))Ee(r)?i=i.filter(n=>[...ce(r)].some(a=>n.isEqual(a))):i=i.filter(n=>n.isEqual(r));return i.length===0?e.symbol("EmptySet"):e._fn("Set",i)}function gp(e,t){return e.symbol("EmptySet")}function bp(e,t){t.length;let[i,r]=t;if(r.string)return i.string&&r.string.includes(i.string)?e.True:e.False;if(r.keys){if(i.string){for(let n of r.keys)if(n===i.string)return e.True}return e.False}if(r.head==="List"){if(i.head==="List"){let a=!1;for(let s=0;s<1+(r.nops-i.nops);++s){a=!0;for(let o=0;o<i.nops;++o)if(!r.ops[s+o].isEqual(i.ops[o])){a=!1;break}if(a)return e.True}return e.False}let n=i.head==="Hold"?i.op1:i;for(let a of r.ops)if(n.isEqual(a))return e.True;return e.False}return Vi(r)&&i.domain?i.domain.isCompatible(e.domain(r))?e.True:e.False:e._fn("Element",[i,r])}var vp=[{Mean:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(e,t)=>{let i=0,r=0;for(let n of ce(t[0])){let a=N(n);if(a===null)return;i+=a,r++}return r===0?e.NaN:e.number(i/r)}}},Median:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(e,t)=>{let i=[];for(let n of ce(t[0])){let a=N(n);if(a===null)return;i.push(a)}if(i.length===0)return e.NaN;i.sort((n,a)=>n-a);let r=Math.floor(i.length/2);return i.length%2===0?e.number((i[r-1]+i[r])/2):e.number(i[r])}}},Variance:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(e,t)=>{let i=0,r=0,n=0;for(let a of ce(t[0])){let s=N(a);if(s===null)return;i+=s,r+=s*s,n++}return n===0?e.NaN:e.number((r-i*i/n)/(n-1))}}},StandardDeviation:{complexity:1200,threadable:!1,description:"Sample Standard Deviation of a collection of numbers.",signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(e,t)=>{let i=0,r=0,n=0;for(let a of ce(t[0])){let s=N(a);if(s===null)return;i+=s,r+=s*s,n++}return n===0?e.NaN:e.number(Math.sqrt((r-i*i/n)/(n-1)))}}},Kurtosis:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(e,t)=>{let i=0,r=0,n=0,a=0;for(let l of ce(t[0])){let u=N(l);if(u===null)return;i+=u,r+=u*u,n+=u*u*u*u,a++}if(a===0)return e.NaN;let s=(r-i*i/a)/(a-1),o=(n-r*r/a)/(a-1);return e.number((o/(s*s)-3)*(a*(a+1))/6)}}},Skewness:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(e,t)=>{let i=0,r=0,n=0,a=0;for(let l of ce(t[0])){let u=N(l);if(u===null)return;i+=u,r+=u*u,n+=u*u*u,a++}if(a===0)return e.NaN;let s=(r-i*i/a)/(a-1),o=(n-r*i/a)/(a-1);return e.number(o/Math.pow(s,3/2)*Math.sqrt(a*1))}}},Mode:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(e,t)=>{let i=[];for(let s of ce(t[0])){let o=N(s);if(o===null)return;i.push(o)}if(i.length===0)return e.NaN;i.sort((s,o)=>s-o);let r={};for(let s of i)r[s]=(r[s]??0)+1;let n=0,a=i[0];for(let s of i){let o=r[s];o>n&&(n=o,a=s)}return e.number(a)}}},Quartiles:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Lists"],evaluate:(e,t)=>{let i=[];for(let s of ce(t[0])){let o=N(s);if(o===null)return;i.push(o)}if(i.length===0)return e.NaN;i.sort((s,o)=>s-o);let r=Math.floor(i.length/2),n=i.slice(0,r),a=i.slice(r+1);return e.box(["List",e.number(i[r]),e.number(n[Math.floor(n.length/2)]),e.number(a[Math.floor(a.length/2)])])}}},InterquartileRange:{complexity:1200,threadable:!1,signature:{domain:["FunctionOf","Collections","Numbers"],evaluate:(e,t)=>{let i=[];for(let s of ce(t[0])){let o=N(s);if(o===null)return;i.push(o)}if(i.length===0)return e.NaN;i.sort((s,o)=>s-o);let r=Math.floor(i.length/2),n=i.slice(0,r),a=i.slice(r+1);return e.number(a[Math.floor(a.length/2)]-n[Math.floor(n.length/2)])}}},Erf:{complexity:7500,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>{let i=N(t[0]);if(i!==null)return e.number($s(i))}}},Erfc:{complexity:7500,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>{let i=N(t[0]);if(i!==null)return e.number(1-$s(i))}}},ErfInv:{complexity:7500,signature:{domain:["FunctionOf","Numbers","Numbers"],evaluate:(e,t)=>{let i=N(t[0]);if(i!==null)return e.number(Af(i))}}}}],Nt=e=>["FunctionOf","Numbers","ExtendedRealNumbers"],Ir=e=>["FunctionOf","Numbers","Numbers"],$t=e=>["FunctionOf","Numbers","Numbers"],xp=[{Pi:{domain:"TranscendentalNumbers",flags:{algebraic:!1},constant:!0,holdUntil:"N",wikidata:"Q167",value:e=>K(e)?e._BIGNUM_PI:Math.PI}},{Degrees:{signature:{domain:["FunctionOf","Numbers","Numbers"],canonical:(e,t)=>{if(t=rt(e,t,1),t.length!==1)return e._fn("Degrees",t);let i=t[0];if(i.numericValue===null||!i.isValid)return e._fn("Degrees",t);let r=N(i);if(r!==null){if(r=r%360,r<0&&(r+=360),Number.isInteger(r)){let n=It([r,180]);return n[0]===0?e.Zero:n[0]===1&&n[1]===1?e.Pi:n[0]===1?e.div(e.Pi,e.number(n[1])):e.mul(e.number(n),e.Pi)}return e.mul(e.div(e.number(r),e.number(180)),e.Pi)}return e.div(e.mul(i,e.Pi),e.number(180))},evaluate:(e,t)=>e.mul(t[0],e.div(e.Pi,e.number(180))).evaluate()}},Hypot:{threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","NonNegativeNumbers"],simplify:(e,t)=>e.box(["Sqrt",["Add",["Square",t[0]],["Square",t[1]]]]).simplify(),evaluate:["Function",["Sqrt",["Add",["Square","_1"],["Square","_2"]]]]}},Sin:{complexity:5e3,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],simplify:(e,t)=>{var i;return((i=ge(e,"Sin",t[0]))==null?void 0:i.simplify())??(Fe(e)?e.box(["Divide",["Subtract",["Exp",["Multiply","ImaginaryUnit",t[0]]],["Exp",["Multiply","ImaginaryUnit",["Negate",t[0]]]]],["Complex",0,2]]).simplify():void 0)},evaluate:(e,t)=>M(e,"evaluate","Sin",t[0]),N:(e,t)=>M(e,"N","Sin",t[0])}}},{Arctan:{wikidata:"Q2257242",complexity:5200,threadable:!0,signature:{domain:Nt(),simplify:(e,t)=>{var i;return(i=ge(e,"Arctan",t[0]))==null?void 0:i.simplify()},evaluate:(e,t)=>M(e,"evaluate","Arctan",t[0]),N:(e,t)=>M(e,"N","Arctan",t[0])}},Arctan2:{wikidata:"Q776598",complexity:5200,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers","Numbers"],N:(e,t)=>hn(t[0],t[1],Math.atan2,(i,r)=>T.atan2(i,r))}},Cos:{complexity:5050,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],simplify:(e,t)=>{var i;return((i=ge(e,"Cos",t[0]))==null?void 0:i.simplify())??e.box(["Sin",["Add",t[0],["Multiply","Half","Pi"]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Cos",t[0]),N:(e,t)=>M(e,"N","Cos",t[0])}},Tan:{complexity:5100,threadable:!0,signature:{domain:Ir(),simplify:(e,t)=>{var i;return((i=ge(e,"Tan",t[0]))==null?void 0:i.simplify())??e.box(["Divide",["Sin",t[0]],["Cos",t[0]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Tan",t[0]),N:(e,t)=>M(e,"N","Tan",t[0])}}},{Arcosh:{complexity:6200,threadable:!0,signature:{domain:$t(),simplify:(e,t)=>{var i;return((i=ge(e,"Arcosh",t[0]))==null?void 0:i.simplify())??e.box(["Ln",["Add",t[0],["Sqrt",["Subtract",["Square",t[0]],1]]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Arcosh",t[0]),N:(e,t)=>M(e,"N","Arcosh",t[0])}},Arcsin:{complexity:5500,threadable:!0,signature:{domain:$t(),simplify:(e,t)=>{var i;return((i=ge(e,"Arcsin",t[0]))==null?void 0:i.simplify())??e.box(["Multiply",2,["Arctan2",t[0],["Add",1,["Sqrt",["Subtract",1,["Square",t[0]]]]]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Arcsin",t[0]),N:(e,t)=>M(e,"N","Arcsin",t[0])}},Arsinh:{complexity:6100,threadable:!0,signature:{domain:$t(),simplify:(e,t)=>{var i;return((i=ge(e,"Arsinh",t[0]))==null?void 0:i.simplify())??e.box(["Ln",["Add",t[0],["Sqrt",["Add",["Square",t[0]],1]]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Arsinh",t[0]),N:(e,t)=>M(e,"N","Arsinh",t[0])}},Artanh:{complexity:6300,threadable:!0,signature:{domain:$t(),simplify:(e,t)=>{var i;return((i=ge(e,"Artanh",t[0]))==null?void 0:i.simplify())??e.box(["Multiply","Half",["Ln",["Divide",["Add",1,t[0]],["Subtract",1,t[0]]]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Artanh",t[0]),N:(e,t)=>M(e,"N","Artanh",t[0])}},Cosh:{complexity:6050,threadable:!0,signature:{domain:$t(),simplify:(e,t)=>{var i;return((i=ge(e,"Cosh",t[0]))==null?void 0:i.simplify())??e.box(["Multiply","Half",["Add",["Exp",t[0]],["Exp",["Negate",t[0]]]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Cosh",t[0]),N:(e,t)=>M(e,"N","Cosh",t[0])}},Cot:{complexity:5600,threadable:!0,signature:{domain:Ir(),simplify:(e,t)=>{var i;return((i=ge(e,"Cot",t[0]))==null?void 0:i.simplify())??e.box(["Divide",["Cos",t[0]],["Sin",t[0]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Cot",t[0]),N:(e,t)=>M(e,"N","Cot",t[0])}},Csc:{description:"Cosecant",complexity:5600,threadable:!0,signature:{domain:Ir(),simplify:(e,t)=>{var i;return((i=ge(e,"Csc",t[0]))==null?void 0:i.simplify())??e.box(["Divide",1,["Sin",t[0]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Csc",t[0]),N:(e,t)=>M(e,"N","Csc",t[0])}},Haversine:{wikidata:"Q2528380",threadable:!0,signature:{domain:["FunctionOf","ExtendedRealNumbers","Numbers"],evaluate:["Divide",["Subtract",1,["Cos","_1"]],2]}},InverseHaversine:{threadable:!0,signature:{domain:["FunctionOf","ExtendedRealNumbers","RealNumbers"],evaluate:["Multiply",2,["Arcsin",["Sqrt","_1"]]]}},Sec:{description:"Secant, inverse of cosine",complexity:5500,threadable:!0,signature:{domain:Ir(),simplify:(e,t)=>{var i;return((i=ge(e,"Sec",t[0]))==null?void 0:i.simplify())??e.box(["Divide",1,["Cos",t[0]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Sec",t[0]),N:(e,t)=>M(e,"N","Sec",t[0])}},Sinh:{complexity:6e3,threadable:!0,signature:{domain:$t(),simplify:(e,t)=>{var i;return((i=ge(e,"Sinh",t[0]))==null?void 0:i.simplify())??e.box(["Multiply","Half",["Subtract",["Exp",t[0]],["Exp",["Negate",t[0]]]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Sinh",t[0]),N:(e,t)=>M(e,"N","Sinh",t[0])}}},{Csch:{complexity:6200,threadable:!0,signature:{domain:Nt(),simplify:(e,t)=>{var i;return((i=ge(e,"Csch",t[0]))==null?void 0:i.simplify())??e.box(["Divide",1,["Sinh",t[0]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Csch",t[0]),N:(e,t)=>M(e,"N","Csch",t[0])}},Sech:{complexity:6200,threadable:!0,signature:{domain:["FunctionOf","Numbers","Numbers"],simplify:(e,t)=>{var i;return((i=ge(e,"Sech",t[0]))==null?void 0:i.simplify())??e.box(["Divide",1,["Cosh",t[0]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Sech",t[0]),N:(e,t)=>M(e,"N","Sech",t[0])}},Tanh:{complexity:6200,threadable:!0,signature:{domain:$t(),simplify:(e,t)=>{var i;return((i=ge(e,"Tanh",t[0]))==null?void 0:i.simplify())??e.box(["Divide",["Sinh",t[0]],["Cosh",t[0]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Tanh",t[0]),N:(e,t)=>M(e,"N","Tanh",t[0])}}},{Arccos:{complexity:5550,threadable:!0,signature:{domain:Nt(),simplify:(e,t)=>{var i;return((i=ge(e,"Arccos",t[0]))==null?void 0:i.simplify())??e.box(["Subtract",["Divide","Pi",2],["Arcsin",t[0]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Arccos",t[0]),N:(e,t)=>M(e,"N","Arccos",t[0])}},Arccot:{numeric:!0,threadable:!0,signature:{domain:Nt(),evaluate:(e,t)=>M(e,"evaluate","Arccot",t[0]),N:(e,t)=>M(e,"N","Arccot",t[0])}},Arcoth:{numeric:!0,threadable:!0,signature:{domain:Nt(),evaluate:(e,t)=>M(e,"evaluate","Arcoth",t[0]),N:(e,t)=>M(e,"N","Arcoth",t[0])}},Arcsch:{numeric:!0,threadable:!0,signature:{domain:Nt(),evaluate:(e,t)=>M(e,"evaluate","Arcsch",t[0]),N:(e,t)=>M(e,"N","Arcsch",t[0])}},Arcsec:{numeric:!0,threadable:!0,signature:{domain:Nt(),evaluate:(e,t)=>M(e,"evaluate","Arcsec",t[0]),N:(e,t)=>M(e,"N","Arcsec",t[0])}},Arsech:{numeric:!0,threadable:!0,signature:{domain:Nt(),evaluate:(e,t)=>M(e,"evaluate","Arsech",t[0]),N:(e,t)=>M(e,"N","Arsech",t[0])}},Arccsc:{numeric:!0,threadable:!0,signature:{domain:Nt(),evaluate:(e,t)=>M(e,"evaluate","Arccsc",t[0]),N:(e,t)=>M(e,"N","Arccsc",t[0])}},Coth:{complexity:6300,threadable:!0,signature:{domain:$t(),simplify:(e,t)=>{var i;return((i=ge(e,"Coth",t[0]))==null?void 0:i.simplify())??e.box(["Divide",1,["Tanh",t[0]]]).simplify()},evaluate:(e,t)=>M(e,"evaluate","Coth",t[0]),N:(e,t)=>M(e,"N","Coth",t[0])}},InverseFunction:{signature:{domain:["FunctionOf","Functions","Functions"],canonical:(e,t)=>(t=et(e,t,1),aa(e,t)??e._fn("InverseFunction",t)),simplify:(e,t)=>aa(e,t),evaluate:(e,t)=>aa(e,t)}}}],Vt=["Sqrt",2],Si=["Sqrt",3],wi=["Sqrt",5],Or=["Sqrt",6],yp=[[[0,1],{Sin:0,Cos:1,Tan:0,Cot:"ComplexInfinity",Sec:1,Csc:"ComplexInfinity"}],[[1,12],{Sin:["Divide",["Subtract",Or,Vt],4],Cos:["Divide",["Add",Or,Vt],4],Tan:["Subtract",2,Si],Cot:["Add",2,Si],Sec:["Subtract",Or,Vt],Csc:["Add",Or,Vt]}],[[1,10],{Sin:["Divide",["Subtract",wi,1],4],Cos:["Divide",["Sqrt",["Add",10,["Multiply",2,wi]]],4],Tan:["Divide",["Sqrt",["Subtract",25,["Multiply",10,wi]]],5],Cot:["Sqrt",["Add",5,["Multiply",2,wi]]],Sec:["Divide",["Sqrt",["Subtract",50,["Multiply",10,wi]]],5],Csc:["Add",1,wi]}],[[1,8],{Sin:"$\\frac{\\sqrt{2-\\sqrt2}}{2}$",Cos:"$\\frac{\\sqrt {2+{\\sqrt {2}}}}{2}$",Tan:"$\\sqrt{2} - 1$",Cot:"$\\sqrt{2} + 1$",Sec:"$\\sqrt{ 4 - 2\\sqrt{2}}$",Csc:"$\\sqrt{ 4 + 2\\sqrt{2}}$"}],[[1,6],{Sin:"$\\frac{1}{2}$",Cos:"$\\frac{\\sqrt{3}}{2}$",Tan:"$\\frac{\\sqrt{3}}{3}$",Cot:"$\\sqrt{3}$",Sec:"$\\frac{2\\sqrt{3}}{3}$",Csc:2}],[[1,5],{Sin:"$\\frac{\\sqrt{10- 2\\sqrt{5}}} {4}$",Cos:"$\\frac{1+ \\sqrt{5}} {4}$",Tan:"$\\sqrt{5-2\\sqrt5}$",Cot:"$\\frac{\\sqrt{25+10\\sqrt5}} {5}$",Sec:"$\\sqrt{5} - 1$",Csc:"$\\frac{\\sqrt{50+10\\sqrt{5}}} {5}$"}],[[1,4],{Sin:["Divide",Vt,2],Cos:["Divide",Vt,2],Tan:1,Cot:1,Sec:Vt,Csc:Vt}],[[3,10],{Sin:"$\\frac{1+ \\sqrt5} {4}$",Cos:"$\\frac{\\sqrt{10- 2\\sqrt5}} {4}$",Tan:"$\\frac{\\sqrt{25+10\\sqrt5}} {5}$",Cot:"$\\sqrt{5-2\\sqrt5}$",Sec:"$\\frac{\\sqrt{50+10\\sqrt5}} {5}$",Csc:"$\\sqrt5-1$"}],[[1,3],{Sin:["Divide",Si,2],Cos:"Half",Tan:Si,Cot:["Divide",Si,3],Sec:2,Csc:["Divide",["Multiply",2,Si],3]}],[[3,8],{Sin:"$\\frac{ \\sqrt{2 + \\sqrt{2}} } {2}$",Cos:"$\\frac{ \\sqrt{2 - \\sqrt{2}} } {2}$",Tan:"$\\sqrt{2} + 1$",Cot:"$\\sqrt{2} - 1$",Sec:"$\\sqrt{ 4 + 2 \\sqrt{2} }$",Csc:"$\\sqrt{ 4 - 2 \\sqrt{2} }$"}],[[2,5],{Sin:"$\\frac{\\sqrt{10+ 2\\sqrt{5}}} {4}$",Cos:"$\\frac{\\sqrt{5}-1} {4}$",Tan:"$\\sqrt{5+2\\sqrt{5}}$",Cot:"$\\frac{\\sqrt{25-10\\sqrt{5}}} {5}$",Sec:"$1 + \\sqrt{5}$",Csc:"$\\frac{\\sqrt{50-10\\sqrt{5}}} {5}$"}],[[5,12],{Sin:"$\\frac{\\sqrt{6} + \\sqrt{2}} {4}$",Cos:"$\\frac{ \\sqrt{6} - \\sqrt{2}} {4}$",Tan:"$2+\\sqrt{3}$",Cot:"$2-\\sqrt{3}$",Sec:"$\\sqrt{6}+\\sqrt{2}$",Csc:"$\\sqrt{6} - \\sqrt{2}$"}],[[1,2],{Sin:1,Cos:0,Tan:"ComplexInfinity",Cot:0,Sec:"ComplexInfinity",Csc:1}]],Np={Sin:[[1,"Sin"],[1,"Cos"],[-1,"Sin"],[-1,"Cos"]],Cos:[[1,"Cos"],[-1,"Sin"],[-1,"Cos"],[1,"Sin"]],Sec:[[1,"Sec"],[-1,"Csc"],[-1,"Sec"],[1,"Csc"]],Csc:[[1,"Csc"],[1,"Sec"],[-1,"Csc"],[-1,"Sec"]],Tan:[[1,"Tan"],[-1,"Cot"],[1,"Tan"],[-1,"Cot"]],Cot:[[1,"Cot"],[-1,"Tan"],[1,"Cot"],[-1,"Tan"]]};function ge(e,t,i){var l;if(!i)return;let r=N(i.N());if(r===null)return;let n=e.cache("constructible-trigonometric-values",()=>yp.map(([u,f])=>[u,Object.fromEntries(Object.entries(f).map(([c,h])=>[c,e.parse(Ja(h))??e.box(h)]))]),u=>{for(let[f,c]of u)for(let h of Object.values(c))h.reset();return u}),a=t!=="Cos"&&t!=="Sec"?Math.sign(r):1;r=Math.abs(r%(2*Math.PI));let s=Math.floor(r*2/Math.PI);r=r%(Math.PI/2);let o;[o,t]=((l=Np[t])==null?void 0:l[s])??[1,t];for(let[[u,f],c]of n){let h=c[t];if(h&&e.chop(r-Math.PI*u/f)===0)return h.symbol==="ComplexInfinity"?h:a*o<0?Ze(h):h}}function aa(e,t){if(t.length!==1||!t[0].isValid)return;let i=t[0],r=i.symbol;if(typeof r!="string")return;if(r==="InverseFunction")return i.op1;let n={Sin:"Arcsin",Cos:"Arccos",Tan:"Arctan",Sec:"Arcsec",Csc:" Arccsc",Sinh:"Arsinh",Cosh:"Arcosh",Tanh:"Artanh",Sech:"Arcsech",Csch:"Arcsch",Arcosh:"Cosh",Arccos:"Cos",Arccsc:"Csc",Arcsch:"Csch",Arcsec:"Sec",Arcsin:"Sin",Arsinh:"Sinh",Arctan:"Tan",Artanh:"Tanh"}[r];return n?e.symbol(n):void 0}function M(e,t,i,r){var a;if(!r)return;let n=(a=ge(e,i,r))==null?void 0:a.evaluate({numericMode:t==="N"});if(n)return n;if(!(t==="evaluate"&&r.isExact))switch(i){case"Arccos":return L(r,Math.acos,s=>s.acos(),s=>s.acos());case"Arccot":return L(r,s=>Math.atan2(1,s),s=>T.atan2(e._BIGNUM_ONE,s),s=>s.inverse().atan());case"Arccsc":return L(r,s=>Math.asin(1/s),s=>e._BIGNUM_ONE.div(s).asin(),s=>s.inverse().asin());case"Arcosh":return L(r,Math.acosh,s=>s.acosh(),s=>s.acosh());case"Arcoth":return L(r,s=>s,s=>s.acosh(),s=>s.acosh());case"Arcsch":return L(r,s=>Math.log(1/s+Math.sqrt(1/(s*s)+1)),s=>e._BIGNUM_ONE.div(s.mul(s)).add(e._BIGNUM_ONE).sqrt().add(e._BIGNUM_ONE.div(s)).log(),s=>s.mul(s).inverse().add(1).sqrt().add(s.inverse()).log());case"Arcsec":return L(r,s=>Math.acos(1/s),s=>e._BIGNUM_ONE.div(s).acos(),s=>s.inverse().acos());case"Arcsin":return L(r,Math.asin,s=>s.asin(),s=>s.asin());case"Arsech":return L(r,s=>Math.log((1+Math.sqrt(1-s*s))/s),s=>e._BIGNUM_ONE.sub(s.mul(s).add(e._BIGNUM_ONE).div(s)).log(),s=>e.complex(1).sub(s.mul(s)).add(1).div(s).log());case"Arsinh":return L(r,Math.asinh,s=>s.asinh(),s=>s.asinh());case"Arctan":return L(r,Math.atan,s=>s.atan(),s=>s.atan());case"Artanh":return L(r,Math.atanh,s=>s.atanh(),s=>s.atanh());case"Cos":return L(r,Math.cos,s=>s.toSignificantDigits(e.precision+4).cos().toSignificantDigits(e.precision),s=>s.cos());case"Cosh":return L(r,Math.cosh,s=>s.cosh(),s=>s.cosh());case"Cot":return L(r,s=>1/Math.tan(s),s=>e._BIGNUM_ONE.div(s.tan()),s=>s.tan().inverse());case"Coth":return L(r,s=>1/Math.tanh(s),s=>e._BIGNUM_ONE.div(s.tanh()),s=>s.tanh().inverse());case"Csc":return L(r,s=>1/Math.sin(s),s=>e._BIGNUM_ONE.div(s.sin()),s=>s.sin().inverse());case"Csch":return L(r,s=>1/Math.sinh(s),s=>e._BIGNUM_ONE.div(s.sinh()),s=>s.sinh().inverse());case"Sec":return L(r,s=>1/Math.cos(s),s=>e._BIGNUM_ONE.div(s.cos()),s=>s.cos().inverse());case"Sech":return L(r,s=>1/Math.cosh(s),s=>e._BIGNUM_ONE.div(s.cosh()),s=>s.cosh().inverse());case"Sin":return L(r,Math.sin,s=>s.toSignificantDigits(e.precision+4).sin().toSignificantDigits(e.precision),s=>s.sin());case"Sinh":return L(r,Math.sinh,s=>s.sinh(),s=>s.sinh());case"Tan":return L(r,Math.tan,s=>s.toSignificantDigits(e.precision+4).tan().toSignificantDigits(e.precision),s=>s.tan());case"Tanh":return L(r,Math.tanh,s=>s.tanh(),s=>s.tanh())}}var _p=me(de(),1),Te=class{constructor(e,t,i){if(!e.context)throw Error("No context available");this.name=t,this.wikidata=i.wikidata,this.description=i.description,this.url=i.url,this._engine=e,this.scope=e.context,this.name=t,this._flags=i.flags?Xi(i.flags):void 0,this._domain=i.domain?e.domain(i.domain):void 0,this.inferredDomain=i.inferred??!1,this.constant=i.constant??!1,this.holdUntil=i.holdUntil??"evaluate",this.constant?(this._defValue=i.value,this._value=null):(i.value!==void 0?Jn(i.value)?this._value=e.parse(i.value)??e.symbol("Undefined"):typeof i.value=="function"?this._value=e.box(i.value(e)??"Undefined"):i.value instanceof ne?this._value=i.value:this._value=e.box(i.value):this._value=void 0,!this._value&&this._domain&&!i.flags&&(this._flags=qr(this._domain))),this._value&&!this._domain&&(this._domain=this._value.domain,this.inferredDomain=!0)}update(e){e.wikidata&&(this.wikidata=e.wikidata),e.description&&(this.description=e.description),e.url&&(this.url=e.url);let t=e==null?void 0:e.flags,i=e!=null&&e.domain?this._engine.domain(e.domain):void 0;i&&(t={...qr(i),...t??{}}),t&&(this._flags=Xi(t)),i&&(this._domain=i,this.inferredDomain=!1),e.holdUntil&&(this.holdUntil=e.holdUntil),e.constant?(this.constant=e.constant,this._defValue=e.value,this._value=null):e.value&&(Jn(e.value)?this._value=this._engine.parse(e.value)??this._engine.symbol("Undefined"):typeof e.value=="function"?this._value=this._engine.box(e.value(this._engine)??"Undefined"):e.value instanceof ne?this._value=e.value:this._value=this._engine.box(e.value)),this._value&&!this._domain&&(this._domain=this._value.domain,this.inferredDomain=!0)}reset(){this.constant&&(this._value=null)}get value(){var e;if(this._value===null){let t=this._engine;if(Jn(this._defValue)?this._value=t.parse(this._defValue)??t.symbol("Undefined"):typeof this._defValue=="function"?this._value=t.box(this._defValue(t)??"Undefined"):this._defValue?this._value=t.box(this._defValue):this._value=void 0,(e=this._value)==null?void 0:e.numericValue){let i=this._value.numericValue;!K(t)&&i instanceof T?this._value=t.number(i.toNumber()):!Fe(t)&&i instanceof _p.Complex&&(this._value=t.NaN)}}return this._value??void 0}set value(e){var t;if(this.constant)throw new Error(`The value of the constant "${this.name}" cannot be changed`);if(this._defValue,typeof e=="number")this._value=this._engine.number(e);else if(e){let i=this._engine.box(e);this.inferredDomain?(this._value=i,this._domain=vr(this._domain,i.domain)):!this._domain||!i.domain||(t=i.domain)!=null&&t.isCompatible(this._domain)?this._value=i:this._value=void 0}else this._value=void 0;this._value!==void 0?this._flags=void 0:this._flags=qr(this._domain)}get domain(){return this._domain??void 0}set domain(e){var t;if(this.constant)throw new Error(`The domain of the constant "${this.name}" cannot be changed`);if(!this.inferredDomain)throw Error(`The domain of "${this.name}" cannot be changed because it has already been declared`);if(!e){this._defValue=void 0,this._value=void 0,this._flags=void 0,this._domain=void 0;return}if(e=this._engine.domain(e),this._domain&&!e.isCompatible(this._domain))throw Error(`The domain of "${this.name}" cannot be widened from "${this._domain.base}" to "${e.base}"`);if((t=this._value)!=null&&t.domain&&!this._value.domain.isCompatible(e))throw Error(`The domain of "${this.name}" cannot be changed to "${e.base}" because its value has a domain of "${this._value.domain.base}"`);this._domain=e,this._flags=void 0,this._value===void 0&&e.isNumeric&&(this._flags=qr(e))}get number(){var e,t;return((e=this.value)==null?void 0:e.isNumber)??((t=this._flags)==null?void 0:t.number)}set number(e){this.updateFlags({number:e})}get integer(){var e,t;return((e=this.value)==null?void 0:e.isInteger)??((t=this._flags)==null?void 0:t.integer)}set integer(e){this.updateFlags({integer:e})}get rational(){var e,t;return((e=this.value)==null?void 0:e.isRational)??((t=this._flags)==null?void 0:t.rational)}set rational(e){this.updateFlags({rational:e})}get algebraic(){var e,t;return((e=this.value)==null?void 0:e.isAlgebraic)??((t=this._flags)==null?void 0:t.algebraic)}set algebraic(e){this.updateFlags({algebraic:e})}get real(){var e,t;return((e=this.value)==null?void 0:e.isReal)??((t=this._flags)==null?void 0:t.real)}set real(e){this.updateFlags({real:e})}get extendedReal(){var e,t;return((e=this.value)==null?void 0:e.isExtendedReal)??((t=this._flags)==null?void 0:t.extendedReal)}set extendedReal(e){this.updateFlags({extendedReal:e})}get complex(){var e,t;return((e=this.value)==null?void 0:e.isComplex)??((t=this._flags)==null?void 0:t.complex)}set complex(e){this.updateFlags({complex:e})}get extendedComplex(){var e,t;return((e=this.value)==null?void 0:e.isExtendedComplex)??((t=this._flags)==null?void 0:t.extendedComplex)}set extendedComplex(e){this.updateFlags({extendedComplex:e})}get imaginary(){var e,t;return((e=this.value)==null?void 0:e.isImaginary)??((t=this._flags)==null?void 0:t.imaginary)}set imaginary(e){this.updateFlags({imaginary:e})}get positive(){var e,t;return((e=this.value)==null?void 0:e.isPositive)??((t=this._flags)==null?void 0:t.positive)}set positive(e){this.updateFlags({positive:e})}get nonPositive(){var e,t;return((e=this.value)==null?void 0:e.isNonPositive)??((t=this._flags)==null?void 0:t.nonPositive)}set nonPositive(e){this.updateFlags({nonPositive:e})}get negative(){var e,t;return((e=this.value)==null?void 0:e.isNegative)??((t=this._flags)==null?void 0:t.negative)}set negative(e){this.updateFlags({negative:e})}get nonNegative(){var e,t;return((e=this.value)==null?void 0:e.isNonNegative)??((t=this._flags)==null?void 0:t.nonNegative)}set nonNegative(e){this.updateFlags({nonNegative:e})}get zero(){var e,t;return((e=this.value)==null?void 0:e.isZero)??((t=this._flags)==null?void 0:t.zero)}set zero(e){this.updateFlags({zero:e})}get notZero(){var e,t;return((e=this.value)==null?void 0:e.isNotZero)??((t=this._flags)==null?void 0:t.notZero)}set notZero(e){this.updateFlags({notZero:e})}get one(){var e,t;return((e=this.value)==null?void 0:e.isOne)??((t=this._flags)==null?void 0:t.one)}set one(e){this.updateFlags({one:e})}get negativeOne(){var e,t;return((e=this.value)==null?void 0:e.isNegativeOne)??((t=this._flags)==null?void 0:t.negativeOne)}set negativeOne(e){this.updateFlags({negativeOne:e})}get infinity(){var e,t;return((e=this.value)==null?void 0:e.isInfinity)??((t=this._flags)==null?void 0:t.infinity)}set infinity(e){this.updateFlags({infinity:e})}get finite(){var e,t;return((e=this.value)==null?void 0:e.isFinite)??((t=this._flags)==null?void 0:t.finite)}set finite(e){this.updateFlags({finite:e})}get NaN(){var e,t;return((e=this.value)==null?void 0:e.isNaN)??((t=this._flags)==null?void 0:t.NaN)}set NaN(e){this.updateFlags({NaN:e})}get even(){var e,t;return((e=this.value)==null?void 0:e.isEven)??((t=this._flags)==null?void 0:t.even)}set even(e){this.updateFlags({even:e})}get odd(){var e,t;return((e=this.value)==null?void 0:e.isOdd)??((t=this._flags)==null?void 0:t.odd)}set odd(e){this.updateFlags({odd:e})}get prime(){var t;let e=this._value;return e?!e.isInteger||e.isNonPositive?!1:Mi(N(e)??NaN):(t=this._flags)==null?void 0:t.prime}set prime(e){this.updateFlags({prime:e})}get composite(){var t;let e=this._value;return e?!e.isInteger||e.isNonPositive?!1:!Mi(N(e)??NaN):(t=this._flags)==null?void 0:t.composite}set composite(e){this.updateFlags({composite:e})}updateFlags(e){var r;if(this.constant)throw Error("The flags of constant cannot be changed");if(((r=this.domain)==null?void 0:r.isNumeric)===!1)throw Error("Flags only apply to numeric domains");let t=0,i=!0;for(let n in Object.keys(e))if(t+=1,this._value&&e[n]!==void 0)switch(n){case"number":i=this._value.isNumber===e.number;break;case"integer":i=this._value.isInteger===e.integer;break;case"rational":i=this._value.isRational===e.rational;break;case"algebraic":i=this._value.isAlgebraic===e.algebraic;break;case"real":i=this._value.isReal===e.real;break;case"extendedReal":i=this._value.isExtendedReal===e.extendedReal;break;case"complex":i=this._value.isComplex===e.complex;break;case"extendedComplex":i=this._value.isExtendedComplex===e.extendedComplex;break;case"imaginary":i=this._value.isImaginary===e.imaginary;break;case"positive":i=this._value.isPositive===e.positive;break;case"nonPositive":i=this._value.isNonPositive===e.nonPositive;break;case"negative":i=this._value.isNegative===e.negative;break;case"nonNegative":i=this._value.isNonNegative===e.nonNegative;break;case"zero":i=this._value.isZero===e.zero;break;case"notZero":i=this._value.isNotZero===e.notZero;break;case"one":i=this._value.isOne===e.one;break;case"negativeOne":i=this._value.isNegativeOne===e.negativeOne;break;case"infinity":i=this._value.isInfinity===e.infinity;break;case"NaN":i=this._value.isNaN===e.NaN;break;case"finite":i=this._value.isFinite===e.finite;break;case"even":i=this._value.isEven===e.even;break;case"odd":i=this._value.isOdd===e.odd;break;case"prime":i=this._value.isPrime===e.prime;break;case"composite":i=this._value.isComposite===e.composite;break}t>0&&(i||(this._defValue=void 0,this._value=void 0),this._domain=this._engine.Numbers,this._flags?this._flags={...this._flags,...Xi(e)}:this._flags=Xi(e))}};function Sp(e){return Object.fromEntries(Object.entries(e).filter(([t,i])=>i!==void 0))}function Xi(e){let t={...e};return(e.zero||e.one||e.negativeOne)&&(t.zero=e.zero&&!e.one&&!e.negativeOne,t.notZero=!e.zero||e.one||e.negativeOne,t.one=e.one&&!e.zero&&!e.negativeOne,t.negativeOne=e.negativeOne&&!e.zero&&!e.one,t.infinity=!1,t.NaN=!1,t.finite=!0,t.integer=!0,t.finite=!0,t.infinity=!1,t.NaN=!1,t.even=e.one,t.odd=!e.one,t.prime=!1,t.composite=!1),t.zero&&(t.positive=!1,t.negative=!1,t.nonPositive=!0,t.nonNegative=!0),t.notZero===!0&&(t.imaginary||(t.real=!0),t.zero=!1),t.one&&(t.positive=!0),t.negativeOne&&(t.nonPositive=!0),(t.positive||t.nonNegative)&&(t.negativeOne=!1),t.positive?(t.nonPositive=!1,t.negative=!1,t.nonNegative=!0):t.nonPositive?(t.positive=!1,t.negative=t.notZero,t.nonNegative=!t.zero):t.negative?(t.positive=!1,t.nonPositive=t.notZero,t.nonNegative=!1):t.nonNegative&&(t.positive=t.notZero,t.nonPositive=!t.zero,t.negative=!1),(t.positive||t.negative||t.nonPositive||t.nonNegative)&&(t.number=!0,t.finite?t.real=!0:t.finite||(t.complex=!0),t.imaginary=!1),t.finite&&(t.number=!0,t.complex=!0,t.infinity=!1,t.NaN=!1),t.infinity&&(t.finite=!1,t.NaN=!1),t.infinity===!1&&(t.extendedComplex=!1,t.extendedReal=!1),e.even&&(t.odd=!1),e.odd&&(t.even=!1),t.integer&&(t.rational=!0),t.rational&&(t.algebraic=!0),t.algebraic&&(t.real=!0),t.real&&(t.complex=!0),t.imaginary&&(t.complex=!0),t.complex&&(t.number=!0),t.real&&t.infinity!==!1&&(t.extendedReal=!0),t.complex&&t.infinity!==!1&&(t.extendedComplex=!0),(t.even||t.infinity||t.NaN||t.negative||t.imaginary||t.integer===!1)&&(t.prime=!1),t.number&&t.prime&&(t.composite=!1),t}function qr(e){if(!e)return{};let t={};if(!e.isNumeric)return t.number=!1,t.integer=!1,t.rational=!1,t.algebraic=!1,t.real=!1,t.extendedReal=!1,t.complex=!1,t.extendedComplex=!1,t.imaginary=!1,t.positive=!1,t.nonPositive=!1,t.negative=!1,t.nonNegative=!1,t.zero=!1,t.notZero=!1,t.one=!1,t.negativeOne=!1,t.infinity=!1,t.NaN=!1,t.odd=!1,t.even=!1,t.prime=!1,t.composite=!1,t;let i=e.base;return t.number=!0,i==="Integers"&&(t.integer=!0),i==="RationalNumbers"&&(t.rational=!0),i==="AlgebraicNumbers"&&(t.algebraic=!0),i==="TranscendentalNumbers"&&(t.algebraic=!1,t.real=!0),i==="ExtendedRealNumbers"&&(t.extendedReal=!0),i==="RealNumbers"&&(t.real=!0),i==="ImaginaryNumbers"&&(t.imaginary=!0),i==="ExtendedComplexNumbers"&&(t.extendedComplex=!0),i==="ComplexNumbers"&&(t.complex=!0),i==="PositiveNumbers"&&(t.notZero=!0,t.real=!0,t.positive=!0),i==="NegativeNumbers"&&(t.notZero=!0,t.real=!0,t.negative=!0),i==="NonNegativeNumbers"&&(t.real=!0,t.positive=!0),i==="NonPositiveNumbers"&&(t.real=!0,t.negative=!0),i==="PositiveIntegers"&&(t.notZero=!0,t.integer=!0,t.positive=!0),i==="NegativeNumbers"&&(t.notZero=!0,t.integer=!0,t.negative=!0),i==="NonNegativeNumbers"&&(t.integer=!0,t.positive=!0),i==="NonPositiveNumbers"&&(t.integer=!0,t.negative=!0),Sp(Xi(t))}var Wt=class{constructor(e,t,i){var a,s;if(!e.context)throw Error("No context available");this.engine=e,this.scope=e.context;let r=i.idempotent??!1,n=i.involution??!1;if(r&&n)throw new Error(`Function Definition "${t}": the 'idempotent' and 'involution' flags are mutually exclusive`);if(this.name=t,this.description=i.description,this.wikidata=i.wikidata,this.threadable=i.threadable??!1,this.associative=i.associative??!1,this.commutative=i.commutative??!1,this.idempotent=r,this.involution=n,this.inert=i.inert??!1,this.numeric=i.numeric??!1,this.pure=i.pure??!0,this.complexity=i.complexity??jt,this.hold=i.hold??"none",i.at&&(this.at=i.at),i.iterator&&(this.iterator=i.iterator),i.size&&(this.size=i.size),i.keys&&(this.keys=i.keys),i.indexOf&&(this.indexOf=i.indexOf),i.at&&!i.size&&(this.size=o=>{let l=i.at,u=0;for(;l(o,u)!==void 0;)u++;return u}),i.at&&!i.iterator&&(this.iterator=(o,l=1,u=-1)=>{let f=i.at,c=l;return{next(){if(u>=0&&c>=l+u)return{done:!0,value:void 0};let h=f(o,c);return h===void 0?{done:!0,value:void 0}:(c++,{done:!1,value:h})}}}),this.iterator&&!i.indexOf&&(this.indexOf=(o,l)=>{let u=1,f=this.iterator(o),c=f.next();for(;!c.done;){if(l.isEqual(c.value))return u;u++,c=f.next()}}),this.inert){if(i.hold)throw Error(`Function Definition "${t}": an inert function should not have a hold`);if(this.hold="rest",i.signature){let o=i.signature;if("simplify"in o||"evaluate"in o||"N"in o||"evalDimension"in o||"sgn"in o||"compile"in o)throw Error(`Function Definition "${t}": an inert function should only have 'canonical' or 'codomain' handlers`)}if(this.threadable)throw Error(`Function Definition "${t}": an inert function should not be threadable`);if(this.associative)throw Error(`Function Definition "${t}": an inert function should not be associative`);if(this.commutative)throw Error(`Function Definition "${t}": an inert function should not be commutative`);if(this.idempotent)throw Error(`Function Definition "${t}": an inert function should not be idempotent`);if(this.involution)throw Error(`Function Definition "${t}": an inert function should not be involution`);if(!this.pure)throw Error(`Function Definition "${t}": an inert function should be pure`)}if(i.signature){let o=i.signature,l,u,f,c,h=!1;if(o.domain){let m=e.domain(o.domain);if(!m.isValid)throw Error(`Function Definition "${t}": invalid domain ${JSON.stringify(o.domain)}`);[l,u,f,c]=Wa(e.domain(m))}else o.params||o.result?(l=((a=o.params)==null?void 0:a.map(m=>e.domain(m)))??[],u=((s=o.optParams)==null?void 0:s.map(m=>e.domain(m)))??[],f=o.restParam?e.domain(o.restParam):void 0,typeof o.result=="function"?c=o.result:o.result?c=e.domain(o.result):i.numeric?c=e.Numbers:c=e.Anything):i.numeric?(h=!0,l=[],u=[],f=e.Numbers,c=e.Numbers):(h=!0,l=[],u=[],f=e.Anything,c=e.Anything);let p;if(o.evaluate&&typeof o.evaluate!="function"){let m=e.box(o.evaluate,{canonical:!1});if(!m.isValid)throw Error(`Invalid function ${m.toString()}`);let d=yn(m);p=(b,y)=>d(y),p.toString=()=>m.toString()}else p=o.evaluate;this.signature={inferredSignature:h,params:l,optParams:u,restParam:f||void 0,result:c,canonical:o.canonical,simplify:o.simplify,evaluate:p,N:o.N,evalDimension:o.evalDimension,sgn:o.sgn,compile:o.compile}}else i.numeric?this.signature={inferredSignature:!0,params:[],optParams:[],restParam:e.Numbers,result:e.Numbers}:this.signature={inferredSignature:!0,params:[],optParams:[],restParam:e.Anything,result:e.Anything}}reset(){}};function Ll(e,t,i){return i instanceof Wt?i:new Wt(e,t,i)}function Rl(e){if(e==="all")return Rl(["core","control-structures","logic","collections","relop","numeric","arithmetic","trigonometry","algebra","calculus","polynomials","combinatorics","linear-algebra","statistics","dimensions","units","physics","other"]);typeof e=="string"&&(e=[e]);let t=[];for(let i of e){let r=wp[i];if(!r)throw Error(`Unknown library category ${i}`);Array.isArray(r)?t.push(...r):t.push(r)}return Object.freeze(t)}var wp={algebra:[],arithmetic:[...Kh,...lp],calculus:Xh,collections:[pp,ep,Jf()],combinatorics:[],"control-structures":rp,core:Jh,dimensions:[],domains:[],"linear-algebra":up,logic:fp,numeric:[],other:[],relop:Hf,polynomials:hp,physics:{Mu0:{description:"Vaccum permeability",constant:!0,wikidata:"Q1515261",domain:"RealNumbers",value:125663706212e-17}},statistics:vp,trigonometry:xp,units:[]};function kp(e){if(e=e.normalize(),Ye(e))return e;throw new Error(`Invalid definition name "${e}": ${hi(e)}`)}function fo(e,t){var i;if(!e.context)throw Error("No context available");(i=e.context).ids??(i.ids=new Map);let r=e.context.ids;e.strict;for(let[n,a]of Object.entries(t))if(n=kp(n),Bl(a)){let s=Ll(e,n,a);if(r.has(n))throw new Error(`Duplicate function definition ${n}:
${JSON.stringify(r.get(n))}
${JSON.stringify(a)}`);r.set(n,s)}else if(za(a)){let s=new Te(e,n,a);if(e.strict&&a.wikidata){for(let[o,l]of r)if(l.wikidata===a.wikidata)throw new Error(`Duplicate entries with wikidata "${a.wikidata}": "${n}" and "${l.name}"`)}if(r.has(n))throw new Error(`Duplicate symbol definition "${n}"`);r.set(n,s)}else{let s=new Te(e,n,{value:e.box(a)});r.set(n,s)}}function za(e){return e==null||typeof e!="object"||e instanceof ne?!1:"domain"in e||"value"in e||"constant"in e}function Bl(e){return e==null||typeof e!="object"||e instanceof ne?!1:"signature"in e||"complexity"in e}var Tp=me(de(),1);function si(e){return Number.isInteger(e)&&e!==0?Math.floor(Math.log2(Math.abs(e))/Math.log2(10))+(e>0?1:2):2}function La(e){var n;if(e.symbol)return 1;let t=e.numericValue;if(t!==null){if(e.isZero)return 1;if(e.isInteger)return si(N(e));if(Se(t))return re(t)?si(t[0])+si(t[1])+1:si(Number(t[0]))+si(Number(t[1]))+1;if(t instanceof Tp.Complex)return si(t.re)+si(t.im)+1;if(e.isNumber)return 2}let i=e.head,r=2;return typeof i=="string"?["Add","Divide"].includes(i)?r=3:["Subtract","Negate"].includes(i)?r=4:["Square","Sqrt","Multiply","Root"].includes(i)?r=5:["Power"].includes(i)?r=6:["Ln","Exp","Log"].includes(i)?r=7:["Arcsin","Arccos","Arctan","Arcsec"," Arccsc","Arsinh","Arcosh","Artanh","Arcsech","Arcsch","Cosh","Cos","Csc","Csch","Sec","Sin","Sinh","Tan","Tanh"].includes(i)?r=9:r=10:r=La(i),r+(((n=e.ops)==null?void 0:n.reduce((a,s)=>a+La(s),0))??0)}var ho=La,sa=class Ul{constructor(t){t?t instanceof Ul?this._items=new Map(t._items):this._items=new Map(t):this._items=new Map}has(t){for(let i of this._items.keys())if(i.isSame(t))return!0;return!1}get(t){for(let[i,r]of this._items)if(i.isSame(t))return r}clear(){this._items.clear()}set(t,i){for(let r of this._items.keys())if(r.isSame(t)){this._items.set(r,i);return}this._items.set(t,i)}delete(t){this._items.delete(t)}[Symbol.iterator](){return this._items.entries()}entries(){return this._items.entries()}},er=class jl extends ne{constructor(t,i,r){super(t,r==null?void 0:r.metadata),Ye(i),`${i}${hi(i)}`,this._id=i,this._def=(r==null?void 0:r.def)??void 0,(r==null?void 0:r.canonical)??!0?this._def?this._scope=t.context:this.bind():this._scope=null}get hash(){return this._hash===void 0&&(this._hash=st(this._id)),this._hash}get isPure(){return!0}get json(){let t=this._scope?this.wikidata:void 0;return Aa(this.engine,this._id,{latex:this._latex,wikidata:t})}get scope(){return this._scope}get isConstant(){let t=this._def??this.engine.lookupSymbol(this._id,this.wikidata);return!(t instanceof Te)||t.constant}bind(){this._scope=this.engine.context;let t=this.engine.lookupSymbol(this._id)??this.engine.lookupFunction(this._id);if(t){this._def=t;return}this._def=this.engine.defineSymbol(this._id,{domain:void 0,inferred:!0}),this._id=this._def.name}reset(){var t;(t=this._def)==null||t.reset(),this._def=void 0}get isCanonical(){return this._scope!==null}set isCanonical(t){this._scope=t?this.engine.context:null,this._def=void 0}get canonical(){return this._scope?this:this.engine.box(this._id)}solve(t){return t.length!==1?null:t.includes(this.symbol)?[this.engine.Zero]:null}get complexity(){return 7}get head(){return"Symbol"}get symbol(){return this._id}get isNothing(){return this._id==="Nothing"}get baseDefinition(){return this._def===void 0&&this.bind(),this._def??void 0}get symbolDefinition(){return this._def===void 0&&this.bind(),this._def instanceof Te?this._def:void 0}get functionDefinition(){return this._def===void 0&&this.bind(),this._def instanceof Wt?this._def:void 0}infer(t){let i=this.engine.lookupSymbol(this._id)??this.engine.lookupFunction(this._id);if(!i){let r=this.engine.swapScope(this._scope??this.engine.context);return this._def=this.engine.defineSymbol(this._id,{domain:t,inferred:!0}),this.engine.swapScope(r),!0}return i instanceof Te&&i.inferredDomain?(i.domain=Xa(i.domain,t),!0):!1}get value(){var i;let t=this._def;if(t&&t instanceof Te)return(i=t.value)==null?void 0:i.value}set value(t){var a;let i=this.engine;i.forget(this._id);let r;if(typeof t=="boolean"&&(t=t?i.True:i.False),typeof t=="string"&&(t=i.string(t)),typeof t=="object")if("re"in t&&"im"in t)t=i.complex(t.re,t.im);else if("num"in t&&"denom"in t)t=i.number([t.num,t.denom]);else if(Array.isArray(t))t=i._fn("List",t.map(s=>i.box(s)));else throw new Error(`Invalid value for symbol ${this._id}: ${t}`);if(t!==void 0&&(r=i.box(t).evaluate()),(a=r==null?void 0:r.domain)==null?void 0:a.isFunction){this.engine.lookupSymbol(this._id),this._def=i.defineFunction(this._id,{signature:{...ka(r.domain),evaluate:r}});return}let n=this.engine.lookupSymbol(this._id);if(n&&n instanceof Te)n.value=r;else{let s=r==null?void 0:r.domain;s!=null&&s.isNumeric&&(s=i.Numbers),this._def=i.defineSymbol(this._id,{value:r,domain:s})}}get domain(){let t=this._def;if(t){if(t instanceof Wt)return el(this.engine,t.signature);if(t instanceof Te)return t.domain??void 0}}set domain(t){if(!this._def)return;if(this._id[0]==="_")throw new Error(`The domain of the wildcard "${this._id}" cannot be changed`);let i=this.engine.domain(t);i.isFunction?(this.engine.forget(this._id),this._def=this.engine.defineFunction(this._id,{signature:ka(i)})):this._def instanceof Te?this._def.domain=i:(this.engine.forget(this._id),this._def=this.engine.defineSymbol(this._id,{domain:i}))}get sgn(){let t=this._def;if(!t||!(t instanceof Te))return null;let i=t.value;if(i&&i!==this){let r=i.sgn;if(r!==void 0)return r}if(t.zero===!0)return 0;if(t.positive===!0)return 1;if(t.negative===!0)return-1}has(t){return typeof t=="string"?this._id===t:t.includes(this._id)}isSame(t){return this===t?!0:t instanceof jl?this._id===t._id:!1}match(t,i){return Ya(this,t,i)}isEqual(t){var r,n;if(!this.isCanonical)return this.canonical.isEqual(t);if(t=t.canonical,this===t)return!0;if(t.symbol!==null)return t.symbol===this._id;let i=(n=(r=this.symbolDefinition)==null?void 0:r.value)==null?void 0:n.N();if(i)return i.isEqual(t.N());if(t.isZero){if(this.isZero)return!0;if(this.isNotZero)return!1}return this.isZero&&t.isNotZero?!1:this.engine.ask(["Equal",this,t]).length>0?!0:(this.engine.ask(["NotEqual",this,t]).length>0,!1)}isLess(t){var r,n;if(t.symbol!==null&&t.symbol===this._id)return!1;let i=(n=(r=this.symbolDefinition)==null?void 0:r.value)==null?void 0:n.N();if(i)return i.isLess(t.N());if(t.isZero){let a=this.sgn;if(a===null)return!1;if(a!==void 0)return a<0}}isLessEqual(t){var r,n;if(t.symbol!==null&&t.symbol===this._id)return!0;let i=(n=(r=this.symbolDefinition)==null?void 0:r.value)==null?void 0:n.N();if(i)return i.isLessEqual(t.N());if(t.isZero){let a=this.sgn;if(a===null)return!1;if(a!==void 0)return a<=0}return this.isLess(t)||this.isEqual(t)}isGreater(t){var r,n;if(t.symbol!==null&&t.symbol===this._id)return!1;let i=(n=(r=this.symbolDefinition)==null?void 0:r.value)==null?void 0:n.N();if(i)return i.isGreater(t.N());if(t.isZero){let a=this.sgn;if(a===null)return!1;if(a!==void 0)return a>0}}isGreaterEqual(t){var r,n;if(t.symbol!==null&&t.symbol===this._id)return!0;let i=(n=(r=this.symbolDefinition)==null?void 0:r.value)==null?void 0:n.N();if(i)return i.isGreaterEqual(t.N());if(t.isZero){let a=this.sgn;if(a===null)return!1;if(a!==void 0)return a>=0}return this.isGreater(t)||this.isEqual(t)}get isFunction(){return!!this.functionDefinition}get isZero(){var t;return(t=this.symbolDefinition)==null?void 0:t.zero}get isNotZero(){var t;return(t=this.symbolDefinition)==null?void 0:t.notZero}get isOne(){var t;return(t=this.symbolDefinition)==null?void 0:t.one}get isNegativeOne(){var t;return(t=this.symbolDefinition)==null?void 0:t.negativeOne}get isOdd(){var t;return(t=this.symbolDefinition)==null?void 0:t.odd}get isEven(){var t;return(t=this.symbolDefinition)==null?void 0:t.even}get isPrime(){var t;return(t=this.symbolDefinition)==null?void 0:t.prime}get isComposite(){var t;return(t=this.symbolDefinition)==null?void 0:t.composite}get isInfinity(){var t;return(t=this.symbolDefinition)==null?void 0:t.infinity}get isNaN(){var t;return(t=this.symbolDefinition)==null?void 0:t.NaN}get isPositive(){var t;return(t=this.symbolDefinition)==null?void 0:t.positive}get isNonPositive(){var t;return(t=this.symbolDefinition)==null?void 0:t.nonPositive}get isNegative(){var t;return(t=this.symbolDefinition)==null?void 0:t.negative}get isNonNegative(){var t;return(t=this.symbolDefinition)==null?void 0:t.nonNegative}get isNumber(){var t;return(t=this.symbolDefinition)==null?void 0:t.number}get isInteger(){var t;return(t=this.symbolDefinition)==null?void 0:t.integer}get isRational(){var t;return(t=this.symbolDefinition)==null?void 0:t.rational}get isAlgebraic(){var t;return(t=this.symbolDefinition)==null?void 0:t.rational}get isReal(){var t;return(t=this.symbolDefinition)==null?void 0:t.real}get isExtendedReal(){var t;return(t=this.symbolDefinition)==null?void 0:t.extendedReal}get isComplex(){var t;return(t=this.symbolDefinition)==null?void 0:t.complex}get isImaginary(){var t;return(t=this.symbolDefinition)==null?void 0:t.imaginary}simplify(t){let i=this.symbolDefinition;return(i==null?void 0:i.holdUntil)==="simplify"&&i.value?i.value.simplify(t):t!=null&&t.rules?this.replace(t.rules)??this:this}evaluate(t){var r,n;let i=this.symbolDefinition;if(i){if(t!=null&&t.numericMode)return i.holdUntil==="never"?this:((r=i.value)==null?void 0:r.N(t))??this;if(i.holdUntil==="simplify"||i.holdUntil==="evaluate")return((n=i.value)==null?void 0:n.evaluate(t))??this}return this}N(t){var r;let i=this.symbolDefinition;return i&&i.holdUntil==="never"?this:((r=i==null?void 0:i.value)==null?void 0:r.N(t))??this}replace(t,i){return nl(this,t,i)}subs(t,i){return t[this._id]===void 0?i!=null&&i.canonical?this.canonical:this:this.engine.box(t[this._id],i)}};function po(e,t){let i=e.lookupSymbol(t);return(i==null?void 0:i.holdUntil)==="never"&&i.value?i.value:new er(e,t,{canonical:!0,def:i})}var Fr="\x1B[0m",Ep="\x1B[33m",Ap="\x1B[36;1m",mo="\x1B[101;97m",Mp=class Ra{constructor(t){if(this._cache={},this._commonSymbols={True:null,False:null,All:null,Nothing:null,None:null,Undefined:null,Pi:null,ImaginaryUnit:null,ExponentialE:null},this._commonNumbers={"-5":null,"-4":null,"-3":null,"-2":null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null,10:null,11:null,12:null,36:null},this._commonDomains={Anything:null,Void:null,NothingDomain:null,Booleans:null,Strings:null,Domains:null,Symbols:null,Integers:null,RationalNumbers:null,AlgebraicNumbers:null,RealNumbers:null,ExtendedRealNumbers:null,ImaginaryNumbers:null,ComplexNumbers:null,ExtendedComplexNumbers:null,Numbers:null,PositiveIntegers:null,TranscendentalNumbers:null,PositiveNumbers:null,Functions:null,NumericFunctions:null,RealFunctions:null,LogicOperators:null,Predicates:null},t!==void 0&&typeof t!="object")throw Error("Unexpected argument");this.strict=!0,this._jsonSerializationOptions={exclude:[],shorthands:["function","symbol","string","dictionary","number"],metadata:[],precision:"max",repeatingDecimals:!0},this._useRawJsonSerializationOptions=!1,this._rawJsonSerializationOptions={exclude:[],shorthands:["function","symbol","string","dictionary","number"],metadata:[],precision:"max",repeatingDecimals:!1},this._stats={highwaterMark:0,symbols:new Set,expressions:new Set},this._numericMode=(t==null?void 0:t.numericMode)??"auto",this._precision=Math.max((t==null?void 0:t.numericPrecision)??100,Math.floor(yi)),this._bignum=T.clone({precision:this._precision}),this.tolerance=(t==null?void 0:t.tolerance)??ln,this.Zero=new Oe(this,0),this.One=new Oe(this,1),this.Half=new Oe(this,[1,2]),this.NegativeOne=new Oe(this,-1),this.NaN=new Oe(this,Number.NaN),this.PositiveInfinity=new Oe(this,Number.POSITIVE_INFINITY),this.NegativeInfinity=new Oe(this,Number.NEGATIVE_INFINITY),this.I=new Oe(this,Ui.Complex.I),this.ComplexInfinity=new Oe(this,Ui.Complex.INFINITY),this.reset(),this.context={assumptions:new sa,timeLimit:2,memoryLimit:1,recursionLimit:1024,iterationLimit:Number.POSITIVE_INFINITY};for(let r of Ra.getStandardLibrary("domains"))fo(this,r);for(let r of Object.keys(this._commonDomains))this._commonDomains[r]&&!this._commonDomains[r].symbolDefinition?this._commonDomains[r].bind():this._commonDomains[r]=new ki(this,Kn[r]??r);this.Anything=this._commonDomains.Anything,this.Void=this._commonDomains.Void,this.Strings=this._commonDomains.Strings,this.Booleans=this._commonDomains.Booleans,this.Numbers=this._commonDomains.Numbers;let i=(t==null?void 0:t.ids)??Ra.getStandardLibrary();for(let r of i)fo(this,r);for(let r of Object.keys(this._commonSymbols)){let n=new er(this,r,{canonical:!0});n.bind(),this._commonSymbols[r]=n}this.True=this._commonSymbols.True,this.False=this._commonSymbols.False,this.Pi=this._commonSymbols.Pi,this.E=this._commonSymbols.ExponentialE,this.Nothing=this._commonSymbols.Nothing,this.pushScope()}static getStandardLibrary(t="all"){return Rl(t)}get latexDictionary(){return this.latexSyntax.dictionary}set latexDictionary(t){this.latexSyntax.dictionary=t}reset(){this._bignum,this._BIGNUM_NEGATIVE_ONE=this.bignum(-1),this._BIGNUM_NAN=this.bignum(NaN),this._BIGNUM_ZERO=this.bignum(0),this._BIGNUM_ONE=this.bignum(1),this._BIGNUM_TWO=this.bignum(2),this._BIGNUM_HALF=this._BIGNUM_ONE.div(this._BIGNUM_TWO),this._BIGNUM_PI=this._BIGNUM_NEGATIVE_ONE.acos();let t=this._stats.symbols.values(),i=this._stats.expressions.values();this._stats.symbols=new Set,this._stats.expressions=new Set;for(let n of t)n.reset();for(let n of i)n.reset();for(let n of Object.values(this._commonDomains))n==null||n.reset();for(let n of Object.values(this._commonSymbols))n==null||n.reset();let r=this.context;for(;r;){if(r.ids)for(let[n,a]of r.ids)a.reset();r=r.parentScope??null}for(let n of Object.keys(this._cache))this._cache[n].value&&(this._cache[n].purge?this._cache[n].value=this._cache[n].purge(this._cache[n].value):delete this._cache[n])}_register(t){this._stats.highwaterMark+=1}_unregister(t){}get stats(){let t=this._stats.expressions;return this._stats.expressions=null,this._stats.expressions=t,{...this._stats}}get precision(){return this._numericMode==="machine"||this._numericMode==="complex"?Math.floor(yi):this._precision}set precision(t){var r;t==="machine"&&(t=Math.floor(yi));let i=this._precision;if(t!==i){if(typeof t!="number"||t<=0)throw Error('Expected "machine" or a positive number');(r=this._latexSyntax)==null||r.updateOptions({precision:t,avoidExponentsInRange:[-6,t]}),this._precision=Math.max(t,Math.floor(yi)),this.jsonSerializationOptions.precision>this._precision&&(this.jsonSerializationOptions={precision:this._precision}),this._numericMode!=="auto"&&this._numericMode!=="bignum"&&this._precision>Math.floor(yi)&&(this._numericMode="auto"),this._bignum=this._bignum.config({precision:this._precision}),this.reset()}}get numericMode(){return this._numericMode}set numericMode(t){if(t!==this._numericMode){if(typeof t!="string")throw Error("Expected a string");this._numericMode=t,(t==="complex"||t==="machine")&&(this._precision=Math.floor(yi)),this._latexSyntax&&this.latexSyntax.options.precision>this._precision&&this.latexSyntax.updateOptions({precision:this._precision}),this.jsonSerializationOptions.precision>this._precision&&(this.jsonSerializationOptions={precision:this._precision}),this.reset()}}get timeLimit(){let t=this.context;for(;t;){if(t.timeLimit!==void 0)return t.timeLimit;t=t.parentScope??null}return 2}get iterationLimit(){let t=this.context;for(;t;){if(t.iterationLimit!==void 0)return t.iterationLimit;t=t.parentScope??null}return 1024}get recursionLimit(){let t=this.context;for(;t;){if(t.recursionLimit!==void 0)return t.recursionLimit;t=t.parentScope??null}return 1024}get tolerance(){return this._tolerance}set tolerance(t){typeof t=="number"&&Number.isFinite(t)?this._tolerance=Math.max(t,0):this._tolerance=ln,this._bignumTolerance=this.bignum(this._tolerance)}chop(t){return typeof t=="number"&&Math.abs(t)<=this._tolerance||t instanceof T&&t.abs().lte(this._bignumTolerance)||t instanceof Ui.Complex&&Math.abs(t.re)<=this._tolerance&&Math.abs(t.im)<=this._tolerance?0:t}bignum(t){if(typeof t=="bigint")return new this._bignum(t.toString());try{return new this._bignum(t)}catch(i){console.error(i)}return this._BIGNUM_NAN}complex(t,i){return t instanceof T&&(t=t.toNumber()),i instanceof T&&(i=i.toNumber()),new Ui.Complex(t,i)}isBignum(t){return t instanceof T}isComplex(t){return t instanceof Ui.Complex}get latexSyntax(){if(!this._latexSyntax){let t=this.precision;this._latexSyntax=new Fs({computeEngine:this,precision:t,avoidExponentsInRange:[-6,t],onError:i=>{throw new Error(JSON.stringify(i[0].message))}})}return this._latexSyntax}static getLatexDictionary(t="all"){return Fs.getDictionary(t)}get costFunction(){return this._cost??ho}set costFunction(t){typeof t!="function"&&(this._cost=ho),this._cost=t}lookupSymbol(t,i,r){var a,s;if(!this.strict){for(r??(r=this.context??void 0);r;){let o=(a=r.ids)==null?void 0:a.get(t);if(o&&o instanceof Te)return o;r=r.parentScope}return}if(typeof t!="string")throw Error("Expected a string");if(t.length===0||!this.context)return;let n=r??this.context;if(i)for(r=n;r;){if(r.ids){for(let[o,l]of r.ids)if(l instanceof Te&&l.wikidata===i)return l}r=r.parentScope}for(r=n;r;){let o=(s=r.ids)==null?void 0:s.get(t);if(o instanceof Te)return o;r=r.parentScope}}lookupFunction(t,i){var r;if(typeof t=="string"&&this.context)for(i??(i=this.context);i;){let n=(r=i.ids)==null?void 0:r.get(t);if(n instanceof Wt)return n;i=i.parentScope}}defineSymbol(t,i){if(!this.context)throw Error("Symbol cannot be defined: no scope available");if(t.length===0||!Ye(t))throw Error(`Invalid identifier "${t}": ${hi(t)}}`);return this._defineSymbol(t,i)}_defineSymbol(t,i){var r;(r=this.context).ids??(r.ids=new Map);let n=new Te(this,t,i);return n.name&&this.context.ids.set(n.name,n),n}defineFunction(t,i){if(!this.context)throw Error("Function cannot be defined: no scope available");if(t.length===0||!Ye(t))throw Error(`Invalid identifier "${t}": ${hi(t)}}`);return this._defineFunction(t,i)}_defineFunction(t,i){var r;(r=this.context).ids??(r.ids=new Map);let n=Ll(this,t,i);return n.name&&this.context.ids.set(n.name,n),n}pushScope(t){if(this.context===null)throw Error("No parent scope available");return this.context={timeLimit:this.context.timeLimit,memoryLimit:this.context.memoryLimit,recursionLimit:this.context.recursionLimit,iterationLimit:this.context.iterationLimit,...t??{},parentScope:this.context,assumptions:new sa(this.context.assumptions)},this}popScope(){if(!this.context)throw Error("No scope available");return this.context=this.context.parentScope??null,this.context,this}swapScope(t){let i=this.context;return this.context=t,this.context,i}resetContext(){if(this.context){for(let[t,i]of this.context.ids??[])if(i instanceof Te)i.constant||(i.value=void 0);else if(i instanceof Wt){let r=i.signature;i.signature={...r,evaluate:void 0,N:void 0,simplify:void 0,canonical:void 0}}}}_printScope(t,i,r=0){var a,s;if(t??(t={details:!1,maxDepth:1}),i??(i=this.context),!i||t.maxDepth&&r>t.maxDepth)return null;let n=`${Ep}[undefined]${Fr}`;if(r===0?console.group("current scope - level 0"):console.groupCollapsed(i.parentScope?`scope - level ${r}`:`root scope - level ${r}`),i.ids){let o=0;for(let[l,u]of i.ids){let f=`${Ap}${l}${Fr}`;try{if(u instanceof Te){let c=(a=u.value)!=null&&a.isValid?u.value.toString():u.value?`${mo}${u.value.toString()}${Fr}`:n;console.info(`${f}: ${((s=u.domain)==null?void 0:s.toString())??n} = ${c}`)}else u instanceof Wt&&(typeof u.signature.evaluate=="function"?console.info(`${f}(): ${t.details?u.signature.evaluate.toString():"[native-code]"}`):u.signature.evaluate===void 0?console.info(`${f}(): ${n}`):console.info(`${f}(): ${u.toString()}`));o===11&&console.groupCollapsed(`... and ${i.ids.size-o} more`),o+=1}catch(c){console.info(`${f}: ${mo}${c.message}${Fr}`)}}o>=11&&console.groupEnd()}if(i.assumptions){let o=[...i.assumptions.entries()].map(([l,u])=>`${l}: ${u}`);if(o.length>0){console.groupCollapsed(`${o.length} assumptions)`);for(let l of o)console.info(l);console.groupEnd()}}return i.parentScope&&this._printScope(t,i.parentScope,r+1),console.groupEnd(),this.context}declare(t,i){var s,o;if(typeof t!="string"||i===void 0){for(let[l,u]of Object.entries(t))this.declare(l,u);return this}let[r,n]=Ys(t);if(n!==void 0)throw Error(`Unexpected arguments with ${t}. Use 'ce.assign()' instead to assign a value, or a use a function definition with 'ce.declare()'.`);if(r==="Nothing")return this;if((o=(s=this.context)==null?void 0:s.ids)!=null&&o.get(r)){let l=this.context.ids.get(r);if(l instanceof Te&&l.inferredDomain)return za(i)?l.update(i):(l.domain=this.domain(i),l.inferredDomain=!1),this;throw Error(`Symbol "${r}" has already been declared in the current scope`)}let a=i;if(!a)throw Error(`Expected a definition for ${r}`);if(za(a))return this.defineSymbol(r,a),this;if(Bl(a))return this.defineFunction(r,a),this;{let l=this.domain(a);if(l.isValid)if(l.isFunction)this.defineFunction(r,{signature:ka(l)});else{if(n)throw Error(`Unexpected arguments with domain for "${r}"`);this.defineSymbol(r,{domain:l})}else throw Error(`Invalid argument for "${r}": use a domain, a FunctionDefinition or a SymbolDefinition`)}return this}assign(t,i){var l,u,f,c;if(typeof t=="object"){for(let[h,p]of Object.entries(t))this.assign(h,p);return this}let[r,n]=Ys(t);if(r==="Nothing")return this;let a=i;if(typeof a=="boolean"&&(a=a?this.True:this.False),typeof a=="string"){let h=a.trim();h.startsWith("$")&&h.endsWith("$")?a=this.parse(h.slice(1,-1),{canonical:!1}):h.startsWith("$$")&&h.endsWith("$$")?a=this.parse(h.slice(2,-2),{canonical:!1}):a=this.string(a)}let s=this.lookupSymbol(r);if(s){if(s.constant)throw Error(`Cannot assign a value to the constant "${r}"`);if(!s.inferredDomain&&oa(a))throw Error(`Cannot assign a function to symbol "${r}"`);let h=s.scope;if((l=h==null?void 0:h.ids)==null||l.delete(s.name),!n&&!oa(a))return a==null?s.value=void 0:s.value=this.box(a),(u=h==null?void 0:h.ids)==null||u.set(s.name,s),this}let o=this.lookupFunction(r);if(o){let h=o.scope;if((f=h==null?void 0:h.ids)==null||f.delete(o.name),a==null)return this;if(typeof a=="function"){let d=this.swapScope(h);return this.defineFunction(r,{signature:{evaluate:a}}),this.swapScope(d),this}if(n&&oa(a))throw Error(`Unexpected arguments for "${r}"`);let p=n?this.box(["Function",a,...n]):this.box(a),m=this.swapScope(h);return this.defineFunction(r,{signature:{evaluate:p}}),this.swapScope(m),this}if(a==null)return this.declare(r,{inferred:!0,domain:this.Anything}),this;if(typeof a=="function")return this.defineFunction(r,{signature:{evaluate:a}}),this;if(a instanceof ne&&((c=a.domain)==null?void 0:c.base)==="Functions")return this.defineFunction(r,{signature:{evaluate:a}}),this;if(Array.isArray(a)||a instanceof ne||n){let h=this.box(a,{canonical:!1});if(h.head==="Function")return h=this.box(["Function",...h.ops,...(n??[]).map(m=>this.symbol(m))]),this.defineFunction(r,{signature:{evaluate:h}}),this;let p=[...h.unknowns].sort();if(p.length===0){let m=h.evaluate();return this.defineSymbol(r,{value:m}),this}if(p.some(m=>/\_[\d]+/.test(m)))return h=this.box(["Function",h]),this.defineFunction(r,{signature:{evaluate:h}}),this;if(n&&n.length>0)return this.pushScope(),h=this.box(["Function",h,...n]),this.popScope(),this.defineFunction(r,{signature:{evaluate:h}}),this;this.pushScope(),a=h.evaluate(),this.popScope()}return this.defineSymbol(r,{value:a}),this}_assign(t,i){let r=this.lookupSymbol(t);if(r)return r.value=this.box(i).evaluate(),this;let n=this.lookupFunction(t);if(n){let a=n.signature;return n.signature={...a,N:void 0,simplify:void 0,canonical:void 0,evaluate:i},this}return this}get assumptions(){if(!this.context)throw Error("No scope available");return this.context.assumptions?this.context.assumptions:(this.context.assumptions=new sa,this.context.assumptions)}shouldContinueExecution(){return this.deadline===void 0||this.deadline>=Date.now()}checkContinueExecution(){if(!this.shouldContinueExecution())throw new Error("timeout")}cache(t,i,r){var n;if(this._cache[t]===void 0)try{this._cache[t]={build:i,purge:r,value:i()}}catch(a){console.error(`Fatal error building cache "${t}":
	 ${a.toString()}`)}return(n=this._cache[t])==null?void 0:n.value}canonical(t){if(!t.every(r=>r instanceof ne))return t.map(r=>this.box(r));let i=t;return i.every(r=>r.isCanonical)?i:i.map(r=>r.canonical)}box(t,i){return Le(this,t,i)}function(t,i,r){return r??(r={}),"canonical"in r||(r.canonical=!0),Kr(this,t,i,r)}error(t,i){i instanceof ne?i=this.rawJson(i):i&&Array.isArray(i)&&i[0]==="LatexString"&&((i[1]===void 0||!i[1])&&(i=""),typeof i[1]=="object"&&"str"in i[1]&&!i[1].str&&(i=""));let r;return typeof t=="string"&&(r=this.string(t)),!r&&typeof t!="string"&&(r=new ze(this,"ErrorCode",[this.string(t[0]),...t.slice(1).map(n=>this.box(n,{canonical:!1}))])),i?new ze(this,"Error",[r,this.box(i,{canonical:!1})],{canonical:!1}):new ze(this,"Error",[r],{canonical:!1})}domainError(t,i,r){let n=Vi(t)?this.domain(t):this.symbol(t),a=i||this.symbol("Undefined");return this.error(["incompatible-domain",n,a],r)}hold(t){return this._fn("Hold",[this.box(t,{canonical:!1})])}add(...t){return Ia(this,De(Ae(t),"Add"))}neg(t){return Qr(t.canonical)}mul(...t){let i=De(Ae(t),"Multiply");return Fa(this,i)}div(t,i){return wl(this,t.canonical,i.canonical)}sqrt(t){return jr(this,t,"evaluate")??this._fn("Power",[t,this.Half])}pow(t,i){return(typeof i=="number"||Se(i))&&(i=this.number(i)),Oi(this,t,i)}inv(t){if(t.isOne)return this.One;if(t.isNegativeOne)return this.NegativeOne;if(t.isInfinity)return this.Zero;let i=t.numericValue;if(i!==null)return Se(i)?this.number(Li(i)):typeof i=="number"&&Number.isInteger(i)?this.number([1,i]):i instanceof T&&i.isInteger()?this.number([BigInt(1),R(i)]):this._fn("Divide",[this.One,t]);if(t.head==="Sqrt")return this._fn("Sqrt",[this.inv(t.op1)]);if(t.head==="Divide")return this._fn("Divide",[t.op1,t.op2]);let r=this.NegativeOne;if(t.head==="Power"){if(t.op2.isNegativeOne)return t.op1;r=Ze(t.op2),t=t.op1}return r.isNegativeOne?this._fn("Divide",[this.One,t]):this._fn("Power",[t,r])}pair(t,i,r){return new ze(this,"Tuple",[t.canonical,i.canonical],{metadata:r,canonical:!0})}tuple(t,i){return new ze(this,"Tuple",Pe(t.map(r=>typeof r=="number"?this.number(r):r.canonical)),{metadata:i,canonical:!0})}array(t,i){return this.Nothing}string(t,i){return new zi(this,t,i)}symbol(t,i){var n,a,s;if(i=i?{...i}:{},"canonical"in i||(i.canonical=!0),t=t.normalize(),t==="NaN")return this.NaN;if(t==="Infinity")return this.PositiveInfinity;if(t==="+Infinity")return this.PositiveInfinity;if(t==="-Infinity")return this.NegativeInfinity;if(t==="Half")return this.Half;if(this.strict&&!Ye(t)){let o=(n=i==null?void 0:i.metadata)==null?void 0:n.latex,l=`'${t}'`;return this.error(["invalid-identifier",{str:hi(t)}],o?["LatexString",`'${o}'`]:l)}if(((a=i==null?void 0:i.metadata)==null?void 0:a.latex)!==void 0&&!i.canonical)return new er(this,t,i);let r=this._commonSymbols[t];return r?!((s=i==null?void 0:i.metadata)!=null&&s.wikidata)||!r.wikidata||r.wikidata===i.metadata.wikidata?r:i.canonical?po(this,t):new er(this,t,i):i.canonical?po(this,t):new er(this,t,i)}domain(t,i){if(t instanceof ki)return t;if(typeof t=="string"){let n=this._commonDomains[t];if(n)return n}if(!this.strict){if(typeof t=="string"){let n=Kn[t];if(n)return this.domain(n)}return new ki(this,t,i)}if(Array.isArray(t)&&t[0]==="Domain"&&(t=t[1]),typeof t=="string"){let n=Kn[t];if(n)return this.domain(n);if(!In(t))throw Error("Expected a domain literal, got "+t);return new ki(this,t,i)}if(!Array.isArray(t)||t.length===0)throw Error("Expected a valid domain");let r=t[0];if(!Mn.includes(r))throw Error("Expected a domain constructor, got "+r);return new ki(this,t,i)}number(t,i){if(i=i?{...i}:{},"canonical"in i||(i.canonical=!0),i.metadata===void 0){if(typeof t=="bigint"){if(t===BigInt(1))return this.One;if(t===BigInt(0))return this.Zero;if(t===BigInt(-1))return this.NegativeOne}if(typeof t=="number"){let r=t;if(r===1)return this.One;if(r===0)return this.Zero;if(r===-1)return this.NegativeOne;if(Number.isInteger(r)&&this._commonNumbers[r]!==void 0)return this._commonNumbers[r]===null&&(this._commonNumbers[r]=$a(this,t)??this.NaN),this._commonNumbers[r];if(Number.isNaN(r))return this.NaN;if(!Number.isFinite(r))return r<0?this.NegativeInfinity:this.PositiveInfinity}}return typeof t=="bigint"&&(t=this.bignum(t)),$a(this,t,i)??this.NaN}rules(t){return An(this,t)}_fn(t,i,r){return new ze(this,t,i,{metadata:r,canonical:!0})}parse(t,i){if(typeof t!="string")return null;let r=this.latexSyntax.parse(Ja(t)??t);return this.box(r,i)}serialize(t,i){if(typeof t=="object"&&"json"in t){let r="engine"in t?t.engine:this;return this.latexSyntax.serialize(this.rawJson(r.box(t,{canonical:!1})),i)}return this.latexSyntax.serialize(t,i)}get latexOptions(){let t=this.latexSyntax;return new Proxy({...this.latexSyntax.options,...this.latexSyntax.serializer.options},{set(i,r,n){return r in i?(t.updateOptions({[r]:n}),!0):!1}})}set latexOptions(t){this.latexSyntax.updateOptions(t)}get jsonSerializationOptions(){if(this._useRawJsonSerializationOptions)return new Proxy(this._rawJsonSerializationOptions,{get(i,r){if(r in i)return i[r]}});let t=this;return new Proxy(this._jsonSerializationOptions,{get(i,r){if(r in i)return i[r]},set(i,r,n){return r in i?(t.jsonSerializationOptions={[r]:n},!0):!1}})}set jsonSerializationOptions(t){t.exclude&&(this._jsonSerializationOptions.exclude=[...t.exclude]),t.shorthands&&(t.shorthands==="all"||t.shorthands.includes("all")?this._jsonSerializationOptions.shorthands=["function","symbol","string","dictionary","number"]:this._jsonSerializationOptions.shorthands=[...t.shorthands]),t.metadata&&(t.metadata==="all"||t.metadata.includes("all")?this._jsonSerializationOptions.metadata=["latex","wikidata"]:this._jsonSerializationOptions.metadata=[...t.metadata]),typeof t.precision=="number"&&t.precision>0&&(this._jsonSerializationOptions.precision=t.precision),typeof t.repeatingDecimals=="boolean"&&(this._jsonSerializationOptions.repeatingDecimals=t.repeatingDecimals)}rawJson(t){let i=this._useRawJsonSerializationOptions;this._useRawJsonSerializationOptions=!0;let r=t.json;return this._useRawJsonSerializationOptions=i,r}ask(t){let i=this.box(t,{canonical:!1}),r=[];for(let[n,a]of this.assumptions){let s=i.match(n,{numericTolerance:this._tolerance});s!==null&&a===!0&&r.push(s)}return r}verify(t){return!1}assume(t){try{return Mh(this.box(t,{canonical:!1}))}catch(i){return console.error(i.toString()),"internal-error"}}forget(t){if(!this.context)throw Error("No scope available");if(t===void 0){if(this.context.ids)for(let i of this.context.ids.keys())this.forget(i);this.assumptions.clear();return}if(Array.isArray(t)){for(let i of t)this.forget(i);return}if(typeof t=="string"){if(this.context.ids){let i=this.context.ids.get(t);if(i instanceof Te)i.value=void 0;else if(i instanceof Wt){let r=i.signature;i.signature={...r,evaluate:void 0,N:void 0,simplify:void 0,canonical:void 0}}}for(let[i,r]of this.assumptions)i.symbols.includes(t)&&this.assumptions.delete(i)}}};function oa(e){var t;return typeof e=="function"||e instanceof ne&&((t=e.domain)==null?void 0:t.base)==="Functions"}globalThis[Symbol.for("io.cortexjs.compute-engine")]={ComputeEngine:Mp.prototype.constructor,version:"0.24.1"};/*! Bundled license information:

complex.js/complex.js:
  (**
   * @license Complex.js v2.1.1 12/05/2020
   *
   * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
   * Dual licensed under the MIT or GPL Version 2 licenses.
   **)

decimal.js/decimal.mjs:
  (*!
   *  decimal.js v10.4.3
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   *)
*/function Ip(e){let t,i=`Your answer was incorrect. If you&#39;re completely sure that your submission was correct, double check your formatting. If you&#39;re doing an indefinite integral, your constant of integration should be capitalized. So &quot;+ C&quot;.
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>`;return{c(){t=le("div"),t.innerHTML=i,this.h()},l(r){t=ue(r,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),or(t)!=="svelte-1pei79n"&&(t.innerHTML=i),this.h()},h(){pe(t,"class","alert alert-warning alert-dismissible fade show mt-2"),pe(t,"role","alert")},m(r,n){Ve(r,t,n)},p:fi,i:fi,o:fi,d(r){r&&Z(t)}}}class Op extends Ba{constructor(t){super(),Ua(this,t,null,Ip,pr,{})}}function qp(e){let t,i=`An error was thrown-- your answer most likely wasn&#39;t formatted correctly. Try double checking your parentheses.
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>`;return{c(){t=le("div"),t.innerHTML=i,this.h()},l(r){t=ue(r,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),or(t)!=="svelte-uduzfh"&&(t.innerHTML=i),this.h()},h(){pe(t,"class","alert alert-danger alert-dismissible fade show mt-2"),pe(t,"role","alert")},m(r,n){Ve(r,t,n)},p:fi,i:fi,o:fi,d(r){r&&Z(t)}}}class Fp extends Ba{constructor(t){super(),Ua(this,t,null,qp,pr,{})}}function go(e){let t;function i(a,s){return a[1]=="nouser"?Cp:Dp}let r=i(e),n=r(e);return{c(){n.c(),t=Jt()},l(a){n.l(a),t=Jt()},m(a,s){n.m(a,s),Ve(a,t,s)},p(a,s){r===(r=i(a))&&n?n.p(a,s):(n.d(1),n=r(a),n&&(n.c(),n.m(t.parentNode,t)))},d(a){a&&Z(t),n.d(a)}}}function Dp(e){let t,i,r,n,a,s,o,l=e[10],u,f,c,h=vo(e);return{c(){t=le("math-field"),i=Ue(),r=le("button"),n=Wi("Submit"),a=Ue(),s=le("br"),o=Ue(),h.c(),u=Jt(),this.h()},l(p){t=ue(p,"MATH-FIELD",{class:!0,style:!0}),Je(t).forEach(Z),i=je(p),r=ue(p,"BUTTON",{class:!0,type:!0});var m=Je(r);n=Qi(m,"Submit"),m.forEach(Z),a=je(p),s=ue(p,"BR",{}),o=je(p),h.l(p),u=Jt(),this.h()},h(){tu(t,"class","w-100"),Xe(t,"font-size","1rem"),Xe(t,"display","block"),pe(r,"class","btn btn-primary mt-4"),pe(r,"type","button"),r.disabled=e[10]},m(p,m){Ve(p,t,m),e[26](t),Ve(p,i,m),Ve(p,r,m),U(r,n),Ve(p,a,m),Ve(p,s,m),Ve(p,o,m),h.m(p,m),Ve(p,u,m),f||(c=iu(r,"click",e[27]),f=!0)},p(p,m){m[0]&1024&&(r.disabled=p[10]),m[0]&1024&&pr(l,l=p[10])?(h.d(1),h=vo(p),h.c(),h.m(u.parentNode,u)):h.p(p,m)},d(p){p&&(Z(t),Z(i),Z(r),Z(a),Z(s),Z(o),Z(u)),e[26](null),h.d(p),f=!1,c()}}}function Cp(e){let t,i=`Oops! It seems like you&#39;re not logged in.
                                    Want to <a href="/login/">log in</a>?`;return{c(){t=le("p"),t.innerHTML=i},l(r){t=ue(r,"P",{"data-svelte-h":!0}),or(t)!=="svelte-1bvaimr"&&(t.innerHTML=i)},m(r,n){Ve(r,t,n)},p:fi,d(r){r&&Z(t)}}}function bo(e){let t,i;return{c(){t=le("img"),this.h()},l(r){t=ue(r,"IMG",{src:!0,alt:!0,style:!0}),this.h()},h(){la(t.src,i="/img/loading.gif")||pe(t,"src",i),pe(t,"alt","Loading gif"),Xe(t,"width","64px"),Xe(t,"height","64px"),Xe(t,"margin-top","4px")},m(r,n){Ve(r,t,n)},d(r){r&&Z(t)}}}function vo(e){let t,i=e[10]==!0&&bo();return{c(){i&&i.c(),t=Jt()},l(r){i&&i.l(r),t=Jt()},m(r,n){i&&i.m(r,n),Ve(r,t,n)},p(r,n){r[10]==!0?i||(i=bo(),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null)},d(r){r&&Z(t),i&&i.d(r)}}}function xo(e){let t,i=e[1]!=null&&go(e);return{c(){i&&i.c(),t=Jt()},l(r){i&&i.l(r),t=Jt()},m(r,n){i&&i.m(r,n),Ve(r,t,n)},p(r,n){r[1]!=null?i?i.p(r,n):(i=go(r),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null)},d(r){r&&Z(t),i&&i.d(r)}}}function Pp(e){let t,i,r,n,a,s,o,l="",u,f,c,h="",p,m,d,b,y,_,S,k,C,P,se,we,Y,lt,Me,Ie,ut,dt,oe,z,Ce,ii,ri,Ri,gt,gi,F,Re,Ot,Bi,yr,Fn,ns=e[1],Dn,ni,qt;function Gl(O){e[18](O)}function Zl(O){e[19](O)}function Hl(O){e[20](O)}function Wl(O){e[21](O)}function Ql(O){e[22](O)}function Jl(O){e[23](O)}let ai={};e[1]!==void 0&&(ai.currentUserInformation=e[1]),e[3]!==void 0&&(ai.userAuthState=e[3]),e[4]!==void 0&&(ai.signUp=e[4]),e[5]!==void 0&&(ai.signIn=e[5]),e[6]!==void 0&&(ai.authErrorState=e[6]),e[2]!==void 0&&(ai.competitiveUserInformation=e[2]),k=new ru({props:ai}),e[17](k),tt.push(()=>Ct(k,"currentUserInformation",Gl)),tt.push(()=>Ct(k,"userAuthState",Zl)),tt.push(()=>Ct(k,"signUp",Hl)),tt.push(()=>Ct(k,"signIn",Wl)),tt.push(()=>Ct(k,"authErrorState",Ql)),tt.push(()=>Ct(k,"competitiveUserInformation",Jl));function Kl(O){e[24](O)}function Yl(O){e[25](O)}let Cn={};e[1]!==void 0&&(Cn.currentUserInformation=e[1]),e[7]!==void 0&&(Cn.currentColorTheme=e[7]),Ie=new nu({props:Cn}),tt.push(()=>Ct(Ie,"currentUserInformation",Kl)),tt.push(()=>Ct(Ie,"currentColorTheme",Yl));let bt=xo(e);return ni=new au({}),{c(){t=le("html"),i=le("head"),r=le("meta"),n=Ue(),a=le("meta"),s=Ue(),o=le("script"),o.innerHTML=l,f=Ue(),c=le("script"),c.innerHTML=h,m=Ue(),d=le("title"),b=Wi(e[14]),y=Ue(),_=le("body"),S=le("div"),$n(k.$$.fragment),Me=Ue(),$n(Ie.$$.fragment),oe=Ue(),z=le("div"),Ce=le("div"),ii=le("h1"),ri=new Xl(!1),Ri=Ue(),gt=le("h6"),gi=Wi(e[13]),F=Wi(" points"),Re=Ue(),Ot=le("h6"),Bi=le("em"),yr=Wi(e[12]),Fn=Ue(),bt.c(),Dn=Ue(),$n(ni.$$.fragment),this.h()},l(O){t=ue(O,"HTML",{"data-bs-theme":!0,lang:!0});var te=Je(t);i=ue(te,"HEAD",{});var ke=Je(i);r=ue(ke,"META",{charset:!0}),n=je(ke),a=ue(ke,"META",{name:!0,content:!0}),s=je(ke),o=ue(ke,"SCRIPT",{src:!0,"data-svelte-h":!0}),or(o)!=="svelte-l0rqga"&&(o.innerHTML=l),f=je(ke),c=ue(ke,"SCRIPT",{src:!0,"data-svelte-h":!0}),or(c)!=="svelte-1mkpkuv"&&(c.innerHTML=h),m=je(ke),d=ue(ke,"TITLE",{});var bi=Je(d);b=Qi(bi,e[14]),bi.forEach(Z),ke.forEach(Z),y=je(te),_=ue(te,"BODY",{class:!0,style:!0});var as=Je(_);S=ue(as,"DIV",{class:!0,style:!0});var vi=Je(S);Vn(k.$$.fragment,vi),Me=je(vi),Vn(Ie.$$.fragment,vi),oe=je(vi),z=ue(vi,"DIV",{class:!0,style:!0});var ss=Je(z);Ce=ue(ss,"DIV",{class:!0});var Ft=Je(Ce);ii=ue(Ft,"H1",{});var os=Je(ii);ri=eu(os,!1),os.forEach(Z),Ri=je(Ft),gt=ue(Ft,"H6",{class:!0});var Pn=Je(gt);gi=Qi(Pn,e[13]),F=Qi(Pn," points"),Pn.forEach(Z),Re=je(Ft),Ot=ue(Ft,"H6",{});var ls=Je(Ot);Bi=ue(ls,"EM",{});var us=Je(Bi);yr=Qi(us,e[12]),us.forEach(Z),ls.forEach(Z),Fn=je(Ft),bt.l(Ft),Ft.forEach(Z),ss.forEach(Z),vi.forEach(Z),as.forEach(Z),Dn=je(te),Vn(ni.$$.fragment,te),te.forEach(Z),this.h()},h(){pe(r,"charset","utf-8"),pe(a,"name","viewport"),pe(a,"content","width=device-width, initial-scale=1.0, shrink-to-fit=no"),o.defer=!0,la(o.src,u="//unpkg.com/mathlive")||pe(o,"src",u),la(c.src,p="https://cdn.jsdelivr.net/npm/@tsparticles/confetti@3.0.3/tsparticles.confetti.bundle.min.js")||pe(c,"src",p),ri.a=null,pe(gt,"class","text-primary"),pe(Ce,"class","card-body float-end"),pe(z,"class","card"),Xe(z,"margin-top","0px"),pe(S,"class","container"),Xe(S,"text-align","center"),Xe(S,"background","transparent"),Xe(S,"color","transparent"),Xe(S,"max-width","1000px"),pe(_,"class","bg-body"),Xe(_,"background","var(--bs-secondary-bg)"),Xe(_,"color","var(--bs-card-bg)"),pe(t,"data-bs-theme",e[7]),pe(t,"lang","en")},m(O,te){Ve(O,t,te),U(t,i),U(i,r),U(i,n),U(i,a),U(i,s),U(i,o),U(i,f),U(i,c),U(i,m),U(i,d),U(d,b),U(t,y),U(t,_),U(_,S),zn(k,S,null),U(S,Me),zn(Ie,S,null),U(S,oe),U(S,z),U(z,Ce),U(Ce,ii),ri.m(e[11],ii),U(Ce,Ri),U(Ce,gt),U(gt,gi),U(gt,F),U(Ce,Re),U(Ce,Ot),U(Ot,Bi),U(Bi,yr),U(Ce,Fn),bt.m(Ce,null),e[28](Ce),U(t,Dn),zn(ni,t,null),qt=!0},p(O,te){const ke={};!C&&te[0]&2&&(C=!0,ke.currentUserInformation=O[1],Dt(()=>C=!1)),!P&&te[0]&8&&(P=!0,ke.userAuthState=O[3],Dt(()=>P=!1)),!se&&te[0]&16&&(se=!0,ke.signUp=O[4],Dt(()=>se=!1)),!we&&te[0]&32&&(we=!0,ke.signIn=O[5],Dt(()=>we=!1)),!Y&&te[0]&64&&(Y=!0,ke.authErrorState=O[6],Dt(()=>Y=!1)),!lt&&te[0]&4&&(lt=!0,ke.competitiveUserInformation=O[2],Dt(()=>lt=!1)),k.$set(ke);const bi={};!ut&&te[0]&2&&(ut=!0,bi.currentUserInformation=O[1],Dt(()=>ut=!1)),!dt&&te[0]&128&&(dt=!0,bi.currentColorTheme=O[7],Dt(()=>dt=!1)),Ie.$set(bi),(!qt||te[0]&2048)&&ri.p(O[11]),(!qt||te[0]&8192)&&cs(gi,O[13]),(!qt||te[0]&4096)&&cs(yr,O[12]),te[0]&2&&pr(ns,ns=O[1])?(bt.d(1),bt=xo(O),bt.c(),bt.m(Ce,null)):bt.p(O,te),(!qt||te[0]&128)&&pe(t,"data-bs-theme",O[7])},i(O){qt||(Ln(k.$$.fragment,O),Ln(Ie.$$.fragment,O),Ln(ni.$$.fragment,O),qt=!0)},o(O){Rn(k.$$.fragment,O),Rn(Ie.$$.fragment,O),Rn(ni.$$.fragment,O),qt=!1},d(O){O&&Z(t),e[17](null),Bn(k),Bn(Ie),bt.d(O),e[28](null),Bn(ni)}}}const $p="https://us-central1-integralsarena.cloudfunctions.net/judgeMathematicalExpression";function Vp(e,t,i){let r,n="IntegralsArena",a,s,o,l,u,f,c="light",h,p,m=!1;const d={apiKey:"AIzaSyDiDHodqqgXhmjtaharNv0yCLBnc-kDWe0",authDomain:"integralsarena.firebaseapp.com",projectId:"integralsarena",storageBucket:"integralsarena.appspot.com",messagingSenderId:"978478141428",appId:"1:978478141428:web:f3566e7bc6ea602177b3a1",measurementId:"G-N5T6SMBHL2"};let b;su().length===0?b=ou(d):b=lu();const y=uu(b);let{data:_}=t,S=_.information.title,k="",C="",P=0;cu(fu(hu(y),"/problems/")).then(F=>{if(F.exists())if(F.val()[S]!=="undefined"){let Re=F.val()[S];Re!=null?(i(11,k=Re.statement),i(12,C=Re.origin),i(13,P=Re.rating)):Un("/")}else Un("/")});const se=200,we={origin:{y:.7}};function Y(F,Re){confetti(Object.assign({},we,Re,{particleCount:Math.floor(se*F)}))}function lt(F){console.log(F),i(10,m=!0),fetch($p,{method:"POST",body:JSON.stringify({expression:h.getValue("ascii-math"),problemid:S,user_info:a}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then(Re=>Re.json()).then(Re=>{let Ot=Re.code;i(10,m=!1),Ot=="true"?(Y(.25,{spread:26,startVelocity:55}),Y(.2,{spread:60}),Y(.35,{spread:100,decay:.91,scalar:.8}),Y(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2}),Y(.1,{spread:120,startVelocity:45}),setTimeout(()=>{Un(`/account/${s.username}`)},1e3)):Ot=="false"?new Op({target:p}):new Fp({target:p})})}function Me(F){tt[F?"unshift":"push"](()=>{r=F,i(0,r)})}function Ie(F){a=F,i(1,a)}function ut(F){o=F,i(3,o)}function dt(F){l=F,i(4,l)}function oe(F){u=F,i(5,u)}function z(F){f=F,i(6,f)}function Ce(F){s=F,i(2,s)}function ii(F){a=F,i(1,a)}function ri(F){c=F,i(7,c)}function Ri(F){tt[F?"unshift":"push"](()=>{h=F,i(8,h)})}const gt=()=>{lt(h.value)};function gi(F){tt[F?"unshift":"push"](()=>{p=F,i(9,p)})}return e.$$set=F=>{"data"in F&&i(16,_=F.data)},[r,a,s,o,l,u,f,c,h,p,m,k,C,P,n,lt,_,Me,Ie,ut,dt,oe,z,Ce,ii,ri,Ri,gt,gi]}class jp extends Ba{constructor(t){super(),Ua(this,t,Vp,Pp,pr,{data:16},null,[-1,-1])}}export{jp as component,Up as universal};
